{"version":3,"file":"common.js","mappings":"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","sources":["./src/app/blocks/models/workflow-datasource.ts","./src/app/views/admin-olc/shared/services/olc-template-styles.service.ts","./src/app/views/admin-olc/templates/template-editor/utils/olc-ted-public-utilities.utils.ts"],"sourcesContent":["import { Subject } from 'rxjs';\r\nimport { Workflow } from './workflow';\r\nimport { IWorkflowStep, MoveToWorkflow } from './workflow-step';\r\nimport { IFieldDataSource, IFieldOptions } from 'shared-code-lib';\r\n\r\nexport class WorkflowsDataSource implements IFieldDataSource {\r\n  changed = new Subject<void>();\r\n\r\n  constructor(public workflows: Array<Workflow>, public sort: boolean = true) {}\r\n\r\n  setWorkflows(workflows: Array<Workflow>) {\r\n    this.workflows = workflows;\r\n    // this.changed.publish();\r\n  }\r\n\r\n  getItems(\r\n    startsWith: string,\r\n    currentValue: string,\r\n    successCallBack: (items: IFieldOptions[]) => void,\r\n    failureCallBack: (err: any) => void\r\n  ): void {\r\n    let items = new Array<IFieldOptions>();\r\n\r\n    for (let workflow of this.workflows) {\r\n      const item = { name: workflow.name, value: workflow.id };\r\n      items.push(item);\r\n    }\r\n\r\n    if (this.sort) items = items.sort((x, y) => x.name.localeCompare(y.name));\r\n\r\n    successCallBack(items);\r\n  }\r\n}\r\n\r\nexport class WorkflowStepsDataSource implements IFieldDataSource {\r\n  changed = new Subject<void>();\r\n  steps: Array<IWorkflowStep>;\r\n\r\n  constructor(private moveToWorkflow: MoveToWorkflow, private workflows: Array<Workflow>) {}\r\n\r\n  getItems(\r\n    startsWith: string,\r\n    currentValue: string,\r\n    successCallBack: (items: IFieldOptions[]) => void,\r\n    failureCallBack: (err: any) => void\r\n  ): void {\r\n    const items = new Array<IFieldOptions>();\r\n\r\n    const selectedWorkflow = this.workflows.find((w) => w.id === this.moveToWorkflow.selectedWorkflowId);\r\n\r\n    if (selectedWorkflow) {\r\n      this.steps = selectedWorkflow.workflowSteps;\r\n\r\n      const sortedSteps = selectedWorkflow.workflowSteps.sort((x, y) => x.name.localeCompare(y.name));\r\n      for (let step of sortedSteps) {\r\n        const item = { name: step.name, value: step.id };\r\n        items.push(item);\r\n      }\r\n    }\r\n\r\n    successCallBack(items);\r\n  }\r\n}\r\n","import { Injectable } from '@angular/core';\r\nimport { TranslateService } from '@ngx-translate/core';\r\n\r\nimport { StyleType, Template, TemplateStyle } from '../../models/template';\r\nimport { uniqueID } from '../../templates/template-editor/utils/olc-ted-public-utilities.utils';\r\nimport { mapInlineStylesToString } from '../../../../blocks/components/html-editor/styles-utils/inline-styles';\r\nimport { Style } from '../../models/style';\r\n\r\n@Injectable({\r\n  providedIn: 'root',\r\n})\r\nexport class OlcTemplateStylesService {\r\n  defaultOlcStyles = [\r\n    new TemplateStyle({\r\n      id: uniqueID(),\r\n      name: this.translateService.instant('admin-olc-custom-styles.p-title'),\r\n      element: 'p',\r\n      elementType: StyleType.Block,\r\n      classes: null,\r\n      inlineStyles: [],\r\n    }),\r\n    new TemplateStyle({\r\n      id: uniqueID(),\r\n      name: this.translateService.instant('admin-olc-custom-styles.h1-title'),\r\n      element: 'h1',\r\n      elementType: StyleType.Block,\r\n      classes: null,\r\n      inlineStyles: [],\r\n    }),\r\n    new TemplateStyle({\r\n      id: uniqueID(),\r\n      name: this.translateService.instant('admin-olc-custom-styles.h2-title'),\r\n      element: 'h2',\r\n      elementType: StyleType.Block,\r\n      classes: null,\r\n      inlineStyles: [],\r\n    }),\r\n    new TemplateStyle({\r\n      id: uniqueID(),\r\n      name: this.translateService.instant('admin-olc-custom-styles.h3-title'),\r\n      element: 'h3',\r\n      elementType: StyleType.Block,\r\n      classes: null,\r\n      inlineStyles: [],\r\n    }),\r\n    new TemplateStyle({\r\n      id: uniqueID(),\r\n      name: this.translateService.instant('admin-olc-custom-styles.h4-title'),\r\n      element: 'h4',\r\n      elementType: StyleType.Block,\r\n      classes: '',\r\n      inlineStyles: [],\r\n    }),\r\n  ];\r\n\r\n  constructor(private translateService: TranslateService) {}\r\n\r\n  getOlcTemplateStyles(template: Template, customStyles: Style[]) {\r\n    let templateStyles = [...this.defaultOlcStyles];\r\n\r\n    const templatePredefinedStyles = template\r\n      ? template.templateStyles.map((s) => {\r\n          s.id = uniqueID();\r\n          return s;\r\n        })\r\n      : [];\r\n\r\n    templatePredefinedStyles.forEach((s) => {\r\n      if (s.elementType === StyleType.None) {\r\n        templateStyles.push(s);\r\n        return;\r\n      }\r\n\r\n      const isDuplicate = this.isDuplicateStyle(s);\r\n\r\n      if (isDuplicate) return;\r\n\r\n      templateStyles.push(s);\r\n    });\r\n\r\n    if (customStyles.length) {\r\n      templateStyles = [\r\n        ...templateStyles,\r\n        new TemplateStyle({\r\n          id: uniqueID(),\r\n          name: this.translateService.instant('admin-olc-custom-styles.custom-styles-separator-title'),\r\n          element: null,\r\n          elementType: StyleType.None,\r\n          classes: null,\r\n          inlineStyles: [],\r\n        }),\r\n      ];\r\n\r\n      customStyles.forEach((cs) => {\r\n        if (cs.elementType === StyleType.None) {\r\n          templateStyles.push(cs);\r\n          return;\r\n        }\r\n        const isDuplicate = this.isDuplicateStyle(cs);\r\n\r\n        if (isDuplicate) return;\r\n\r\n        templateStyles.push(cs);\r\n      });\r\n    }\r\n\r\n    return templateStyles;\r\n  }\r\n\r\n  isDuplicateStyle(s) {\r\n    const defaultStyle = this.defaultOlcStyles.find((d) => this.styleMatches(d, s));\r\n    return !!defaultStyle;\r\n  }\r\n\r\n  styleMatches(s: TemplateStyle, elementToCompare: TemplateStyle) {\r\n    const tagName = elementToCompare.element.replace(/\\s/g, '').toLocaleLowerCase();\r\n    const classes = elementToCompare.classes?.replace(/\\s/g, '').toLocaleLowerCase();\r\n    const style = mapInlineStylesToString(elementToCompare.inlineStyles).replace(/\\s/g, '').toLocaleLowerCase();\r\n\r\n    const styleTagName = s.element.replace(/\\s/g, '').toLocaleLowerCase();\r\n    const styleClasses = s.classes?.replace(/\\s/g, '').toLocaleLowerCase();\r\n    const inlineStylesString = mapInlineStylesToString(s.inlineStyles).replace(/\\s/g, '').toLocaleLowerCase();\r\n\r\n    const equalTagName = (!tagName && !styleTagName) || tagName === styleTagName;\r\n    const equalClasses = (!classes && !styleClasses) || classes === styleClasses;\r\n    const equalStyles = (!style && !inlineStylesString) || style === inlineStylesString;\r\n\r\n    return equalTagName && equalClasses && equalStyles;\r\n  }\r\n}\r\n","/**\r\n * Generate a unique ID.\r\n *\r\n * @returns A unique ID.\r\n */\r\nexport const uniqueID = () => {\r\n  function chr4() {\r\n    return Math.random().toString(16).slice(-4);\r\n  }\r\n  return chr4() + chr4() + '-' + chr4() + '-' + chr4() + '-' + chr4() + '-' + chr4() + chr4() + chr4();\r\n};\r\n\r\n/**\r\n * Generate an Angle.\r\n *\r\n * @param {Number} cx In relation to the DOM top x position of the box.\r\n * @param {Number} cy In relation to the DOM top y position of the box.\r\n * @param {Number} ex In relation to the DOM bottom x position of the box.\r\n * @param {Number} ey In relation to the DOM bottom y position of the box.\r\n * @returns Angle formulated from co-ordinates passed into the function.\r\n */\r\nexport const angle = (cx: number, cy: number, ex: number, ey: number) => {\r\n  var dy = ey - cy;\r\n  var dx = ex - cx;\r\n  var theta = Math.atan2(dy, dx); // range (-PI, PI]\r\n  theta *= 180 / Math.PI; // rads to degree, range (-180, 180]\r\n  if (theta < 0) theta = 360 + theta; // range [0, 360)\r\n  theta = (theta + 90) % 360; // subtract 90 degree since we are grabbing from the top.\r\n  return theta;\r\n};\r\n"],"names":["Subject","WorkflowsDataSource","constructor","workflows","sort","changed","setWorkflows","getItems","startsWith","currentValue","successCallBack","failureCallBack","items","Array","workflow","item","name","value","id","push","x","y","localeCompare","WorkflowStepsDataSource","moveToWorkflow","selectedWorkflow","find","w","selectedWorkflowId","steps","workflowSteps","sortedSteps","step","TranslateService","StyleType","TemplateStyle","uniqueID","mapInlineStylesToString","OlcTemplateStylesService","translateService","defaultOlcStyles","instant","element","elementType","Block","classes","inlineStyles","getOlcTemplateStyles","template","customStyles","templateStyles","templatePredefinedStyles","map","s","forEach","None","isDuplicate","isDuplicateStyle","length","cs","defaultStyle","d","styleMatches","elementToCompare","tagName","replace","toLocaleLowerCase","style","styleTagName","styleClasses","inlineStylesString","equalTagName","equalClasses","equalStyles","i0","ɵɵinject","i1","factory","ɵfac","providedIn","chr4","Math","random","toString","slice","angle","cx","cy","ex","ey","dy","dx","theta","atan2","PI"],"sourceRoot":"webpack:///","x_google_ignoreList":[]}