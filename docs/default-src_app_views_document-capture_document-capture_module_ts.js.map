{"version":3,"file":"default-src_app_views_document-capture_document-capture_module_ts.js","mappings":"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","sources":["./src/app/blocks/box/box-head/box-head.component.ts","./src/app/blocks/box/box-head/box-head.component.html","./src/app/blocks/box/box.module.ts","./src/app/blocks/components/split-button/split-button.component.ts","./src/app/blocks/components/split-button/split-button.component.html","./src/app/blocks/models/folder-view.ts","./src/app/blocks/models/update-field-data.ts","./src/app/blocks/services/modals-utilities.service.ts","./src/app/views/document-capture/capture-models/capture-constants.ts","./src/app/views/document-capture/capture-models/sorting.ts","./src/app/views/document-capture/capture-services/document-list-style.service.ts","./src/app/views/document-capture/capture-services/document-locking.service.ts","./src/app/views/document-capture/capture-services/folder-view-events.service.ts","./src/app/views/document-capture/delivery-error/delivery-error.component.ts","./src/app/views/document-capture/delivery-error/delivery-error.component.html","./src/app/views/document-capture/document-capture-routing.module.ts","./src/app/views/document-capture/document-capture.component.ts","./src/app/views/document-capture/document-capture.component.html","./src/app/views/document-capture/document-capture.module.ts","./src/app/views/document-capture/document-locked/document-locked.component.ts","./src/app/views/document-capture/document-locked/document-locked.component.html","./src/app/views/document-capture/document-viewer/document-viewer.component.ts","./src/app/views/document-capture/document-viewer/document-viewer.component.html","./src/app/views/document-capture/document-viewer/thumbnails/thumbnail/thumbnail.component.ts","./src/app/views/document-capture/document-viewer/thumbnails/thumbnail/thumbnail.component.html","./src/app/views/document-capture/document-viewer/thumbnails/thumbnails.component.ts","./src/app/views/document-capture/document-viewer/thumbnails/thumbnails.component.html","./src/app/views/document-capture/documents-list/document/document.component.ts","./src/app/views/document-capture/documents-list/document/document.component.html","./src/app/views/document-capture/documents-list/documents-list.component.ts","./src/app/views/document-capture/documents-list/documents-list.component.html","./src/app/views/document-capture/documents-list/folder/folder.component.ts","./src/app/views/document-capture/documents-list/folder/folder.component.html","./src/app/views/document-capture/documents-list/work-item/work-item.component.ts","./src/app/views/document-capture/documents-list/work-item/work-item.component.html","./src/app/views/document-capture/indexing-panel/indexing-panel.component.ts","./src/app/views/document-capture/indexing-panel/indexing-panel.component.html","./src/app/views/document-capture/line-item-indexing/line-item-indexing.component.ts","./src/app/views/document-capture/line-item-indexing/line-item-indexing.component.html","./src/app/views/document-capture/toolbar/toolbar.component.ts","./src/app/views/document-capture/toolbar/toolbar.component.html"],"sourcesContent":["import { Component, Input, OnInit } from '@angular/core';\r\n\r\n@Component({\r\n  selector: '[appBoxHead]',\r\n  templateUrl: './box-head.component.html',\r\n})\r\nexport class BoxHeadComponent implements OnInit {\r\n  isViewDropDownOpen: boolean;\r\n  @Input() headText: string;\r\n  @Input() headButton;\r\n\r\n  constructor() {}\r\n\r\n  ngOnInit() {}\r\n\r\n  onClick() {\r\n    this.headButton.buttonFunction();\r\n  }\r\n}\r\n","<span class=\"headText\">{{ headText | translate }}</span>\r\n\r\n<div *ngIf=\"headButton\" class=\"box-head__right-panel project-list-pages\">\r\n  <button (click)=\"onClick()\" [class]=\"headButton.buttonClass\" tabindex=\"1\">{{ headButton.buttonText }}</button>\r\n</div>\r\n","import { NgModule } from '@angular/core';\r\nimport { CommonModule } from '@angular/common';\r\nimport { BoxHeadComponent } from './box-head/box-head.component';\r\nimport { TranslateModule } from '@ngx-translate/core';\r\nimport { ComponentsModule } from '../components/components.module';\r\nimport { OpenDropdownModule } from 'shared-code-lib';\r\n\r\n@NgModule({\r\n  imports: [CommonModule, TranslateModule, ComponentsModule, OpenDropdownModule],\r\n  exports: [BoxHeadComponent],\r\n  declarations: [BoxHeadComponent],\r\n})\r\nexport class BoxModule {}\r\n","import {\r\n  Component,\r\n  OnInit,\r\n  Input,\r\n  HostListener,\r\n  ElementRef,\r\n  ChangeDetectorRef,\r\n  ViewEncapsulation,\r\n  OnChanges,\r\n  SimpleChanges,\r\n} from '@angular/core';\r\nimport { ISplitButtonItem } from './split-item';\r\nimport { ActionService } from '../../services/action.service';\r\nimport { ActionEvent } from '../../core/actions';\r\nimport { TranslateService } from '@ngx-translate/core';\r\nimport { KeyboardActionMapping } from '../../core/keyboardActionMapping';\r\n\r\n@Component({\r\n  selector: 'app-splitbutton',\r\n  templateUrl: './split-button.component.html',\r\n  styleUrls: ['./split-button.component.scss'],\r\n  encapsulation: ViewEncapsulation.None,\r\n})\r\nexport class SplitButtonComponent implements OnInit, OnChanges {\r\n  @Input() items: ISplitButtonItem[];\r\n  showDropDown = false;\r\n  mainItem: ISplitButtonItem;\r\n\r\n  constructor(\r\n    private elementRef: ElementRef,\r\n    private cdr: ChangeDetectorRef,\r\n    private actionService: ActionService,\r\n    private translate: TranslateService\r\n  ) {}\r\n\r\n  ngOnInit() {\r\n    this.setMainItem();\r\n  }\r\n\r\n  ngOnChanges(changes: SimpleChanges): void {\r\n    if (changes.items) this.setMainItem();\r\n  }\r\n\r\n  setMainItem = (): void => {\r\n    this.mainItem = this.items && this.items.length ? this.items[0] : null;\r\n  };\r\n\r\n  activateAction = (item: ISplitButtonItem): void => {\r\n    this.actionService.activateAction(new ActionEvent(item.action));\r\n  };\r\n\r\n  getItemTitle = (item: ISplitButtonItem): string => {\r\n    const action = this.translate.instant(`Actions.${item.action}`);\r\n    const mapping = KeyboardActionMapping.getTooltipFor(item.action,this.translate);\r\n\r\n    return `${action} ${mapping}`;\r\n  };\r\n\r\n  getItemActionName = (item: ISplitButtonItem): string => {\r\n    return this.translate.instant(`Actions.${item.action}`);\r\n  };\r\n\r\n  getItemKeyMapping = (item: ISplitButtonItem): string => {\r\n    return KeyboardActionMapping.getTooltipFor(item.action,this.translate);\r\n  };\r\n\r\n  getItems = (): ISplitButtonItem[] => {\r\n    if (!this.items || !this.items.length) {\r\n      return [];\r\n    }\r\n\r\n    return this.items.filter(i => i != this.items[0]);\r\n  };\r\n\r\n  onSplitButtonClicked() {\r\n    if (this.mainItem && this.mainItem.enabled) this.activateAction(this.mainItem);\r\n  }\r\n\r\n  @HostListener('document:click', ['$event', '$event.target'])\r\n  onClick(event: MouseEvent, targetElement: HTMLElement): void {\r\n    if (!targetElement) return;\r\n\r\n    if (this.elementRef.nativeElement.querySelector('.split-dropdown').contains(targetElement)) {\r\n      this.showDropDown = !this.showDropDown;\r\n    } else {\r\n      this.showDropDown = false;\r\n    }\r\n\r\n    this.cdr.detectChanges();\r\n  }\r\n}\r\n","<div class=\"split-button\" tabindex=\"0\" (keydown.enter)=\"onSplitButtonClicked()\">\r\n  <button\r\n    *ngIf=\"mainItem\"\r\n    class=\"button-icon\"\r\n    style=\"border: 0 !important;\"\r\n    (click)=\"activateAction(mainItem)\"\r\n    [title]=\"getItemTitle(mainItem)\"\r\n    [disabled]=\"!mainItem.enabled\"\r\n    tabindex=\"-1\"\r\n  >\r\n    <img [src]=\"mainItem.image\" alt=\"\" />\r\n  </button>\r\n\r\n  <div *ngIf=\"items.length\">\r\n    <div class=\"split-dropdown\">\r\n      <i class=\"caret\"></i>\r\n      <div class=\"dropdown-content\" *ngIf=\"showDropDown\">\r\n        <a *ngFor=\"let item of getItems()\" (click)=\"activateAction(item)\" [class.disabled]=\"!item.enabled\">\r\n          {{ getItemActionName(item) }}\r\n          <span class=\"pull-right\">{{ getItemKeyMapping(item) }}</span></a\r\n        >\r\n      </div>\r\n    </div>\r\n  </div>\r\n</div>\r\n","export interface IFolderView {\r\n  id: string;\r\n  tenantId: string;\r\n  workflowId: string;\r\n  workflowStepId: string;\r\n  parentId: string;\r\n  name: string;\r\n  itemCount: number;\r\n}\r\n\r\nexport class FolderView implements IFolderView {\r\n  constructor(\r\n    public id: string,\r\n    public tenantId: string,\r\n    public workflowId: string,\r\n    public workflowStepId: string,\r\n    public parentId: string,\r\n    public name: string,\r\n    public itemCount: number\r\n  ) {}\r\n}\r\n","import { ILocation, Location } from 'shared-code-lib';\r\n\r\nexport interface IUpdateFieldData {\r\n  context: any;\r\n  value: string;\r\n  location: ILocation;\r\n}\r\n\r\nexport class UpdateFieldData implements IUpdateFieldData {\r\n  constructor(public context: any, public value: string, public location: Location) {}\r\n}\r\n\r\nexport interface IUpdateGroupOfFields {\r\n  context: any;\r\n  values: Array<string>;\r\n}\r\n\r\nexport class UpdateGroupOfFields implements IUpdateGroupOfFields {\r\n  constructor(public context: any, public values: Array<string>) {}\r\n}\r\n","import { Injectable } from '@angular/core';\r\nimport { NgxSmartModalService } from 'ngx-smart-modal';\r\nimport { ModalInstance } from 'ngx-smart-modal/lib/services/modal-instance';\r\n\r\n@Injectable({\r\n  providedIn: 'root',\r\n})\r\nexport class ModalsUtilitiesService {\r\n  constructor(private ngxSmartModalService: NgxSmartModalService) {}\r\n\r\n  isAnyModalOpened() {\r\n    const openedModals = this.ngxSmartModalService.getOpenedModals();\r\n    if (openedModals.length === 0) return false;\r\n    return openedModals.length > 1 || !this.onlyHiddenScanToModal(openedModals);\r\n  }\r\n\r\n  private onlyHiddenScanToModal(openedModals: ModalInstance[]) {\r\n    return (\r\n      openedModals.length === 1 &&\r\n      openedModals[0]?.id === 'ScanToModal' &&\r\n      !!document.querySelector('.scan-to-modal-hidden')\r\n    );\r\n  }\r\n}\r\n","export class CaptureConstants {\r\n  static readonly folder: string = 'folder';\r\n  static readonly document: string = 'document';\r\n  static readonly page: string = 'page';\r\n}\r\n","export class DocumentsGridSortingConfig {\r\n  index: number;\r\n  type: SortingType;\r\n  workflowStepId: string;\r\n}\r\n\r\nexport enum SortingType {\r\n  None = 0,\r\n  Asc = 1,\r\n  Desc = -1,\r\n}\r\n","import { Injectable } from '@angular/core';\r\nimport { Subject } from 'rxjs';\r\nimport { DocumentListStyle } from '../capture-models/document-list-style';\r\n\r\n@Injectable({\r\n  providedIn: 'root',\r\n})\r\nexport class DocumentListStyleService {\r\n  documentListStyle: DocumentListStyle = DocumentListStyle.Tree;\r\n\r\n  private _documentListStyleSubject = new Subject<DocumentListStyle>();\r\n  onChangeDocumentListStyle = this._documentListStyleSubject.asObservable();\r\n\r\n  update = (style: DocumentListStyle): void => {\r\n    this.documentListStyle = style;\r\n    this._documentListStyleSubject.next(style);\r\n  };\r\n\r\n  getStyle = (): DocumentListStyle => {\r\n    return this.documentListStyle;\r\n  };\r\n}\r\n","import { EventEmitter, Injectable } from '@angular/core';\r\nimport { Subscription } from 'rxjs';\r\nimport { AuthService, DelayService } from 'shared-code-lib';\r\nimport { LockAction, LockStatus } from '../../../blocks/models/lock-status';\r\nimport { HydraApiService } from '../../../blocks/services/hydra-api.service';\r\nimport { User } from '../../../blocks/services/models';\r\nimport { UserStateService } from '../../../blocks/services/user-state.service';\r\nimport { CapturedDocument } from '../capture-models';\r\nimport { CaptureUpdateService } from './capture-update.service';\r\n\r\n@Injectable({\r\n  providedIn: 'root',\r\n})\r\nexport class DocumentLockingService {\r\n  private static leaseRefreshIntervalSeconds = 60 * 1000;\r\n\r\n  private lockStatuses = {};\r\n\r\n  public lockStatusChanged = new EventEmitter<LockStatus>();\r\n  private currentUser: User;\r\n\r\n  subscriptions = new Subscription();\r\n\r\n  constructor(\r\n    private hydraApi: HydraApiService,\r\n    private delayService: DelayService,\r\n    private userStateService: UserStateService,\r\n    private captureUpdateService: CaptureUpdateService,\r\n    private authService: AuthService\r\n  ) {\r\n    delayService.execute(this.refreshLease, DocumentLockingService.leaseRefreshIntervalSeconds);\r\n\r\n    this.subscriptions.add(captureUpdateService.onChangeDocument.subscribe(this.onDocumentChanged));\r\n    this.subscriptions.add(userStateService.userChanged.subscribe(this.onUserChanged));\r\n    this.subscriptions.add(authService.onLogout.subscribe(this.unlockDocuments));\r\n\r\n    this.currentUser = userStateService.user;\r\n  }\r\n\r\n  private onDocumentChanged = (doc: CapturedDocument): void => {\r\n    this.unlockDocuments();\r\n\r\n    if (doc) {\r\n      this.lock(doc.workitem.id);\r\n    }\r\n  };\r\n\r\n  private onUserChanged = (user: User): void => {\r\n    if (!user) return;\r\n\r\n    this.unlockDocuments();\r\n    this.currentUser = user;\r\n  };\r\n\r\n  public unlockDocuments = (): void => {\r\n    if (!this.userStateService.isLoggedIn()) return;\r\n\r\n    for (const documentId in this.lockStatuses) {\r\n      const ls: LockStatus = this.lockStatuses[documentId];\r\n      if (ls == null) continue;\r\n\r\n      if (ls.lockedByUserId != this.currentUser.id) continue;\r\n      if (!ls.locked) continue;\r\n\r\n      this.unlock(documentId);\r\n    }\r\n  };\r\n\r\n  public isLocked = (documentId: string): boolean => {\r\n    const ls: LockStatus = this.lockStatuses[documentId];\r\n    if (!ls) return false;\r\n\r\n    return ls.locked && !ls.expired;\r\n  };\r\n\r\n  public isLockedByCurrentUser = (documentId: string): boolean => {\r\n    if (!this.currentUser) return false;\r\n\r\n    const ls: LockStatus = this.lockStatuses[documentId];\r\n    if (!ls) return false;\r\n\r\n    return ls.locked && ls.lockedByUserId == this.currentUser.id && !ls.expired();\r\n  };\r\n\r\n  public lock = (documentId: string): void => {\r\n    this.lockStatuses[documentId] = null;\r\n    this.hydraApi.setDocumentLock(LockAction.Lock, documentId, this.onDocumentLockedChanged, this.onDocumentLockFailed);\r\n  };\r\n\r\n  public unlock = (documentId: string): void => {\r\n    this.hydraApi.setDocumentLock(\r\n      LockAction.Unlock,\r\n      documentId,\r\n      this.onDocumentLockedChanged,\r\n      this.onDocumentUnlockFailed\r\n    );\r\n  };\r\n\r\n  public refreshLease = (): void => {\r\n    if (!this.currentUser) return;\r\n\r\n    for (const documentId in this.lockStatuses) {\r\n      const ls: LockStatus = this.lockStatuses[documentId];\r\n      if (ls == null) continue;\r\n\r\n      if (ls.lockedByUserId != this.currentUser.id) continue;\r\n      if (!ls.locked) continue;\r\n\r\n      this.hydraApi.refreshLock(ls.id, this.onDocumentLockedChanged, this.onDocumentLockFailed);\r\n    }\r\n\r\n    this.delayService.execute(this.refreshLease, DocumentLockingService.leaseRefreshIntervalSeconds);\r\n  };\r\n\r\n  private onDocumentLockedChanged = (lockStatus: LockStatus): void => {\r\n    this.lockStatuses[lockStatus.id] = lockStatus;\r\n\r\n    this.lockStatusChanged.emit(lockStatus);\r\n  };\r\n\r\n  private onDocumentLockFailed = (err): void => {\r\n    console.log(err);\r\n    //toast: ?\r\n  };\r\n\r\n  private onDocumentUnlockFailed = (err): void => {\r\n    //toast: ?\r\n  };\r\n}\r\n","import { Injectable } from '@angular/core';\r\n\r\nimport * as signalR from '@microsoft/signalr';\r\nimport { Subject } from 'rxjs';\r\n\r\nimport { AuthService } from 'shared-code-lib';\r\nimport { HubConnectionOperations } from '../../../blocks/core/hubconnection-operations';\r\nimport { Log } from '../../../blocks/core/log';\r\nimport { FolderItem } from '../../../blocks/models/folder-item';\r\nimport { FolderView } from '../../../blocks/models/folder-view';\r\nimport { EventTypes, FolderViewEvent, ItemTypes } from '../../../blocks/models/folder-view-event';\r\nimport { WorkItem } from '../../../blocks/models/work-item';\r\nimport { Workflow } from '../../../blocks/models/workflow';\r\nimport { CapturedDocument } from '../capture-models';\r\nimport { DocumentsGridSortingConfig } from '../capture-models/sorting';\r\nimport { CaptureUpdateService } from './capture-update.service';\r\nimport { DocumentCaptureService } from './document-capture.service';\r\n\r\n@Injectable({\r\n  providedIn: 'root',\r\n})\r\nexport class FolderViewEventsService {\r\n  private _hubConnection: signalR.HubConnection;\r\n  private _addFolderSubject = new Subject<FolderView>();\r\n  private _deleteFolderSubject = new Subject<FolderView>();\r\n  private _updateFolderSubject = new Subject<FolderView>();\r\n  private _addItemSubject = new Subject<FolderItem>();\r\n  private _deleteItemSubject = new Subject<FolderItem>();\r\n  private _updateItemSubject = new Subject<FolderItem>();\r\n  private _sortGridColumnData = new Subject<DocumentsGridSortingConfig>();\r\n  private allowReconnect: boolean = true;\r\n\r\n  onAddFolder = this._addFolderSubject.asObservable();\r\n  onDeleteFolder = this._deleteFolderSubject.asObservable();\r\n  onUpdateFolder = this._updateFolderSubject.asObservable();\r\n  onAddItem = this._addItemSubject.asObservable();\r\n  onDeleteItem = this._deleteItemSubject.asObservable();\r\n  onUpdateItem = this._updateItemSubject.asObservable();\r\n  onSortGridColumnData = this._sortGridColumnData.asObservable();\r\n\r\n  constructor(\r\n    private captureUpdate: CaptureUpdateService,\r\n    private documentCaptureService: DocumentCaptureService,\r\n    private authService: AuthService\r\n  ) {\r\n    if (documentCaptureService.currentWorkflow) {\r\n      this.allowReconnect = true;\r\n      this.connectFolderEvents(documentCaptureService.currentWorkflow);\r\n    }\r\n\r\n    this.captureUpdate.onChangeWorkflow.subscribe((workflow) => {\r\n      if (workflow) {\r\n        this.allowReconnect = true;\r\n        this.connectFolderEvents(workflow);\r\n      }\r\n    });\r\n  }\r\n\r\n  connectFolderEvents(workflow: Workflow) {\r\n    try {\r\n      if (!this.allowReconnect) return;\r\n\r\n      if (this._hubConnection && this._hubConnection.state === signalR.HubConnectionState.Connected) {\r\n        this.allowReconnect = false;\r\n        this._hubConnection.stop().then(() => {\r\n          delete this._hubConnection;\r\n          this.startFolderEvents(workflow);\r\n        });\r\n      } else {\r\n        this.startFolderEvents(workflow);\r\n      }\r\n    } catch (e) {\r\n      Log.error('FolderViewEventsService.connectFolderEvents', e);\r\n    }\r\n  }\r\n\r\n  startFolderEvents(workflow: Workflow) {\r\n    try {\r\n      this._hubConnection = new signalR.HubConnectionBuilder()\r\n        .withUrl('/eventhub', { accessTokenFactory: () => this.authService.getToken() })\r\n        .build();\r\n      HubConnectionOperations.setTimeout(this._hubConnection);\r\n      this._hubConnection.start().catch((err) => console.log(err));\r\n\r\n      this.allowReconnect = true;\r\n\r\n      const notificationEvent = `folderview-${workflow.id}`;\r\n      this._hubConnection.on(notificationEvent, (folderViewEvent: FolderViewEvent) => {\r\n        if (folderViewEvent.eventType === EventTypes.added) {\r\n          this.addEventItem(folderViewEvent);\r\n        } else if (folderViewEvent.eventType === EventTypes.updated) {\r\n          this.updateEventItem(folderViewEvent);\r\n        } else if (folderViewEvent.eventType === EventTypes.deleted) {\r\n          this.deleteEventItem(folderViewEvent);\r\n        }\r\n      });\r\n\r\n      HubConnectionOperations.executeOnClose(this._hubConnection, () => {\r\n        this.connectFolderEvents(workflow);\r\n      });\r\n    } catch (e) {\r\n      Log.error('FolderViewEventsService.startFolderEvents', e);\r\n    }\r\n  }\r\n\r\n  createEventFolderView(data: any) {\r\n    return new FolderView(\r\n      data.Id,\r\n      data.TenantId,\r\n      data.WorkflowId,\r\n      data.WorkflowStepId,\r\n      data.ParentId,\r\n      data.Name,\r\n      data.ItemCount\r\n    );\r\n  }\r\n\r\n  addEventItem(folderViewEvent: FolderViewEvent) {\r\n    if (folderViewEvent.itemType === ItemTypes.folder) {\r\n      this.addFolderView(this.createEventFolderView(folderViewEvent.data));\r\n    } else if (folderViewEvent.itemType === ItemTypes.item) {\r\n      this.addFolderItem(\r\n        new FolderItem(\r\n          folderViewEvent.data.parentId,\r\n          new WorkItem(folderViewEvent.data.workItem),\r\n          folderViewEvent.data.documents\r\n        )\r\n      );\r\n    }\r\n  }\r\n\r\n  updateEventItem(folderViewEvent: FolderViewEvent) {\r\n    if (folderViewEvent.itemType === ItemTypes.folder) {\r\n      this.updateFolderView(this.createEventFolderView(folderViewEvent.data));\r\n    } else if (folderViewEvent.itemType === ItemTypes.item) {\r\n      this.updateFolderItem(\r\n        new FolderItem(\r\n          folderViewEvent.data.parentId,\r\n          new WorkItem(folderViewEvent.data.workItem),\r\n          folderViewEvent.data.documents\r\n        )\r\n      );\r\n    }\r\n  }\r\n\r\n  deleteEventItem(folderViewEvent: FolderViewEvent) {\r\n    if (folderViewEvent.itemType === ItemTypes.folder) {\r\n      this.deleteFolderView(this.createEventFolderView(folderViewEvent.data));\r\n    } else if (folderViewEvent.itemType === ItemTypes.item) {\r\n      this.deleteFolderItem(\r\n        new FolderItem(\r\n          folderViewEvent.data.parentId,\r\n          new WorkItem(folderViewEvent.data.workItem),\r\n          folderViewEvent.data.documents\r\n        )\r\n      );\r\n    }\r\n  }\r\n\r\n  addFolderView(folderView: FolderView) {\r\n    this._addFolderSubject.next(folderView);\r\n  }\r\n\r\n  updateFolderView(folderView: FolderView) {\r\n    this._updateFolderSubject.next(folderView);\r\n  }\r\n\r\n  deleteFolderView(folderView: FolderView) {\r\n    this._deleteFolderSubject.next(folderView);\r\n  }\r\n\r\n  addFolderItem(folderItem: FolderItem) {\r\n    this._addItemSubject.next(folderItem);\r\n  }\r\n\r\n  updateFolderItem(folderItem: FolderItem) {\r\n    this._updateItemSubject.next(folderItem);\r\n    this.captureUpdate.updateWorkitemMetadata(folderItem.workItem, this.documentCaptureService.getCurrentWorkItem());\r\n    this.checkParentFolderChange(folderItem);\r\n  }\r\n\r\n  deleteFolderItem(folderItem: FolderItem) {\r\n    this._deleteItemSubject.next(folderItem);\r\n  }\r\n\r\n  sortGridColumnData(sortingConfig: DocumentsGridSortingConfig) {\r\n    this._sortGridColumnData.next(sortingConfig);\r\n  }\r\n\r\n  checkParentFolderChange(fv: FolderItem) {\r\n    const doc = this.documentCaptureService.getCurrentDocument();\r\n    if (!doc || doc.workItemId != fv.workItem?.id) return;\r\n    if (doc.parentFolderId == fv.parentId) return;\r\n\r\n    const updatedDocument = new CapturedDocument(doc.document, fv.workItem, fv.parentId);\r\n    this.captureUpdate.updateParentFolder(updatedDocument);\r\n  }\r\n}\r\n","import { Component, OnDestroy, OnInit, ViewEncapsulation } from '@angular/core';\r\nimport { TranslateService } from '@ngx-translate/core';\r\nimport { ActiveToast, ToastrService } from 'ngx-toastr';\r\nimport { Subscription } from 'rxjs';\r\n\r\nimport { SystemMetaData } from '../../../blocks/core/systemMetaData';\r\nimport { WorkItem } from '../../../blocks/models/work-item';\r\nimport { DocumentCaptureService } from '../capture-services';\r\nimport { CaptureUpdateService } from '../capture-services/capture-update.service';\r\n\r\n@Component({\r\n  selector: 'app-delivery-error',\r\n  templateUrl: './delivery-error.component.html',\r\n  styleUrls: ['./delivery-error.component.scss'],\r\n  encapsulation: ViewEncapsulation.None,\r\n})\r\nexport class DeliveryErrorComponent implements OnInit, OnDestroy {\r\n  toastMessagesArr: Array<ActiveToast<any>> = [];\r\n\r\n  constructor(\r\n    private capture: DocumentCaptureService,\r\n    private captureUpdate: CaptureUpdateService,\r\n    private toastr: ToastrService,\r\n    private translate: TranslateService\r\n  ) {\r\n    this.subscriptions = new Subscription();\r\n    this.subscriptions.add(\r\n      this.captureUpdate.onChangeDocument.subscribe(() => {\r\n        this.workItem = this.capture.getCurrentWorkItem();\r\n      })\r\n    );\r\n  }\r\n\r\n  workItem: WorkItem;\r\n  subscriptions: Subscription;\r\n\r\n  ngOnInit() {\r\n    this.workItem = this.capture.getCurrentWorkItem();\r\n  }\r\n\r\n  ngOnDestroy() {\r\n    this.subscriptions.unsubscribe();\r\n\r\n    this.toastMessagesArr.forEach((m) => this.toastr.clear(m.toastId));\r\n  }\r\n\r\n  get deliveryError() {\r\n    if (!this.workItem) return null;\r\n\r\n    const deliveryErrorMetaData = this.workItem.getMetaData(SystemMetaData.DeliveryErrorMessage);\r\n    return deliveryErrorMetaData && deliveryErrorMetaData.value ? deliveryErrorMetaData : null;\r\n  }\r\n\r\n  get deliveryErrorTitle() {\r\n    return this.translate.instant('Document_Capture.delivery-error');\r\n  }\r\n\r\n  showErrorDetails() {\r\n    const errorMessage = this.toastr.error(this.deliveryError.value as string, this.deliveryErrorTitle, {\r\n      closeButton: true,\r\n      tapToDismiss: false,\r\n      disableTimeOut: true,\r\n    });\r\n\r\n    this.toastMessagesArr.push(errorMessage);\r\n  }\r\n}\r\n","<div *ngIf=\"deliveryError\" class=\"delivery-error\" (click)=\"showErrorDetails()\">\r\n  {{ 'Document_Capture.delivery-error' | translate }} <span class=\"badge badge-pill badge-danger\">1</span>\r\n</div>\r\n","import { NgModule } from '@angular/core';\r\nimport { RouterModule, Routes } from '@angular/router';\r\nimport { DocumentCaptureComponent } from './document-capture.component';\r\n\r\nconst routes: Routes = [\r\n  {\r\n    path: '',\r\n    component: DocumentCaptureComponent,\r\n    pathMatch: 'full',\r\n  },\r\n  {\r\n    path: ':workflowId:/:workflowStepId/:groupingValue',\r\n    component: DocumentCaptureComponent,\r\n    pathMatch: 'full',\r\n  },\r\n];\r\n\r\n@NgModule({\r\n  imports: [RouterModule.forChild(routes)],\r\n  exports: [RouterModule],\r\n})\r\nexport class DocumentCaptureRoutingModule {}\r\n","import { Component, ElementRef, OnDestroy, OnInit, ViewChild, ViewEncapsulation } from '@angular/core';\r\nimport { TranslateService } from '@ngx-translate/core';\r\nimport { NgxSmartModalComponent, NgxSmartModalService } from 'ngx-smart-modal';\r\nimport { Subject, Subscription } from 'rxjs';\r\n\r\nimport { ToastrService } from 'ngx-toastr';\r\nimport { MetaDataCollection, UserPreferencesService } from 'shared-code-lib';\r\nimport { Log } from '../../blocks/core/log';\r\nimport { FolderItem } from '../../blocks/models/folder-item';\r\nimport { LockStatus } from '../../blocks/models/lock-status';\r\nimport { UpdateFieldData, UpdateGroupOfFields } from '../../blocks/models/update-field-data';\r\nimport { HydraApiService } from '../../blocks/services/hydra-api.service';\r\nimport { SpinnerStateService } from '../../blocks/services/spinner-state.service';\r\nimport { UserStateService } from '../../blocks/services/user-state.service';\r\nimport { CapturedDocument, DocumentListStyle, IndexingPanels, Page, Preference } from './capture-models';\r\nimport { ScanPages, ScanPagesResult } from './capture-models/scan-commands';\r\nimport { DocumentCaptureService, IndexingPanelService } from './capture-services';\r\nimport { CaptureUpdateService } from './capture-services/capture-update.service';\r\nimport { DocumentListStyleService } from './capture-services/document-list-style.service';\r\nimport { DocumentLockingService } from './capture-services/document-locking.service';\r\nimport { FolderViewEventsService } from './capture-services/folder-view-events.service';\r\nimport { ScanAppService } from './capture-services/scan-app.service';\r\n\r\n@Component({\r\n  templateUrl: './document-capture.component.html',\r\n  styleUrls: ['./document-capture.component.scss'],\r\n  encapsulation: ViewEncapsulation.None,\r\n})\r\nexport class DocumentCaptureComponent implements OnInit, OnDestroy {\r\n  @ViewChild('contentWrapper', { static: true }) contentWrapper: ElementRef;\r\n  selectedPage: Page;\r\n  showLineItemPanel: boolean;\r\n  widthResizedSubject: Subject<void>;\r\n  heightResizedSubject: Subject<void>;\r\n  focusedPanel = IndexingPanels[0];\r\n  routingWrapper: HTMLElement;\r\n  confirmationModal: NgxSmartModalComponent;\r\n  showDriverModal: boolean;\r\n  scanModal: NgxSmartModalComponent;\r\n  captureModal: NgxSmartModalComponent;\r\n  readonly panelsWrapperKey = 'doc-cap-pWrapperWidth';\r\n  readonly panelsDocumentGridWrapperKey = 'doc-cap-pDocumentGridWrapperWidth';\r\n  readonly indexingPanelKey = 'doc-cap-indexingPHeight';\r\n  readonly lineItemsPanelKey = 'doc-cap-lineItemPHeight';\r\n  currentStepHasIndexing = false;\r\n  scanPages: ScanPages;\r\n  isGridView: boolean;\r\n\r\n  subscriptions = new Subscription();\r\n\r\n  selectedDocument: CapturedDocument;\r\n  documentLocked: boolean;\r\n\r\n  readonly DocumentListStylePreference = 'DocumentListStylePreferenceId';\r\n\r\n  constructor(\r\n    public captureService: DocumentCaptureService,\r\n    private indexingService: IndexingPanelService,\r\n    private captureUpdate: CaptureUpdateService,\r\n    private scanAppService: ScanAppService,\r\n    private userStateService: UserStateService,\r\n    public ngxSmartModalService: NgxSmartModalService,\r\n    private spinnerState: SpinnerStateService,\r\n    private translate: TranslateService,\r\n    private documentListStyleService: DocumentListStyleService,\r\n    private documentLockingService: DocumentLockingService,\r\n    private userPreferencesService: UserPreferencesService,\r\n    private hydraApi: HydraApiService,\r\n    private folderView: FolderViewEventsService,\r\n    private toastr: ToastrService\r\n  ) {\r\n    this.widthResizedSubject = new Subject<void>();\r\n    this.heightResizedSubject = new Subject<void>();\r\n  }\r\n\r\n  ngOnInit() {\r\n    Log.enter('DocumentCaptureComponent.ngOnInit');\r\n\r\n    try {\r\n      this.subscriptions.add(this.documentLockingService.lockStatusChanged.subscribe(this.lockStatusChanged));\r\n\r\n      this.subscriptions.add(\r\n        this.captureUpdate.onChangeDocument.subscribe((doc) => {\r\n          this.documentLocked = false;\r\n          this.selectedDocument = doc;\r\n          this.hydraApi.onDocumentChanged();\r\n        })\r\n      );\r\n\r\n      this.subscriptions.add(this.folderView.onUpdateItem.subscribe(this.onWorkItemUpdated));\r\n\r\n      this.subscriptions.add(\r\n        this.scanAppService.onDocumentScanned.subscribe((scanresult: ScanPagesResult) =>\r\n          scanresult.scanpages.process(this.captureService, scanresult.data)\r\n        )\r\n      );\r\n\r\n      this.subscriptions.add(\r\n        this.scanAppService.onTransferDocument.subscribe(() => {\r\n          this.closeScanModal();\r\n        })\r\n      );\r\n\r\n      this.subscriptions.add(\r\n        this.indexingService.onChangeLineItemIndexing.subscribe((show: boolean) => {\r\n          this.showLineItemPanel = show;\r\n          this.currentStepHasIndexing = this.captureService.currentStepHasIndexing();\r\n        })\r\n      );\r\n\r\n      this.subscriptions.add(\r\n        this.documentListStyleService.onChangeDocumentListStyle.subscribe((style: DocumentListStyle) => {\r\n          this.isGridView = style === DocumentListStyle.Grid;\r\n\r\n          if (style === DocumentListStyle.Tree) {\r\n            setTimeout(() => {\r\n              this.captureService.reInitIndexing();\r\n              this.reloadCurrentWorkitemMetadata();\r\n            }, 100);\r\n          }\r\n        })\r\n      );\r\n\r\n      let documentListStyle = this.userPreferencesService.getPreference(this.DocumentListStylePreference);\r\n      if (!documentListStyle) {\r\n        documentListStyle = DocumentListStyle.Tree;\r\n      }\r\n\r\n      this.documentListStyleService.update(documentListStyle);\r\n      this.isGridView = documentListStyle === DocumentListStyle.Grid;\r\n    } catch (e) {\r\n      Log.error('DocumentCaptureComponent.ngOnInit', e);\r\n    }\r\n  }\r\n\r\n  ngOnDestroy() {\r\n    this.subscriptions.unsubscribe();\r\n    this.captureService.reset();\r\n\r\n    this.documentLockingService.unlockDocuments();\r\n  }\r\n\r\n  onWorkItemUpdated = (folderItem: FolderItem): void => {\r\n    if (!this.selectedDocument || folderItem.documents[0].id != this.selectedDocument?.id) return;\r\n\r\n    const doc = this.selectedDocument.document;\r\n    if (folderItem.documents.find((x) => x.pageCount == doc.pageCount && x.size == doc.size)) return;\r\n\r\n    this.captureService.selectDocument(folderItem.documents[0], folderItem.workItem, folderItem.parentId, null, true);\r\n  };\r\n\r\n  lockStatusChanged = (ls: LockStatus): void => {\r\n    if (!this.selectedDocument || !this.selectedDocument.workitem) return;\r\n\r\n    if (ls.id == this.selectedDocument.workitem.id) {\r\n      this.documentLocked = ls.locked && ls.lockedByUserId == this.userStateService.user.id && !ls.expired();\r\n    }\r\n  };\r\n\r\n  widthResized() {\r\n    this.widthResizedSubject.next();\r\n  }\r\n\r\n  onResize(preference: Preference) {\r\n    this.userPreferencesService.setPreference(preference.name, preference.value);\r\n  }\r\n\r\n  getPreferenceValue(key: string, defaultValue: string): string {\r\n    return this.userPreferencesService.getPreference(key) || defaultValue;\r\n  }\r\n\r\n  getDocumentPanelWidthPreference() {\r\n    return this.getPreferenceValue(this.getPanelWrapperKey(), '25');\r\n  }\r\n\r\n  getPanelWrapperKey() {\r\n    return this.isGridView ? this.panelsDocumentGridWrapperKey : this.panelsWrapperKey;\r\n  }\r\n\r\n  heightResized() {\r\n    this.heightResizedSubject.next();\r\n  }\r\n\r\n  addFiles(files: File[]) {\r\n    this.captureService.addBatchWithMultipleDocuments(files);\r\n  }\r\n\r\n  discardAllDocs() {\r\n    this.confirmationModal.close();\r\n    this.captureService.reset();\r\n  }\r\n\r\n  fillCurrentField(updateFieldData: UpdateFieldData) {\r\n    this.indexingService.fillCurrentField(updateFieldData);\r\n  }\r\n\r\n  fillGroupOfFields(updateGroupOfFields: UpdateGroupOfFields) {\r\n    this.indexingService.fillGroupOfFieldsValues(updateGroupOfFields);\r\n  }\r\n\r\n  scan(startscan: ScanPages) {\r\n    this.scanPages = startscan;\r\n    this.showDriverModal = true;\r\n    this.scanModal = this.ngxSmartModalService.getModal('ScanToICModal');\r\n    this.scanModal.open();\r\n    this.scanModal.onClose.subscribe(() => {\r\n      this.showDriverModal = false;\r\n    });\r\n  }\r\n\r\n  openConfirmationModal() {\r\n    this.confirmationModal = this.ngxSmartModalService.getModal('confirmationModal');\r\n    this.confirmationModal.open();\r\n  }\r\n\r\n  closeScanModal() {\r\n    this.scanModal?.close();\r\n  }\r\n\r\n  onToggleSpinner(state: boolean) {\r\n    if (state) {\r\n      this.translate\r\n        .get('Document_Capture.UpdatingDocument')\r\n        .subscribe((value) => this.spinnerState.show(value, this.contentWrapper.nativeElement));\r\n    } else {\r\n      this.spinnerState.hide();\r\n    }\r\n  }\r\n\r\n  reloadCurrentWorkitemMetadata = (): void => {\r\n    if (!this.selectedDocument?.workItemId) return;\r\n\r\n    this.hydraApi.getWorkItemMetaData(\r\n      this.selectedDocument.workItemId,\r\n      this.currentWorkitemMetadataLoaded,\r\n      this.currentWorkitemMetadataLoadFailed\r\n    );\r\n  };\r\n\r\n  currentWorkitemMetadataLoaded = (mdc: MetaDataCollection) => (this.selectedDocument.workitem.metadata = mdc);\r\n\r\n  currentWorkitemMetadataLoadFailed = (err: any) => {\r\n    Log.error('DocumentCaptureComponent.currentWorkitemMetadataLoadFailed', err);\r\n    this.toastr.error(this.translate.instant('Document_Capture.metadata-load-failed'));\r\n  };\r\n}\r\n","<section class=\"section document-capture h-100\">\r\n  <div class=\"container-fluid h-100 p-0\">\r\n    <div class=\"content-wrapper h-100 d-flex flex-column\" #contentWrapper>\r\n      <div class=\"section-header box-head--light-blue-bg\">\r\n        <app-toolbar class=\"d-block w-100\" (discardDocuments)=\"openConfirmationModal()\" (scan)=\"scan($event)\">\r\n        </app-toolbar>\r\n      </div>\r\n      <div class=\"section-content d-flex col p-0\" id=\"section-content\">\r\n        <div\r\n          class=\"panels-wrapper d-flex flex-column\"\r\n          appResizable\r\n          [preferenceName]=\"getPanelWrapperKey()\"\r\n          [preferenceValue]=\"getDocumentPanelWidthPreference()\"\r\n          [handles]=\"'e'\"\r\n          width=\"260\"\r\n          (widthResized)=\"widthResized()\"\r\n          (resize)=\"onResize($event)\"\r\n        >\r\n          <app-documents-list class=\"d-block col p-0\"></app-documents-list>\r\n          <app-indexing-panel\r\n            *ngIf=\"!isGridView\"\r\n            class=\"d-block\"\r\n            appResizable\r\n            [preferenceName]=\"indexingPanelKey\"\r\n            [preferenceValue]=\"getPreferenceValue(indexingPanelKey, '50')\"\r\n            [handles]=\"'n'\"\r\n            [height]=\"'50%'\"\r\n            (resize)=\"onResize($event)\"\r\n            [class.disabled]=\"!currentStepHasIndexing\"\r\n          >\r\n          </app-indexing-panel>\r\n        </div>\r\n        <div class=\"viewer-wrapper col d-flex flex-column p-0\">\r\n          <app-document-viewer\r\n            class=\"d-block col p-0\"\r\n            [onWidthResized]=\"widthResizedSubject.asObservable()\"\r\n            [onHeightResized]=\"heightResizedSubject.asObservable()\"\r\n            [selectedPage]=\"selectedPage\"\r\n            (addFiles)=\"addFiles($event)\"\r\n            (fillField)=\"fillCurrentField($event)\"\r\n            (fillGroupOfFields)=\"fillGroupOfFields($event)\"\r\n            (toggleSpinner)=\"onToggleSpinner($event)\"\r\n          >\r\n          </app-document-viewer>\r\n          <app-line-item-indexing\r\n            [class.disabled]=\"!showLineItemPanel\"\r\n            class=\"d-block\"\r\n            height=\"100\"\r\n            appResizable\r\n            [preferenceName]=\"lineItemsPanelKey\"\r\n            [preferenceValue]=\"getPreferenceValue(lineItemsPanelKey, '20')\"\r\n            [handles]=\"'n'\"\r\n            (resize)=\"onResize($event)\"\r\n            (heightResized)=\"heightResized()\"\r\n          >\r\n          </app-line-item-indexing>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  </div>\r\n</section>\r\n\r\n<ngx-smart-modal #confirmationModal identifier=\"confirmationModal\" customClass=\"confirm-modal\">\r\n  <app-modal-header [title]=\"'Scanning.DiscardScans' | translate\"></app-modal-header>\r\n\r\n  <div class=\"modal-body\">{{ 'Scanning.AreYouSure' | translate }}</div>\r\n\r\n  <div class=\"modal-footer\">\r\n    <button type=\"button\" class=\"btn btn-primary\" (click)=\"confirmationModal.close()\">\r\n      {{ 'Scanning.Cancel' | translate }}\r\n    </button>\r\n    <button type=\"button\" class=\"btn btn-light\" (click)=\"discardAllDocs()\">\r\n      {{ 'Scanning.Discard' | translate }}\r\n    </button>\r\n  </div>\r\n</ngx-smart-modal>\r\n\r\n<ngx-smart-modal\r\n  #ScanToICModal\r\n  [closable]=\"false\"\r\n  [escapable]=\"true\"\r\n  [dismissable]=\"false\"\r\n  [customClass]=\"'modal-lg'\"\r\n  identifier=\"ScanToICModal\"\r\n  class=\"scanto-modal\"\r\n>\r\n  <app-scan-to\r\n    [title]=\"'Scanning.ScanDocument'\"\r\n    [startscan]=\"scanPages\"\r\n    [modalId]=\"'ScanToICModal'\"\r\n    *ngIf=\"showDriverModal\"\r\n    (closeModal)=\"closeScanModal()\"\r\n    [executeAction]=\"false\"\r\n  ></app-scan-to>\r\n</ngx-smart-modal>\r\n","import { CommonModule } from '@angular/common';\r\nimport { NgModule } from '@angular/core';\r\nimport { FormsModule } from '@angular/forms';\r\n\r\nimport { DragDropModule } from '@angular/cdk/drag-drop';\r\nimport { TranslateModule } from '@ngx-translate/core';\r\nimport { PdfViewerModule } from 'ng2-pdf-viewer';\r\nimport { BsDropdownModule } from 'ngx-bootstrap/dropdown';\r\nimport { NgxFileDropModule } from 'ngx-file-drop';\r\nimport { PerfectScrollbarModule } from 'ngx-perfect-scrollbar-portable';\r\nimport { NgxSmartModalModule } from 'ngx-smart-modal';\r\n\r\nimport { ScrollingModule } from '@angular/cdk/scrolling';\r\nimport {\r\n  ActionDropdownModule,\r\n  AutoFocusFirstInputModule,\r\n  AutoUpdatePerfectScrollModule,\r\n  CheckboxModule,\r\n  ContextMenuModule,\r\n  FieldsModule,\r\n  IconsModule,\r\n  LabelModule,\r\n  ModalHeaderModule,\r\n  OpenDropdownModule,\r\n  PipesModule,\r\n  ResizableModule,\r\n} from 'shared-code-lib';\r\nimport { BoxModule } from '../../blocks/box/box.module';\r\nimport { ComponentsModule } from '../../blocks/components/components.module';\r\nimport { DocumentScannerAndEditorModule } from '../../blocks/components/document-scanner/document-scanner-and-editor.module';\r\nimport { SplitButtonComponent } from '../../blocks/components/split-button/split-button.component';\r\nimport { DirectivesModule } from '../../blocks/directives/directives.module';\r\nimport { ModalsModule } from '../../blocks/modals/modals.module';\r\nimport { PageModule } from '../../blocks/page/page.module';\r\nimport { DeliveryErrorComponent } from './delivery-error/delivery-error.component';\r\nimport { DocumentCaptureRoutingModule } from './document-capture-routing.module';\r\nimport { DocumentCaptureComponent } from './document-capture.component';\r\nimport { DocumentLockedComponent } from './document-locked/document-locked.component';\r\nimport { DocumentViewerComponent } from './document-viewer/document-viewer.component';\r\nimport { ThumbnailComponent } from './document-viewer/thumbnails/thumbnail/thumbnail.component';\r\nimport { ThumbnailsComponent } from './document-viewer/thumbnails/thumbnails.component';\r\nimport { DocumentComponent } from './documents-list/document/document.component';\r\nimport { DocumentsListComponent } from './documents-list/documents-list.component';\r\nimport { FolderComponent } from './documents-list/folder/folder.component';\r\nimport { WorkItemComponent } from './documents-list/work-item/work-item.component';\r\nimport { IndexingPanelComponent } from './indexing-panel/indexing-panel.component';\r\nimport { LineItemIndexingComponent } from './line-item-indexing/line-item-indexing.component';\r\nimport { ToolbarComponent } from './toolbar/toolbar.component';\r\n\r\n@NgModule({\r\n  imports: [\r\n    LabelModule,\r\n    CommonModule,\r\n    FormsModule,\r\n    TranslateModule,\r\n    PerfectScrollbarModule,\r\n    BsDropdownModule.forRoot(),\r\n    NgxSmartModalModule,\r\n    PdfViewerModule,\r\n    NgxFileDropModule,\r\n    DragDropModule,\r\n    PerfectScrollbarModule,\r\n    IconsModule,\r\n    PageModule,\r\n    BoxModule,\r\n    DocumentCaptureRoutingModule,\r\n    FieldsModule,\r\n    OpenDropdownModule,\r\n    DirectivesModule,\r\n    CheckboxModule,\r\n    ModalHeaderModule,\r\n    ComponentsModule,\r\n    ResizableModule,\r\n    ModalsModule,\r\n    DocumentScannerAndEditorModule,\r\n    PipesModule,\r\n    AutoUpdatePerfectScrollModule,\r\n    ContextMenuModule,\r\n    ActionDropdownModule,\r\n    AutoFocusFirstInputModule,\r\n    ScrollingModule,\r\n  ],\r\n  declarations: [\r\n    DocumentCaptureComponent,\r\n    ToolbarComponent,\r\n    DocumentsListComponent,\r\n    WorkItemComponent,\r\n    FolderComponent,\r\n    DocumentComponent,\r\n    LineItemIndexingComponent,\r\n    DocumentViewerComponent,\r\n    ThumbnailsComponent,\r\n    ThumbnailComponent,\r\n    IndexingPanelComponent,\r\n    SplitButtonComponent,\r\n    DeliveryErrorComponent,\r\n    DocumentLockedComponent,\r\n  ],\r\n})\r\nexport class DocumentCaptureModule {}\r\n","import { Component, OnInit, ViewEncapsulation } from '@angular/core';\r\nimport { TranslateService } from '@ngx-translate/core';\r\nimport { Subscription } from 'rxjs';\r\nimport { LockStatus } from '../../../blocks/models/lock-status';\r\nimport { UserStateService } from '../../../blocks/services/user-state.service';\r\nimport { CapturedDocument } from '../capture-models';\r\nimport { CaptureUpdateService } from '../capture-services/capture-update.service';\r\nimport { DocumentLockingService } from '../capture-services/document-locking.service';\r\nimport { SelectedItemsService } from '../capture-services/selected-items.service';\r\n\r\n@Component({\r\n  selector: 'app-document-locked',\r\n  templateUrl: './document-locked.component.html',\r\n  styleUrls: ['./document-locked.component.scss'],\r\n  encapsulation: ViewEncapsulation.None,\r\n})\r\nexport class DocumentLockedComponent implements OnInit {\r\n  constructor(\r\n    private documentLockingService: DocumentLockingService,\r\n    private captureUpdateService: CaptureUpdateService,\r\n    private userStateService: UserStateService,\r\n    private translateService: TranslateService,\r\n    private selectedItemsService: SelectedItemsService\r\n  ) {}\r\n\r\n  subscriptions = new Subscription();\r\n\r\n  selectedDocument: CapturedDocument;\r\n  lockStatus: LockStatus;\r\n  lockedByUser: boolean;\r\n  lockStatusText = '';\r\n  oneItemSelected: boolean;\r\n\r\n  ngOnInit() {\r\n    this.subscriptions.add(this.captureUpdateService.onChangeDocument.subscribe(this.selectedDocumentChanged));\r\n    this.subscriptions.add(this.documentLockingService.lockStatusChanged.subscribe(this.lockStatusChanged));\r\n\r\n    this.onChangedSelectedItems();\r\n    this.subscriptions.add(this.selectedItemsService.onChangeSelectedItems.subscribe(this.onChangedSelectedItems));\r\n  }\r\n\r\n  onChangedSelectedItems = () => {\r\n    this.oneItemSelected = this.selectedItemsService.isOneItemSelected();\r\n  };\r\n\r\n  lockStatusChanged = (ls: LockStatus): void => {\r\n    if (!this.selectedDocument || !this.selectedDocument.workitem) return;\r\n\r\n    if (ls.id == this.selectedDocument.workitem.id) {\r\n      this.lockStatus = ls;\r\n      this.lockedByUser = ls.locked && ls.lockedByUserId == this.userStateService.user.id;\r\n\r\n      if (!this.lockedByUser) {\r\n        this.lockStatusText = `${this.translateService.instant('lock-status.locked-by-user')}: ${\r\n          this.lockStatus.lockedByUserName\r\n        } <${this.lockStatus.lockedByUserEmail}>`;\r\n      } else {\r\n        this.lockStatusText = this.translateService.instant('lock-status.locked-by-you');\r\n      }\r\n    }\r\n  };\r\n\r\n  selectedDocumentChanged = (doc: CapturedDocument): void => {\r\n    this.lockedByUser = false;\r\n    this.lockStatus = null;\r\n    this.lockStatusText = '';\r\n    this.selectedDocument = doc;\r\n  };\r\n}\r\n","<div class=\"document-locked\" [title]=\"lockStatusText\" *ngIf=\"oneItemSelected\">\r\n  <i *ngIf=\"lockStatus && lockedByUser\" class=\"fa fa-lock locked-by-user\"></i>\r\n  <i *ngIf=\"lockStatus && !lockedByUser\" class=\"fa fa-lock notlocked-by-user\"></i>\r\n</div>\r\n","import {\r\n  AfterViewChecked,\r\n  ChangeDetectorRef,\r\n  Component,\r\n  ElementRef,\r\n  EventEmitter,\r\n  HostListener,\r\n  Input,\r\n  OnDestroy,\r\n  OnInit,\r\n  Output,\r\n  ViewChild,\r\n  ViewEncapsulation,\r\n} from '@angular/core';\r\n\r\nimport { PdfViewerComponent } from 'ng2-pdf-viewer';\r\nimport { FileSystemDirectoryEntry, FileSystemFileEntry, NgxFileDropEntry } from 'ngx-file-drop';\r\nimport { PerfectScrollbarDirective } from 'ngx-perfect-scrollbar-portable';\r\nimport { Observable, Subscription } from 'rxjs';\r\n\r\nimport { TranslateService } from '@ngx-translate/core';\r\nimport {\r\n  Annotation,\r\n  DelayService,\r\n  ILocation,\r\n  Location,\r\n  MetaDataCollection,\r\n  MetaDataLineItems,\r\n  MetaDataValidity,\r\n  MetaDataValueType,\r\n  UserPreferencesService,\r\n} from 'shared-code-lib';\r\nimport { Action, ActionEvent } from '../../../blocks/core/actions';\r\nimport { Filename } from '../../../blocks/core/fileName';\r\nimport { FolderItem } from '../../../blocks/models/folder-item';\r\nimport { LockStatus } from '../../../blocks/models/lock-status';\r\nimport { UpdateFieldData, UpdateGroupOfFields } from '../../../blocks/models/update-field-data';\r\nimport { WorkItem } from '../../../blocks/models/work-item';\r\nimport { InteractiveWorkflowStep, WorkflowStep } from '../../../blocks/models/workflow-step';\r\nimport { ActionService } from '../../../blocks/services/action.service';\r\nimport { ErrorsService } from '../../../blocks/services/errors.service';\r\nimport { UserStateService } from '../../../blocks/services/user-state.service';\r\nimport { DocumentCaptureService, DocumentViewerService } from '../../../views/document-capture/capture-services';\r\nimport { AnnotationsComponent } from '../../product-item/document-preview/annotations/annotations.component';\r\nimport {\r\n  Batch,\r\n  Capabilities,\r\n  CapturedDocument,\r\n  IndexingPanels,\r\n  MetadataValidityColors,\r\n  Page,\r\n  Preference,\r\n  PreviousViewerSettings,\r\n  ValueLocation,\r\n} from '../capture-models';\r\nimport { CaptureUpdateService } from '../capture-services/capture-update.service';\r\nimport { DocumentLockingService } from '../capture-services/document-locking.service';\r\nimport { FolderViewEventsService } from '../capture-services/folder-view-events.service';\r\nimport { IndexingPanelService } from '../capture-services/indexing-panel.service';\r\nimport { SelectedItemsService } from '../capture-services/selected-items.service';\r\nimport { ThumbnailsComponent } from './thumbnails/thumbnails.component';\r\n\r\nexport const VIEWER_CONFIG = {\r\n  maxScale: 5,\r\n  minScale: 0.1,\r\n  scaleIncrement: 0.1,\r\n};\r\n\r\ndeclare const $: any;\r\n@Component({\r\n  selector: 'app-document-viewer',\r\n  templateUrl: './document-viewer.component.html',\r\n  styleUrls: ['./document-viewer.component.scss'],\r\n  encapsulation: ViewEncapsulation.None,\r\n})\r\nexport class DocumentViewerComponent implements OnInit, AfterViewChecked, OnDestroy {\r\n  @ViewChild('wrapper', { static: true }) wrapper: ElementRef;\r\n  @ViewChild('viewer') viewer: PdfViewerComponent;\r\n  @ViewChild('thumbnails', { static: true }) thumbnails: ThumbnailsComponent;\r\n  @ViewChild('ps1') directiveRef?: PerfectScrollbarDirective;\r\n  @ViewChild(AnnotationsComponent, { static: false }) annotations: AnnotationsComponent;\r\n\r\n  @Input() set selectedBatch(batch: Batch) {\r\n    this.batch = batch;\r\n    this.viewerService.changeSelectedBatch(batch);\r\n  }\r\n  @Input() set selectedDocument(doc: CapturedDocument) {\r\n    this.doc = doc;\r\n    this.viewerService.changeSelectedDocument(doc);\r\n  }\r\n  @Input() set selectedPage(page: Page) {\r\n    this.page = page;\r\n    this.viewerService.onChangeSelectedPage(page);\r\n  }\r\n  @Input() onWidthResized: Observable<void>;\r\n  @Input() onHeightResized: Observable<void>;\r\n  @Output() addFiles = new EventEmitter<Array<File>>();\r\n  @Output() selectPage = new EventEmitter<number>();\r\n  @Output() deletePage = new EventEmitter<number>();\r\n  @Output() fillField = new EventEmitter<UpdateFieldData>();\r\n  @Output() fillGroupOfFields = new EventEmitter<UpdateGroupOfFields>();\r\n  @Output() toggleSpinner = new EventEmitter<boolean>();\r\n\r\n  batch: Batch;\r\n  doc: CapturedDocument;\r\n  page: Page;\r\n  pageHeight: number;\r\n  fitToHeightPortraitScale: number;\r\n  fitToHeightLandscapeScale: number;\r\n  fitToWidthPortrait: boolean;\r\n  fitToWidthLandscape: boolean;\r\n  isPortrait: boolean;\r\n  isLandscape: boolean;\r\n  shouldFitToHeight: boolean;\r\n  scale: number;\r\n  files: Array<File> = [];\r\n  enablePointNClickIndexing: boolean = false;\r\n  highlightsCreated: boolean = false;\r\n\r\n  rubberBandingInProgress: boolean = false;\r\n  thumbnailsViewerKey = 'thumbnailsViewerKey';\r\n  currentFocusedPanel: IndexingPanels;\r\n\r\n  documentLocked: boolean;\r\n  oneDocumentSelected: boolean;\r\n  oneFolderSelected: boolean;\r\n  multipleItemsSelected: boolean;\r\n  selectedItemsCountText: string;\r\n\r\n  documentWorkItemAnnotations: Annotation[] = [];\r\n\r\n  private valuesLocation: Array<ValueLocation>;\r\n  private zoomedInValueId: string;\r\n  private subscriptions: Subscription;\r\n  private onWidthResizedSubscription: any;\r\n  private onHeightResizedSubscription: any;\r\n  private prevSettings: PreviousViewerSettings;\r\n  private minimumAnimationDuration = 2;\r\n\r\n  Action = Action;\r\n\r\n  @HostListener('window:resize') onResize() {\r\n    if (!this.fitToWidthPortrait && !this.fitToWidthLandscape && this.viewer) {\r\n      this.pageHeight = 0;\r\n      this.scale = 1;\r\n      this.shouldFitToHeight = true;\r\n    }\r\n  }\r\n\r\n  constructor(\r\n    private viewerService: DocumentViewerService,\r\n    private indexingService: IndexingPanelService,\r\n    public capture: DocumentCaptureService,\r\n    private captureUpdate: CaptureUpdateService,\r\n    private userStateService: UserStateService,\r\n    private translate: TranslateService,\r\n    private delay: DelayService,\r\n    private actionService: ActionService,\r\n    private documentLockingService: DocumentLockingService,\r\n    private selectedItemsService: SelectedItemsService,\r\n    private userPreferencesService: UserPreferencesService,\r\n    private folderViewEventsService: FolderViewEventsService,\r\n    private errorsService: ErrorsService,\r\n    private cdr: ChangeDetectorRef\r\n  ) {\r\n    this.init();\r\n    this.page = this.capture.currentPage;\r\n  }\r\n\r\n  ngOnInit() {\r\n    this.subscriptions.add(\r\n      this.captureUpdate.onChangeDocument.subscribe((doc) => {\r\n        this.delay.execute(() => {\r\n          this.valuesLocation = [];\r\n          this.clearHoveredOver();\r\n          this.scale = 1;\r\n          if (this.directiveRef) {\r\n            this.directiveRef.update();\r\n          }\r\n\r\n          this.doc = doc;\r\n          this.documentWorkItemAnnotations =\r\n            doc && doc.workitem ? doc.workitem.annotations.map((x) => Annotation.create(x)) : [];\r\n          this.documentLocked = doc ? this.documentLockingService.isLockedByCurrentUser(this.doc.workitem.id) : false;\r\n          this.highlightsCreated = false;\r\n        }, 10);\r\n      })\r\n    );\r\n\r\n    this.subscriptions.add(this.documentLockingService.lockStatusChanged.subscribe(this.lockStatusChanged));\r\n\r\n    this.subscriptions.add(\r\n      this.captureUpdate.onChangeDocumentPage.subscribe((page) => {\r\n        const el = document.querySelector('#viewerWrapper');\r\n        if (el) {\r\n          el.scrollTop = 0;\r\n        }\r\n\r\n        this.hideTooltip();\r\n\r\n        this.page = page;\r\n        if (this.prevSettings) {\r\n          this.resetViewerSettings();\r\n        }\r\n      })\r\n    );\r\n\r\n    this.subscriptions.add(this.viewerService.onDeletePage.subscribe((index) => this.deletePage.emit(index)));\r\n\r\n    this.subscriptions.add(\r\n      this.viewerService.onSelectPage.subscribe((index) => {\r\n        this.valuesLocation = [];\r\n        this.selectPage.emit(index);\r\n      })\r\n    );\r\n\r\n    this.subscriptions.add(\r\n      this.indexingService.onChangeWorkflowStep.subscribe(\r\n        (metaDataArr) => (this.enablePointNClickIndexing = metaDataArr.length > 0)\r\n      )\r\n    );\r\n    this.onWidthResizedSubscription = this.onWidthResized.subscribe(() => {\r\n      if (this.fitToWidthPortrait && this.viewer) {\r\n        this.updateSize();\r\n      }\r\n    });\r\n\r\n    this.onHeightResizedSubscription = this.onHeightResized.subscribe(() => {\r\n      if (!this.fitToWidthPortrait && !this.fitToWidthLandscape && this.viewer) {\r\n        this.setScalesForFitToHeight(true);\r\n      }\r\n    });\r\n\r\n    this.subscriptions.add(\r\n      this.indexingService.onChangeCurrentField.subscribe((fieldName) => {\r\n        $('.indexing-popover-header').text(fieldName);\r\n        const mdd = this.userStateService.findMetaDataByName(fieldName);\r\n        if (mdd) {\r\n          $('.indexing-popover-header').text(mdd.label);\r\n        }\r\n      })\r\n    );\r\n\r\n    this.subscriptions.add(\r\n      this.captureUpdate.onFocusOnIndexValueValidLocation.subscribe((fieldId: string) => {\r\n        if (this.viewer) {\r\n          this.zoomIntoValue(fieldId);\r\n        } else {\r\n          this.zoomedInValueId = fieldId;\r\n        }\r\n      })\r\n    );\r\n\r\n    this.subscriptions.add(\r\n      this.captureUpdate.onGetValuesValidLocation.subscribe((valuesLocation) => {\r\n        this.delay.execute(() => {\r\n          if (this.valuesLocation && this.valuesLocation.length) {\r\n            var existingLocations = this.valuesLocation;\r\n            var newLocations = valuesLocation.filter((value) => {\r\n              return (\r\n                existingLocations.findIndex((l) => {\r\n                  return l.fieldId === value.fieldId;\r\n                }) < 0\r\n              );\r\n            });\r\n\r\n            this.valuesLocation = [...this.valuesLocation, ...newLocations];\r\n          } else {\r\n            this.valuesLocation = valuesLocation;\r\n          }\r\n        }, 20);\r\n      })\r\n    );\r\n\r\n    this.subscriptions.add(\r\n      this.captureUpdate.onChangeValueValidLocation.subscribe((object) => {\r\n        const highlight = $(`div#${this.getHighlightId(object.id)}`);\r\n\r\n        for (const key in MetaDataValidity) {\r\n          if (highlight.hasClass(key)) {\r\n            highlight.removeClass(key);\r\n          }\r\n        }\r\n\r\n        highlight.addClass([MetaDataValidity[object.validity]]);\r\n        highlight.css('background-color', MetadataValidityColors[MetaDataValidity[object.validity]]);\r\n      })\r\n    );\r\n\r\n    this.subscriptions.add(\r\n      this.captureUpdate.onChangeValueInValidLocation.subscribe((object) => {\r\n        this.deleteHighlight(object.id);\r\n      })\r\n    );\r\n\r\n    this.subscriptions.add(\r\n      this.folderViewEventsService.onUpdateItem.subscribe((folderItem: FolderItem) => {\r\n        if (!this.isFolderItemSelected(folderItem) || !this.highlightsCreated) return;\r\n\r\n        for (let i = this.valuesLocation.length - 1; i >= 0; i--) {\r\n          const valueLocation = this.valuesLocation[i];\r\n          const fieldId = this.parseFieldId(valueLocation.fieldId);\r\n          const mdd = this.userStateService.findMetaDataById(fieldId);\r\n          if (!mdd) {\r\n            this.deleteHighlight(fieldId);\r\n          }\r\n          if (!this.matchingFieldExists(mdd.name, folderItem.workItem.metadata, valueLocation)) {\r\n            this.deleteHighlight(valueLocation.fieldId);\r\n          }\r\n        }\r\n      })\r\n    );\r\n\r\n    this.subscriptions.add(this.actionService.onActivateAction.subscribe(this.invokeAction));\r\n\r\n    this.subscriptions.add(\r\n      this.indexingService.onTakeFocus.subscribe((panel: number) => {\r\n        this.currentFocusedPanel = panel;\r\n      })\r\n    );\r\n\r\n    this.onChangedSelectedItems();\r\n    this.subscriptions.add(this.selectedItemsService.onChangeSelectedItems.subscribe(this.onChangedSelectedItems));\r\n\r\n    document.addEventListener('mouseup', () => (this.rubberBandingInProgress = false));\r\n  }\r\n\r\n  ngAfterViewChecked(): void {\r\n    this.cdr.detectChanges();\r\n  }\r\n\r\n  onChangedSelectedItems = () => {\r\n    this.oneDocumentSelected = this.selectedItemsService.isOneDocumentSelected();\r\n    this.oneFolderSelected = this.selectedItemsService.isOneFolderSelected();\r\n    this.multipleItemsSelected = this.selectedItemsService.areMultipleItemsSelected();\r\n    this.selectedItemsCountText = this.selectedItemsService.getSelectedItemsCountText();\r\n  };\r\n\r\n  lockStatusChanged = (ls: LockStatus): void => {\r\n    if (!this.doc || !this.doc.workitem) return;\r\n\r\n    if (ls.id == this.doc.workitem.id) {\r\n      this.documentLocked = ls.locked && ls.lockedByUserId == this.userStateService.user.id && !ls.expired();\r\n    }\r\n  };\r\n\r\n  deleteHighlight = (id: string): void => {\r\n    const valueIndex = this.valuesLocation.findIndex((value) => value.fieldId === id);\r\n    if (valueIndex < 0) return;\r\n    this.valuesLocation.splice(valueIndex, 1);\r\n    const highlight = $(`div#${this.getHighlightId(id)}`);\r\n    if (highlight && highlight.length > 0) highlight[0].parentElement.removeChild(highlight[0]);\r\n  };\r\n\r\n  invokeAction = (event: ActionEvent): void => {\r\n    if (!this.capture.currentPage) return;\r\n\r\n    if (event.action == Action.FitToHeight) {\r\n      this.fit('height');\r\n    } else if (event.action == Action.FitToWidth) {\r\n      this.fit('width');\r\n    } else if (event.action == Action.ZoomIn) {\r\n      this.zoomIn();\r\n    } else if (event.action == Action.ZoomOut) {\r\n      this.zoomOut();\r\n    } else if (event.action == Action.RotateLeft) {\r\n      this.rotate('left');\r\n    } else if (event.action == Action.RotateRight) {\r\n      this.rotate('right');\r\n    }\r\n  };\r\n\r\n  ngOnDestroy() {\r\n    this.clearHoveredOver();\r\n\r\n    this.selectPage.unsubscribe();\r\n    this.deletePage.unsubscribe();\r\n    this.subscriptions.unsubscribe();\r\n    this.onWidthResizedSubscription.unsubscribe();\r\n    this.onHeightResizedSubscription.unsubscribe();\r\n  }\r\n\r\n  clearHoveredOver = (): void => {\r\n    $('.indexing-popover-body').text('');\r\n    $('.indexing-popover').hide();\r\n\r\n    $('.indexing-text').each(function () {\r\n      $(this).removeClass('hovered-over');\r\n    });\r\n  };\r\n\r\n  getPageCountText = (): string => {\r\n    if (!this.doc) return '';\r\n    return Filename.getPageCountText(this.doc.pageCount, this.translate);\r\n  };\r\n\r\n  private init() {\r\n    this.fitToWidthPortrait = true;\r\n    this.fitToWidthLandscape = false;\r\n    this.isPortrait = true;\r\n\r\n    this.isLandscape = false;\r\n    this.scale = 1;\r\n    this.subscriptions = new Subscription();\r\n  }\r\n\r\n  canDropDocuments = (): boolean => {\r\n    if (!this.oneFolderSelected) return false;\r\n\r\n    const selectedFolder = this.capture.getSelectedFolder();\r\n    if (!selectedFolder) return false;\r\n\r\n    const ws = this.capture.getWorkflowStepById(selectedFolder.workflowStepId);\r\n    if (ws == null) return false;\r\n\r\n    return this.isPrimaryStep(ws) && ws.hasCapability(Capabilities.allowDropExternalDocument);\r\n  };\r\n\r\n  isPrimaryStep(ws: WorkflowStep) {\r\n    const primaryInteractiveStep = this.capture.currentWorkflow.workflowSteps.find(\r\n      (step) => step instanceof InteractiveWorkflowStep\r\n    );\r\n\r\n    return ws.id === primaryInteractiveStep.id;\r\n  }\r\n\r\n  public dropped(files: NgxFileDropEntry[]) {\r\n    if (!this.canDropDocuments()) return;\r\n\r\n    files = files.sort((a, b) => a.fileEntry.name.localeCompare(b.fileEntry.name, undefined, { numeric: true }));\r\n    for (const droppedFile of files) {\r\n      // Is it a file?\r\n      if (droppedFile.fileEntry.isFile) {\r\n        const fileEntry = droppedFile.fileEntry as FileSystemFileEntry;\r\n        fileEntry.file((file: File) => {\r\n          this.files.push(file);\r\n          if (this.files.length === files.length) {\r\n            this.addFiles.emit(this.files);\r\n            this.files = [];\r\n          }\r\n        });\r\n      } else {\r\n        // It was a directory (empty directories are added, otherwise only files)\r\n        const fileEntry = droppedFile.fileEntry as FileSystemDirectoryEntry;\r\n      }\r\n    }\r\n  }\r\n\r\n  zoomIn() {\r\n    if (this.scale >= VIEWER_CONFIG.maxScale) {\r\n      return;\r\n    }\r\n\r\n    this.scale = Math.round((this.scale + VIEWER_CONFIG.scaleIncrement) * 100) / 100;\r\n  }\r\n\r\n  zoomOut() {\r\n    if (this.scale <= VIEWER_CONFIG.minScale) {\r\n      return;\r\n    }\r\n\r\n    this.scale = Math.round((this.scale - VIEWER_CONFIG.scaleIncrement) * 100) / 100;\r\n  }\r\n\r\n  rotate(dir: 'right' | 'left'): void {\r\n    if (!this.documentLocked) return;\r\n\r\n    const rotation = dir === 'right' ? 90 : -90;\r\n\r\n    this.onToggleSpinner(true);\r\n    this.capture\r\n      .rotateCurrentPage(rotation)\r\n      .then((workItem: WorkItem) => {\r\n        this.onToggleSpinner(false);\r\n        this.rotateAnnotations(workItem);\r\n      })\r\n      .catch(() => {\r\n        this.onToggleSpinner(false);\r\n      });\r\n  }\r\n\r\n  fit(to: string): void {\r\n    if (to === 'width') {\r\n      this.updateSize();\r\n      this.scale = 1;\r\n      if (this.isPortrait) {\r\n        this.fitToWidthPortrait = true;\r\n        this.fitToWidthLandscape = false;\r\n      } else {\r\n        this.fitToWidthPortrait = false;\r\n        this.fitToWidthLandscape = true;\r\n      }\r\n    } else if (to === 'height') {\r\n      this.fitToWidthPortrait = false;\r\n      this.fitToWidthLandscape = false;\r\n      if (this.isPortrait) {\r\n        this.scale = this.fitToHeightPortraitScale;\r\n      } else {\r\n        this.scale = this.fitToHeightLandscapeScale;\r\n      }\r\n    }\r\n\r\n    this.directiveRef.update();\r\n  }\r\n\r\n  rotateAnnotations = (workItem: WorkItem): void => {\r\n    this.documentWorkItemAnnotations = workItem.annotations;\r\n    this.capture.updatePageAnnotations(this.page.order, this.documentWorkItemAnnotations);\r\n  };\r\n\r\n  onPageRendered = (event: any): void => {\r\n    if (event.source.pdfPage.view[2] > event.source.pdfPage.view[3]) {\r\n      this.isPortrait = false;\r\n      this.isLandscape = true;\r\n    } else {\r\n      this.isPortrait = true;\r\n      this.isLandscape = false;\r\n    }\r\n\r\n    this.getPageHeight(event);\r\n\r\n    if (!this.annotationsAllowed()) return;\r\n    if (this.annotations) this.annotations.onPageRendered(event);\r\n    if (this.thumbnails) this.thumbnails.onAnnotationsLoaded();\r\n  };\r\n\r\n  getPageHeight(event: any, resetHeight?: boolean): void {\r\n    if (!this.pageHeight) {\r\n      this.pageHeight = event.source.div.offsetHeight;\r\n    }\r\n\r\n    this.setScalesForFitToHeight(this.shouldFitToHeight);\r\n  }\r\n\r\n  setScalesForFitToHeight(andFitToHeight: boolean) {\r\n    const viewerWrapper = document.querySelector('app-document-viewer') as HTMLElement;\r\n    let percentage: number;\r\n    percentage = ((viewerWrapper.offsetHeight - 40) / this.pageHeight) * 100;\r\n    this.fitToHeightPortraitScale = parseFloat((percentage * 0.01).toFixed(2));\r\n    percentage = ((viewerWrapper.offsetHeight - 45) / this.pageHeight) * 100;\r\n    this.fitToHeightLandscapeScale = parseFloat((percentage * 0.01).toFixed(2));\r\n    if (andFitToHeight) {\r\n      this.fit('height');\r\n      this.shouldFitToHeight = false;\r\n    }\r\n  }\r\n\r\n  widthResized() {\r\n    if (this.fitToWidthPortrait && this.viewer) {\r\n      this.updateSize();\r\n    }\r\n    this.thumbnails.widthResized();\r\n  }\r\n\r\n  onWidthResize(preference: Preference) {\r\n    this.userPreferencesService.setPreference(preference.name, preference.value);\r\n  }\r\n\r\n  getPreferenceValue(key: string, defaultValue: string): string {\r\n    return this.userPreferencesService.getPreference(key) || defaultValue;\r\n  }\r\n\r\n  highlightValue(value: ValueLocation, index: number) {\r\n    const { fieldId, location, validity } = value;\r\n    const pageIndex = this.viewer.pdfViewer.currentPageNumber;\r\n    const page = this.viewer.pdfViewer._pages[pageIndex - 1];\r\n    const viewPort = page.viewport;\r\n    const boundLeft = viewPort.convertToViewportRectangle([location.left, location.top + 1]);\r\n    const boundRight = viewPort.convertToViewportRectangle([location.right + 1, location.bottom]);\r\n    const highlight = `\r\n      <div\r\n        style=\"\r\n        position: absolute;\r\n        background-color: ${MetadataValidityColors[MetaDataValidity[validity]]};\r\n        left: ${boundLeft[0]}px;\r\n        top: ${boundLeft[1]}px;\r\n        width: ${boundRight[0] - boundLeft[0]}px;\r\n        height: ${boundRight[1] - boundLeft[1]}px;\"\r\n        id=\"${this.getHighlightId(fieldId)}\"\r\n        class=\"highlighted ${MetaDataValidity[validity]}\">\r\n        <div class=\"highlight-border\"></div>\r\n      </div>\r\n    `;\r\n\r\n    $(page.canvas.parentElement).append(highlight);\r\n\r\n    if (this.zoomedInValueId === fieldId) {\r\n      this.zoomIntoValue(fieldId);\r\n    }\r\n  }\r\n\r\n  zoomIntoValue(id: string) {\r\n    const zoomScale = 1.5;\r\n\r\n    $('div.highlighted').each(function () {\r\n      $(this).removeClass('current');\r\n    });\r\n\r\n    if (id) {\r\n      if (this.scale !== zoomScale) {\r\n        if (!this.prevSettings) {\r\n          this.prevSettings = {} as PreviousViewerSettings;\r\n        }\r\n\r\n        const { scale } = this;\r\n        const { x, y } = this.directiveRef.position(true);\r\n        this.prevSettings = { scale, x: x as number, y: y as number };\r\n\r\n        this.scale = zoomScale;\r\n        this.directiveRef.update();\r\n        this.zoomedInValueId = id;\r\n      } else {\r\n        const container = $('#viewerWrapper');\r\n        const highlight = $(`div#${this.getHighlightId(id)}`);\r\n        const durationScale = highlight.width() / (200 * zoomScale);\r\n        const duration = 35 * durationScale || this.minimumAnimationDuration;\r\n\r\n        highlight.addClass('current');\r\n        highlight.children('.highlight-border').css('animation-duration', `${duration}s`);\r\n        if (highlight.position()) {\r\n          this.directiveRef.scrollTo(\r\n            highlight.position().left - (container.width() - highlight.width()) / 2,\r\n            highlight.position().top - (container.height() - highlight.height()) / 2,\r\n            150\r\n          );\r\n          this.zoomedInValueId = null;\r\n        }\r\n      }\r\n    } else {\r\n      if (this.prevSettings) {\r\n        this.resetViewerSettings();\r\n      }\r\n    }\r\n  }\r\n\r\n  private resetViewerSettings(): void {\r\n    this.scale = this.prevSettings.scale;\r\n\r\n    if (this.directiveRef) {\r\n      this.directiveRef.scrollTo(this.prevSettings.x, this.prevSettings.y, 0);\r\n    }\r\n\r\n    this.prevSettings = null;\r\n  }\r\n\r\n  setupPointerIndexing(event: any): void {\r\n    if (this.valuesLocation && this.valuesLocation.length) {\r\n      this.valuesLocation.forEach((value, index) => {\r\n        if (value.location.page === this.page.order) {\r\n          this.highlightValue(value, index);\r\n        }\r\n      });\r\n    }\r\n\r\n    this.highlightsCreated = true;\r\n\r\n    if (!this.enablePointNClickIndexing) {\r\n      return;\r\n    }\r\n\r\n    const that = this;\r\n    const body = $('body');\r\n    const textLayer = $('.textLayer');\r\n    $('.indexing-text').unbind('hover');\r\n    $('.indexing-text').unbind('click');\r\n    textLayer.unbind('mousedown');\r\n\r\n    let popover = $('.indexing-popover');\r\n    if (!popover.length) {\r\n      popover = `\r\n          <div class=\"indexing-popover\">\r\n            <div class=\"indexing-popover-header\"></div>\r\n            <div class=\"indexing-popover-body\"></div>\r\n            <div class=\"arrow-wrapper\">\r\n              <div class=\"arrow\"></div>\r\n            </div>\r\n          </div>\r\n        `;\r\n      body.append(popover);\r\n    }\r\n\r\n    $(event.source.textLayer.textDivs).each(function () {\r\n      if ($(this).hasClass('annotation')) return;\r\n\r\n      if ($(this).attr('style')) {\r\n        that.handleTextElement(this);\r\n        return;\r\n      }\r\n\r\n      if (!$(this).children.length) return;\r\n\r\n      $(this)\r\n        .children()\r\n        .each(function () {\r\n          if (!$(this).attr('style')) return;\r\n          that.handleTextElement(this);\r\n        });\r\n    });\r\n\r\n    $('.indexing-text').hover(\r\n      function () {\r\n        if (!that.documentLocked) return;\r\n\r\n        if (that.rubberBandingInProgress) {\r\n          return;\r\n        }\r\n\r\n        $('.indexing-popover').show();\r\n        $('.indexing-popover-body').text($(this).addClass('hovered-over').text());\r\n\r\n        const textOffset = $(this).offset();\r\n        const textWidth = $('.indexing-popover-body').width();\r\n\r\n        const viewerOffset = $('#viewerWrapper').offset();\r\n        const viewerWidth = $('#viewerWrapper').width();\r\n\r\n        const bufferMargin = 10;\r\n        let popoverPosition = { top: textOffset.top - 75, left: textOffset.left - bufferMargin };\r\n\r\n        if (popoverPosition.left + textWidth > viewerOffset.left + viewerWidth - 2 * bufferMargin) {\r\n          popoverPosition.left -=\r\n            popoverPosition.left + textWidth - (viewerOffset.left + viewerWidth - 2 * bufferMargin);\r\n        }\r\n\r\n        if (popoverPosition.left < viewerOffset.left + 0.5 * bufferMargin) {\r\n          popoverPosition.left += viewerOffset.left + 0.5 * bufferMargin - popoverPosition.left;\r\n        }\r\n\r\n        if (popoverPosition.top < 3 * bufferMargin) {\r\n          popoverPosition.top = 3 * bufferMargin;\r\n        }\r\n\r\n        $('.indexing-popover').css({\r\n          left: popoverPosition.left + 'px',\r\n          top: popoverPosition.top + 'px',\r\n        });\r\n      },\r\n      function () {\r\n        that.hideTooltip();\r\n        $(this).removeClass('hovered-over');\r\n      }\r\n    );\r\n\r\n    $('.indexing-text').click(function () {\r\n      if (that.documentLocked) {\r\n        const offset = $(this).offset();\r\n        const location = that.getSelectionLocation(offset.left, offset.top, this.offsetWidth, this.offsetHeight, true);\r\n        that.fillField.emit(new UpdateFieldData(that.capture.getCurrentWorkItem(), $(this).text(), location));\r\n      }\r\n    });\r\n\r\n    textLayer.mousedown(function (e) {\r\n      if (!that.documentLocked) return;\r\n\r\n      if ($(e.target).hasClass('indexing-text')) return;\r\n\r\n      if (\r\n        ($(this).hasClass('annotating') && $(this).hasClass('drawing')) ||\r\n        $(e.target).hasClass('annotation') ||\r\n        $(e.target).parent().hasClass('annotation')\r\n      )\r\n        return;\r\n\r\n      that.rubberBandingInProgress = true;\r\n\r\n      body.append(`<span class=\"rubber-banding\"></span>`);\r\n      const onClickX = e.pageX;\r\n      const onClickY = e.pageY;\r\n      let onMoveX;\r\n      let onMoveY;\r\n      let positionX;\r\n      let positionY;\r\n      let wrappedTextElements;\r\n      let textElementsWrappers;\r\n\r\n      const rubberBanding = $('.rubber-banding');\r\n\r\n      function positionRubberBanding(el) {\r\n        el.css({\r\n          left: positionX + 'px',\r\n          top: positionY + 'px',\r\n          width: onClickX > onMoveX ? onClickX - onMoveX : onMoveX - onClickX + 'px',\r\n          height: onClickY > onMoveY ? onClickY - onMoveY : onMoveY - onClickY + 'px',\r\n        });\r\n      }\r\n\r\n      function reset() {\r\n        body.unbind('mousemove');\r\n        textLayer.unbind('mouseup');\r\n        textLayer.unbind('mousemove');\r\n        rubberBanding.unbind('mousemove');\r\n        rubberBanding.remove();\r\n      }\r\n\r\n      rubberBanding.mousemove(function (event2) {\r\n        onMoveX = event2.pageX;\r\n        onMoveY = event2.pageY;\r\n        positionX = onClickX > onMoveX ? onMoveX + 2 : onClickX - 2;\r\n        positionY = onClickY > onMoveY ? onMoveY + 2 : onClickY - 2;\r\n        positionRubberBanding(rubberBanding);\r\n      });\r\n\r\n      body.mousemove(function (event3) {\r\n        const target = $(event3.target);\r\n        if (\r\n          !(\r\n            target.hasClass('indexing-text') ||\r\n            target.hasClass('textLayer') ||\r\n            target.hasClass('endOfContent') ||\r\n            target.hasClass('rubber-banding') ||\r\n            target.hasClass('text-wrapper') ||\r\n            target.hasClass('annotations-canvas')\r\n          )\r\n        ) {\r\n          that.clearHoveredOver();\r\n          reset();\r\n        }\r\n      });\r\n\r\n      $(this).mousemove(function (event4) {\r\n        that.clearHoveredOver();\r\n\r\n        wrappedTextElements = null;\r\n        textElementsWrappers = null;\r\n        onMoveX = event4.pageX;\r\n        onMoveY = event4.pageY;\r\n        positionX = onClickX > onMoveX ? onMoveX + 2 : onClickX - 2;\r\n        positionY = onClickY > onMoveY ? onMoveY + 2 : onClickY - 2;\r\n\r\n        positionRubberBanding(rubberBanding);\r\n\r\n        wrappedTextElements = rubberBanding.collision('.indexing-text');\r\n        textElementsWrappers = rubberBanding.collision('.text-wrapper');\r\n\r\n        if (wrappedTextElements && wrappedTextElements.length) {\r\n          for (let i = 0; i < wrappedTextElements.length; i++) {\r\n            $(wrappedTextElements[i]).addClass('hovered-over');\r\n          }\r\n        }\r\n      });\r\n\r\n      textLayer.mouseup(function (event5) {\r\n        let selectedText = '';\r\n\r\n        that.clearHoveredOver();\r\n        if (wrappedTextElements && wrappedTextElements.length) {\r\n          if (that.currentFocusedPanel === IndexingPanels.LineItemIndexing && wrappedTextElements.length > 1) {\r\n            const valuesArray: Array<string> = [];\r\n            let value = $(wrappedTextElements[0]).text().trim() + ' ';\r\n\r\n            for (let i = 1; i < wrappedTextElements.length; i++) {\r\n              if (that.areSiblings(wrappedTextElements[i - 1], wrappedTextElements[i])) {\r\n                value += $(wrappedTextElements[i]).text().trim() + ' ';\r\n\r\n                if (i === wrappedTextElements.length - 1) {\r\n                  valuesArray.push(value.trim());\r\n                }\r\n\r\n                continue;\r\n              } else if (that.isValueInSameCell(wrappedTextElements[i - 1], wrappedTextElements[i])) {\r\n                value += $(wrappedTextElements[i]).text().trim() + ' ';\r\n              } else {\r\n                valuesArray.push(value.trim());\r\n                value = $(wrappedTextElements[i]).text().trim() + ' ';\r\n              }\r\n\r\n              if (i === wrappedTextElements.length - 1) {\r\n                valuesArray.push(value.trim());\r\n              }\r\n            }\r\n\r\n            that.fillGroupOfFields.emit(new UpdateGroupOfFields(that.capture.getCurrentWorkItem(), valuesArray));\r\n          } else {\r\n            for (let i = 0; i < wrappedTextElements.length; i++) {\r\n              selectedText += $(wrappedTextElements[i]).text() + ' ';\r\n            }\r\n            if (that.documentLocked) {\r\n              const location = that.getSelectionLocation(\r\n                rubberBanding[0].offsetLeft,\r\n                rubberBanding[0].offsetTop,\r\n                rubberBanding[0].offsetWidth,\r\n                rubberBanding[0].offsetHeight,\r\n                false\r\n              );\r\n\r\n              selectedText = selectedText.replace(/  +/g, ' ');\r\n\r\n              that.fillField.emit(\r\n                new UpdateFieldData(that.capture.getCurrentWorkItem(), selectedText.trim(), location)\r\n              );\r\n            }\r\n          }\r\n        }\r\n\r\n        selectedText = '';\r\n        reset();\r\n      });\r\n    });\r\n\r\n    this.indexingService.pointAndClickInitialized();\r\n  }\r\n\r\n  handleTextElement(element) {\r\n    const $this = $(element);\r\n    const text = $this.text().split(' ');\r\n\r\n    if (!$this.hasClass('endOfContent')) $this.addClass('text-wrapper');\r\n\r\n    for (let i = 0; i < text.length; i++) {\r\n      text[i] = '<span class=\"indexing-text\">' + text[i] + '</span>';\r\n    }\r\n\r\n    $this.html(text.join(' '));\r\n  }\r\n\r\n  getSelectionLocation(\r\n    offsetLeft: number,\r\n    offsetTop: number,\r\n    offsetWidth: number,\r\n    offsetHeight: number,\r\n    inflate: boolean\r\n  ): Location {\r\n    const page = this.viewer.pdfViewer._pages[0];\r\n    const pageWidth = this.viewer.pdfViewer._pages[0].viewport.width;\r\n    const pageHeight = this.viewer.pdfViewer._pages[0].viewport.height;\r\n    const canvasOffset = $(page.canvas).offset();\r\n    const viewBox = page.viewport.viewBox;\r\n    const pdfWidth = viewBox[2];\r\n    const pdfHeight = viewBox[3];\r\n\r\n    const rbLeft = offsetLeft - canvasOffset.left;\r\n    const rbTop = offsetTop - canvasOffset.top;\r\n\r\n    const inflateAmounts = this.getInflateAmounts(inflate, pdfWidth, pdfHeight);\r\n\r\n    let location = new Location();\r\n    location.left = Math.round((rbLeft / pageWidth) * pdfWidth - inflateAmounts[0]);\r\n    location.top = Math.round((rbTop / pageHeight) * pdfHeight - inflateAmounts[1]);\r\n    location.right = Math.round((offsetWidth / pageWidth) * pdfWidth + location.left + inflateAmounts[0] * 2);\r\n    location.bottom = Math.round((offsetHeight / pageHeight) * pdfHeight + location.top + inflateAmounts[1] * 2);\r\n    location.page = this.page.order - 1;\r\n    location.valid = false;\r\n\r\n    return location;\r\n  }\r\n\r\n  getInflateAmounts(inflate: boolean, pdfWidth: number, pdfHeight: number): Array<number> {\r\n    const maxInflateAmount: number = inflate ? 3.2 : 0;\r\n\r\n    let widthInflateAmount: number = pdfWidth * 0.0052;\r\n    widthInflateAmount = widthInflateAmount > maxInflateAmount ? maxInflateAmount : widthInflateAmount;\r\n\r\n    let heightInflateAmount: number = pdfHeight * 0.004;\r\n    heightInflateAmount = heightInflateAmount > maxInflateAmount ? maxInflateAmount : heightInflateAmount;\r\n\r\n    return [widthInflateAmount, heightInflateAmount];\r\n  }\r\n\r\n  private hideTooltip(): void {\r\n    $('.indexing-popover-body').text('');\r\n    $('.indexing-popover').hide();\r\n  }\r\n\r\n  isValueInSameCell(element1: any, element2: any): boolean {\r\n    const parent1 = element1.parentElement;\r\n    const parent2 = element2.parentElement;\r\n    const prevRect = parent1.getBoundingClientRect();\r\n    const currentRect = parent2.getBoundingClientRect();\r\n\r\n    return (\r\n      (prevRect.top === currentRect.top && Math.round(prevRect.right) === Math.round(currentRect.left)) ||\r\n      $(parent1).next().is(parent2)\r\n    );\r\n  }\r\n\r\n  areSiblings(e1: any, e2: any): boolean {\r\n    return $(e1).parent().children().is($(e2));\r\n  }\r\n\r\n  onToggleSpinner(state: boolean) {\r\n    if (state) {\r\n      this.toggleSpinner.emit(true);\r\n    } else {\r\n      this.toggleSpinner.emit(false);\r\n    }\r\n  }\r\n\r\n  annotationsAllowed = (): boolean => {\r\n    if (!this.capture.currentWorkflow) return false;\r\n\r\n    const ws = this.capture.getWorkflowStepById(this.capture.getCurrentStepId());\r\n    if (ws == null) return false;\r\n\r\n    return ws.hasCapability(Capabilities.allowAnnotations);\r\n  };\r\n\r\n  onAnnotationAdded = (annotation: Annotation): void => {\r\n    if (this.thumbnails) this.thumbnails.onAnnotationAdded(annotation);\r\n    this.capture.addAnnotation(annotation, () => {}, this.onAddingAnnotationFailed);\r\n  };\r\n\r\n  onAddingAnnotationFailed = (err: any): void => {\r\n    this.errorsService.showErrorsModal([err], this.translate.instant('annotations.add-failed'));\r\n  };\r\n\r\n  onAnnotationUpdated = (annotation: Annotation): void => {\r\n    if (this.thumbnails) this.thumbnails.onAnnotationUpdated(annotation);\r\n    this.capture.updateAnnotation(annotation, () => {}, this.onUpdatingAnnotationFailed);\r\n  };\r\n\r\n  onUpdatingAnnotationFailed = (err: any): void => {\r\n    this.errorsService.showErrorsModal([err], this.translate.instant('annotations.update-failed'));\r\n  };\r\n\r\n  onAnnotationRemoved = (annotation: Annotation): void => {\r\n    if (this.thumbnails) this.thumbnails.onAnnotationRemoved(annotation);\r\n    this.capture.removeAnnotation(annotation.id, () => {}, this.onRemovingAnnotationFailed);\r\n  };\r\n\r\n  onRemovingAnnotationFailed = (err: any): void => {\r\n    this.errorsService.showErrorsModal([err], this.translate.instant('annotations.remove-failed'));\r\n  };\r\n\r\n  updateSize() {\r\n    if (this.viewer && this.viewer.page) {\r\n      this.viewer.updateSize();\r\n    }\r\n  }\r\n\r\n  getHighlightId = (id: string): string => {\r\n    return `highlight-${id.replace('@', '')}`;\r\n  };\r\n\r\n  isFolderItemSelected = (folderItem: FolderItem): boolean => {\r\n    return this.doc && this.doc.workitem && this.doc.workitem.id === folderItem.workItem.id;\r\n  };\r\n\r\n  parseFieldId = (fieldId: string): string => {\r\n    const sections = fieldId.split('-');\r\n    return sections[0];\r\n  };\r\n\r\n  matchingFieldExists = (\r\n    fieldName: string,\r\n    metaDataCollection: MetaDataCollection,\r\n    valueLocation: ValueLocation\r\n  ): boolean => {\r\n    for (const metaData of metaDataCollection.metadata) {\r\n      if (metaData.valueType === MetaDataValueType.LineItems) {\r\n        if (this.matchingFieldExistsInLineItems(fieldName, metaData.value as MetaDataLineItems, valueLocation))\r\n          return true;\r\n      } else {\r\n        if (fieldName.toLowerCase() === metaData.name && this.locationsMatch(metaData.location, valueLocation.location))\r\n          return true;\r\n      }\r\n    }\r\n    return false;\r\n  };\r\n\r\n  matchingFieldExistsInLineItems = (\r\n    fieldName: string,\r\n    metaDataLineItems: MetaDataLineItems,\r\n    valueLocation: ValueLocation\r\n  ): boolean => {\r\n    for (const row of metaDataLineItems) {\r\n      if (this.matchingFieldExists(fieldName, row, valueLocation)) return true;\r\n    }\r\n\r\n    return false;\r\n  };\r\n\r\n  locationsMatch = (locationA: ILocation, locationB: ILocation): boolean => {\r\n    if (locationA.page != locationB.page) return false;\r\n    if (locationA.left != locationB.left) return false;\r\n    if (locationA.top != locationB.top) return false;\r\n    if (locationA.right != locationB.right) return false;\r\n    if (locationA.bottom != locationB.bottom) return false;\r\n\r\n    return true;\r\n  };\r\n}\r\n","<section class=\"doc-viewer text-center\" #wrapper [autoUpdatePerfectScroll]=\"directiveRef\">\r\n  <div\r\n    class=\"pannel-header\"\r\n    [perfectScrollbar]=\"{\r\n      suppressScrollX: false,\r\n      suppressScrollY: true,\r\n      wheelPropagation: true,\r\n      useBothWheelAxes: true\r\n    }\"\r\n  >\r\n    <div class=\"pannel-title\">\r\n      <span *ngIf=\"oneDocumentSelected\">\r\n        {{ doc?.name }} <span class=\"page-count\">{{ getPageCountText() }}</span>\r\n      </span>\r\n    </div>\r\n\r\n    <app-document-locked></app-document-locked>\r\n\r\n    <app-delivery-error></app-delivery-error>\r\n\r\n    <div class=\"viewer-controls\">\r\n      <span class=\"line-separator\"></span>\r\n      <ng-container *ngIf=\"annotationsAllowed() && annotations\">\r\n        <app-action-button\r\n          [action]=\"Action.StopAnnotating\"\r\n          image=\"shared/icons/annotations/cursor.svg\"\r\n          title=\"{{ 'annotations.selection-tool' | translate }}\"\r\n          [disabled]=\"!capture.currentPage\"\r\n        ></app-action-button>\r\n\r\n        <app-action-button\r\n          [action]=\"Action.Redaction\"\r\n          image=\"shared/icons/annotations/redaction.svg\"\r\n          title=\"{{ 'annotations.redact' | translate }}\"\r\n          [disabled]=\"!capture.currentPage\"\r\n        ></app-action-button>\r\n\r\n        <span class=\"line-separator\"></span>\r\n\r\n        <app-action-button\r\n          [action]=\"Action.Highlight\"\r\n          image=\"shared/img/marker.svg\"\r\n          title=\"{{ 'annotations.highlight' | translate }}\"\r\n          [disabled]=\"!capture.currentPage\"\r\n        ></app-action-button>\r\n\r\n        <action-dropdown\r\n          [listItems]=\"annotations?.highlightColors || []\"\r\n          [actionPlaceHolder]=\"annotations?.getHighlighColor() || 'yellow'\"\r\n          [onChangeAction]=\"annotations?.onHighlighColorChanged\"\r\n          [isSelectable]=\"true\"\r\n          [displayHtmlValue]=\"true\"\r\n          [minWidth]=\"60\"\r\n          [minListWidth]=\"100\"\r\n          [actionDropTypeType]=\"'button'\"\r\n          title=\"{{ 'annotations.highlight-color' | translate }}\"\r\n          [extraClasses]=\"'annotation-list'\"\r\n        ></action-dropdown>\r\n\r\n        <span class=\"line-separator\"></span>\r\n\r\n        <app-action-button\r\n          [action]=\"Action.Text\"\r\n          image=\"shared/icons/annotations/text.svg\"\r\n          title=\"{{ 'annotations.text' | translate }}\"\r\n          [disabled]=\"!capture.currentPage\"\r\n        ></app-action-button>\r\n\r\n        <action-dropdown\r\n          [listItems]=\"annotations?.fontNames || []\"\r\n          [actionPlaceHolder]=\"annotations?.getFontName() || 'Arial'\"\r\n          [onChangeAction]=\"annotations?.onFontNameChanged\"\r\n          [isSelectable]=\"true\"\r\n          [displayHtmlValue]=\"true\"\r\n          [minWidth]=\"130\"\r\n          [actionDropTypeType]=\"'button'\"\r\n          title=\"{{ 'annotations.font-name' | translate }}\"\r\n          [extraClasses]=\"'annotation-list'\"\r\n        ></action-dropdown>\r\n\r\n        <action-dropdown\r\n          [listItems]=\"annotations?.fontSizes || []\"\r\n          [actionPlaceHolder]=\"annotations?.getFontSize() || 16\"\r\n          [onChangeAction]=\"annotations?.onFontSizeChanged\"\r\n          [isSelectable]=\"true\"\r\n          [minWidth]=\"60\"\r\n          [minListWidth]=\"60\"\r\n          [actionDropTypeType]=\"'button'\"\r\n          title=\"{{ 'annotations.font-size' | translate }}\"\r\n          [extraClasses]=\"'annotation-list'\"\r\n        ></action-dropdown>\r\n\r\n        <app-action-button\r\n          [action]=\"Action.FreeHand\"\r\n          image=\"shared/icons/annotations/pen.svg\"\r\n          title=\"{{ 'annotations.free-hand' | translate }}\"\r\n          [disabled]=\"!capture.currentPage\"\r\n        ></app-action-button>\r\n\r\n        <app-action-button\r\n          [action]=\"Action.Arrow\"\r\n          image=\"shared/icons/annotations/arrow.svg\"\r\n          title=\"{{ 'annotations.arrow' | translate }}\"\r\n          [disabled]=\"!capture.currentPage\"\r\n        ></app-action-button>\r\n\r\n        <app-action-button\r\n          [action]=\"Action.Line\"\r\n          image=\"shared/icons/annotations/line.svg\"\r\n          title=\"{{ 'annotations.line' | translate }}\"\r\n          [disabled]=\"!capture.currentPage\"\r\n        ></app-action-button>\r\n\r\n        <app-action-button\r\n          [action]=\"Action.Circle\"\r\n          image=\"shared/icons/annotations/circle.svg\"\r\n          title=\"{{ 'annotations.circle' | translate }}\"\r\n          [disabled]=\"!capture.currentPage\"\r\n        ></app-action-button>\r\n\r\n        <app-action-button\r\n          [action]=\"Action.Rectangle\"\r\n          image=\"shared/icons/annotations/rectangle.svg\"\r\n          title=\"{{ 'annotations.rectangle' | translate }}\"\r\n          [disabled]=\"!capture.currentPage\"\r\n        ></app-action-button>\r\n\r\n        <action-dropdown\r\n          [listItems]=\"annotations?.lineWidths || []\"\r\n          [actionPlaceHolder]=\"annotations?.getLineWidth() || 3\"\r\n          [onChangeAction]=\"annotations?.onLineWidthChanged\"\r\n          [isSelectable]=\"true\"\r\n          [displayHtmlValue]=\"true\"\r\n          [minWidth]=\"60\"\r\n          [minListWidth]=\"60\"\r\n          [actionDropTypeType]=\"'button'\"\r\n          title=\"{{ 'annotations.thickness' | translate }}\"\r\n          [extraClasses]=\"'annotation-list'\"\r\n        ></action-dropdown>\r\n\r\n        <app-action-color-button\r\n          [color]=\"annotations?.getColor() || '#ff0000'\"\r\n          title=\"{{ 'annotations.color' | translate }}\"\r\n          class=\"color-btn\"\r\n          [onChangeAction]=\"annotations?.onColorChanged\"\r\n          [disabled]=\"!capture.currentPage\"\r\n          [showOkButton]=\"true\"\r\n          [oKButtonText]=\"'Common.Close' | translate\"\r\n        >\r\n        </app-action-color-button>\r\n\r\n        <span class=\"line-separator\"></span>\r\n\r\n        <app-action-button\r\n          [action]=\"Action.Stamp\"\r\n          image=\"shared/icons/annotations/stamp.svg\"\r\n          title=\"{{ 'annotations.stamp' | translate }}\"\r\n          [disabled]=\"!capture.currentPage\"\r\n        ></app-action-button>\r\n\r\n        <action-dropdown\r\n          [listItems]=\"annotations?.stamps || []\"\r\n          [actionPlaceHolder]=\"annotations?.getStamp() || ''\"\r\n          [onChangeAction]=\"annotations?.onStampChanged\"\r\n          [isSelectable]=\"true\"\r\n          [minWidth]=\"100\"\r\n          [minListWidth]=\"140\"\r\n          [displayHtmlValue]=\"true\"\r\n          [actionDropTypeType]=\"'button'\"\r\n          title=\"{{ 'annotations.stamps' | translate }}\"\r\n          [extraClasses]=\"'annotation-list'\"\r\n        ></action-dropdown>\r\n        <span class=\"line-separator\"></span>\r\n      </ng-container>\r\n\r\n      <app-action-button\r\n        [action]=\"Action.ZoomIn\"\r\n        [disabled]=\"!capture.currentPage\"\r\n        image=\"icons/icnZoomIn.svg\"\r\n        title=\"{{ 'Scanning.ZoomIn' | translate }}\"\r\n      ></app-action-button>\r\n      <app-action-button\r\n        [action]=\"Action.ZoomOut\"\r\n        [disabled]=\"!capture.currentPage\"\r\n        image=\"icons/icnZoomOut.svg\"\r\n        title=\"{{ 'Scanning.ZoomOut' | translate }}\"\r\n      ></app-action-button>\r\n      <app-action-button\r\n        [action]=\"Action.FitToHeight\"\r\n        [disabled]=\"!capture.currentPage\"\r\n        image=\"icons/icnFitToHeight.svg\"\r\n        title=\"{{ 'Scanning.FitToHeight' | translate }}\"\r\n      ></app-action-button>\r\n      <app-action-button\r\n        [action]=\"Action.FitToWidth\"\r\n        [disabled]=\"!capture.currentPage\"\r\n        image=\"icons/icnFitToWidth.svg\"\r\n        title=\"{{ 'Scanning.FitToWidth' | translate }}\"\r\n      ></app-action-button>\r\n      <app-action-button\r\n        [action]=\"Action.RotateLeft\"\r\n        [disabled]=\"!capture.currentPage || !documentLocked\"\r\n        image=\"icons/icnRotateCounterClockwise.svg\"\r\n        title=\"{{ 'Scanning.RotateLeft' | translate }}\"\r\n      ></app-action-button>\r\n      <app-action-button\r\n        [action]=\"Action.RotateRight\"\r\n        [disabled]=\"!capture.currentPage || !documentLocked\"\r\n        image=\"icons/icnRotateClockwise.svg\"\r\n        title=\"{{ 'Scanning.RotateRight' | translate }}\"\r\n      ></app-action-button>\r\n    </div>\r\n  </div>\r\n  <div class=\"d-flex h-100 pl-1\">\r\n    <app-thumbnails\r\n      #thumbnails\r\n      class=\"d-block\"\r\n      [wrapper]=\"$any(wrapper)\"\r\n      (toggleSpinner)=\"onToggleSpinner($event)\"\r\n      appResizable\r\n      [handles]=\"'e'\"\r\n      width=\"150\"\r\n      [preferenceName]=\"thumbnailsViewerKey\"\r\n      [preferenceValue]=\"getPreferenceValue(thumbnailsViewerKey, '10')\"\r\n      (resize)=\"onWidthResize($event)\"\r\n      (widthResized)=\"widthResized()\"\r\n      [annotationsAllowed]=\"annotationsAllowed()\"\r\n    >\r\n    </app-thumbnails>\r\n    <div class=\"r-section col p-0\" #viewerArea>\r\n      <div class=\"file-drop-wrapper p-2\" *ngIf=\"!capture.currentPage && canDropDocuments()\">\r\n        <ngx-file-drop (onFileDrop)=\"dropped($event)\">\r\n          <ng-template ngx-file-drop-content-tmp>\r\n            <span>{{ 'Scanning.DragDrop' | translate }}</span>\r\n          </ng-template>\r\n        </ngx-file-drop>\r\n      </div>\r\n\r\n      <div class=\"content-container\" *ngIf=\"multipleItemsSelected\">\r\n        <div class=\"content-wrapper\">\r\n          <div class=\"content\">\r\n            <span>{{ selectedItemsCountText }}</span>\r\n          </div>\r\n        </div>\r\n      </div>\r\n\r\n      <div\r\n        class=\"scrollable-section has-header\"\r\n        id=\"viewerWrapper\"\r\n        [perfectScrollbar]=\"{}\"\r\n        #ps1=\"ngxPerfectScrollbar\"\r\n        *ngIf=\"capture.currentPage?.viewerURL\"\r\n        fxFlex=\"auto\"\r\n      >\r\n        <pdf-viewer\r\n          [style.width.px]=\"viewerArea.clientWidth\"\r\n          [style.height.px]=\"viewerArea.clientHeight\"\r\n          [src]=\"capture.currentPage?.viewerURL || ''\"\r\n          [render-text]=\"true\"\r\n          [zoom]=\"scale\"\r\n          [original-size]=\"fitToWidthLandscape\"\r\n          [fit-to-page]=\"true\"\r\n          [autoresize]=\"fitToWidthPortrait\"\r\n          [show-all]=\"false\"\r\n          [page]=\"1\"\r\n          (page-rendered)=\"onPageRendered($event)\"\r\n          (text-layer-rendered)=\"setupPointerIndexing($event)\"\r\n          #viewer\r\n        >\r\n        </pdf-viewer>\r\n      </div>\r\n    </div>\r\n  </div>\r\n  <app-annotations\r\n    *ngIf=\"annotationsAllowed() && viewer\"\r\n    [viewer]=\"viewer\"\r\n    [id]=\"selectedDocument?.id\"\r\n    [pageNumber]=\"capture?.currentPage?.order\"\r\n    [annotations]=\"documentWorkItemAnnotations\"\r\n    (annotationAdded)=\"onAnnotationAdded($event)\"\r\n    (annotationUpdated)=\"onAnnotationUpdated($event)\"\r\n    (annotationRemoved)=\"onAnnotationRemoved($event)\"\r\n  ></app-annotations>\r\n</section>\r\n","import {\r\n  AfterViewInit,\r\n  Component,\r\n  ElementRef,\r\n  EventEmitter,\r\n  Input,\r\n  OnChanges,\r\n  OnDestroy,\r\n  OnInit,\r\n  Output,\r\n  SimpleChanges,\r\n  ViewChild,\r\n  ViewEncapsulation,\r\n} from '@angular/core';\r\n\r\nimport { TranslateService } from '@ngx-translate/core';\r\nimport { NgxSmartModalService } from 'ngx-smart-modal';\r\nimport { Observable, Subscription } from 'rxjs';\r\n\r\nimport { DelayService } from 'shared-code-lib';\r\nimport { Action, ActionEvent } from '../../../../../blocks/core/actions';\r\nimport { KeyboardActionMapping } from '../../../../../blocks/core/keyboardActionMapping';\r\nimport { ActionService } from '../../../../../blocks/services/action.service';\r\nimport { Page, PageState } from '../../../capture-models';\r\nimport { DocumentViewerService } from '../../../capture-services';\r\nimport { DocumentCaptureService } from '../../../capture-services/document-capture.service';\r\n\r\ndeclare const $: any;\r\n\r\n@Component({\r\n  selector: 'app-thumbnail',\r\n  templateUrl: './thumbnail.component.html',\r\n  styleUrls: ['./thumbnail.component.scss'],\r\n  encapsulation: ViewEncapsulation.None,\r\n})\r\nexport class ThumbnailComponent implements OnInit, AfterViewInit, OnChanges, OnDestroy {\r\n  @ViewChild('thumbnailWrapper', { static: true }) wrapperElementRef: ElementRef;\r\n  @Input() page: Page;\r\n  @Input() canBeDeleted: boolean;\r\n  @Input() isPageDraggable: boolean;\r\n  @Input() onWidthResized: Observable<number>;\r\n  @Input() annotationsAllowed: boolean = false;\r\n  @Output() loaded = new EventEmitter();\r\n  @Output() getThumbnail = new EventEmitter<Page>();\r\n  @Output() toggleSpinner = new EventEmitter<boolean>();\r\n\r\n  wrapperElement: Element;\r\n  subscriptions = new Subscription();\r\n  thumbnailDefaultHeightPercentage = 1.2;\r\n\r\n  PageState = PageState;\r\n\r\n  constructor(\r\n    private capture: DocumentCaptureService,\r\n    private ngxSmartModalService: NgxSmartModalService,\r\n    private translate: TranslateService,\r\n    viewer: DocumentViewerService,\r\n    private actionService: ActionService,\r\n    private delay: DelayService\r\n  ) {\r\n    this.subscriptions.add(viewer.onThumbnailScroll.subscribe(this.onThumbnailScrolled));\r\n  }\r\n  ngOnChanges(changes: SimpleChanges): void {\r\n    if (changes.page && changes.page.currentValue)\r\n      this.subscriptions.add(this.page.annotationsChanged.subscribe(() => this.drawAnnotations()));\r\n  }\r\n\r\n  ngOnInit() {\r\n    this.subscriptions.add(\r\n      this.onWidthResized.subscribe(() => {\r\n        this.drawAnnotations();\r\n        this.getThumbnail.emit(this.page);\r\n      })\r\n    );\r\n  }\r\n\r\n  ngAfterViewInit() {\r\n    this.wrapperElement = this.wrapperElementRef.nativeElement;\r\n  }\r\n\r\n  ngOnDestroy() {\r\n    this.subscriptions.unsubscribe();\r\n  }\r\n\r\n  onThumbnailScrolled = (scrollTop: number): void => {\r\n    if (!this.isPageInViewPort(this.wrapperElementRef, false)) {\r\n      if (this.page.state !== PageState.Loaded) this.page.state = PageState.Empty;\r\n      this.capture.cancelLoadDocumentPage(this.page);\r\n      return;\r\n    }\r\n\r\n    if (this.page.state !== PageState.Empty) return;\r\n\r\n    this.delay.execute(() => {\r\n      if (!this.isPageInViewPort(this.wrapperElementRef, false) || this.page.state !== PageState.Empty) return;\r\n      this.capture.loadDocumentPage(this.page, () => {\r\n        this.getThumbnail.emit(this.page);\r\n      });\r\n    }, 400);\r\n  };\r\n\r\n  isPageInViewPort(element: ElementRef, fullyInView: boolean) {\r\n    const pageTop = $(window).scrollTop();\r\n    const pageBottom = pageTop + $(window).height();\r\n    const elementTop = $(element.nativeElement).offset().top;\r\n    const elementBottom = elementTop + $(element.nativeElement).height();\r\n\r\n    if (fullyInView === true) {\r\n      return pageTop < elementTop && pageBottom > elementBottom;\r\n    } else {\r\n      return elementTop <= pageBottom && elementBottom >= pageTop;\r\n    }\r\n  }\r\n\r\n  select() {\r\n    this.capture.selectSpecificPage(this.page);\r\n  }\r\n\r\n  confirmDelete(e: Event): void {\r\n    e.stopPropagation();\r\n    this.ngxSmartModalService.setModalData(\r\n      {\r\n        title: 'MainHeader.DeleteConfirmation',\r\n        text: this.translate.instant('Document_Capture.Confirm_Delete_Page'),\r\n        buttonText: this.translate.instant('Common.Delete'),\r\n        confirm: this.confirmedDelete,\r\n        cancel: this.cancelDelete,\r\n      },\r\n      'actionConfirmModal',\r\n      true\r\n    );\r\n\r\n    this.ngxSmartModalService.getModal('actionConfirmModal').open();\r\n  }\r\n\r\n  confirmedDelete = () => {\r\n    this.ngxSmartModalService.getModal('actionConfirmModal').close();\r\n    this.toggleSpinner.emit(true);\r\n    this.capture.deletePage(this.page, () => {\r\n      this.toggleSpinner.emit(false);\r\n    });\r\n  };\r\n\r\n  cancelDelete = () => {\r\n    this.ngxSmartModalService.getModal('actionConfirmModal').close();\r\n  };\r\n\r\n  getBreakIconTitle(): string {\r\n    const title = this.translate.instant('document-actions.break-document');\r\n    if (this.capture.currentPage.id !== this.page.id) return title;\r\n\r\n    const keyboardTooltip = KeyboardActionMapping.getTooltipFor(Action.BreakDocument, this.translate);\r\n    return `${title}${keyboardTooltip}`;\r\n  }\r\n\r\n  breakDocument(): void {\r\n    this.select();\r\n    this.actionService.activateAction(new ActionEvent(Action.BreakDocument));\r\n  }\r\n\r\n  drawAnnotations() {\r\n    if (!this.annotationsAllowed || !this.wrapperElementRef || !this.page || !this.page.annotations) return;\r\n\r\n    const canvas = this.wrapperElementRef.nativeElement.getElementsByTagName('canvas')[0];\r\n    if (!canvas) return;\r\n    const img = canvas.parentElement.getElementsByTagName('img')[0];\r\n    if (!img) return;\r\n\r\n    canvas.width = img.width;\r\n    canvas.height = img.height;\r\n    const ctx = canvas.getContext('2d');\r\n    ctx.clearRect(0, 0, canvas.width, canvas.height);\r\n\r\n    this.page.annotations\r\n      .sort((a, b) => a.order - b.order)\r\n      .forEach((annotation) => {\r\n        annotation.draw(ctx, canvas.width, canvas.height, false);\r\n      });\r\n  }\r\n}\r\n","<div\r\n  #thumbnailWrapper\r\n  class=\"thumbnail-wrapper\"\r\n  (click)=\"select()\"\r\n  style=\"display: flex; justify-content: center; align-items: center\"\r\n  title=\"{{ 'document-thumbnail.tooltip' | translate }} {{ page.order }}\"\r\n>\r\n  <div class=\"page-loader\" *ngIf=\"page.state === PageState.Loading\"></div>\r\n\r\n  <div class=\"thumbnail-overlay\">\r\n    <button\r\n      class=\"button-icon overlay-icon remove\"\r\n      (click)=\"confirmDelete($event)\"\r\n      *ngIf=\"canBeDeleted && page.state === PageState.Loaded\"\r\n      [title]=\"'document-actions.delete-page' | translate\"\r\n    >\r\n      <span class=\"icon-cancel-circle\"></span>\r\n    </button>\r\n\r\n    <button\r\n      class=\"button-icon overlay-icon break\"\r\n      (click)=\"breakDocument()\"\r\n      *ngIf=\"page.order > 1 && isPageDraggable && page.state === PageState.Loaded\"\r\n      [title]=\"getBreakIconTitle()\"\r\n    >\r\n      <img src=\"assets/img/workflow-editor/bursting.svg\" style=\"max-width: none\" />\r\n    </button>\r\n  </div>\r\n\r\n  <div class=\"pdf-viewer-wrapper\" (resized)=\"drawAnnotations()\">\r\n    <img\r\n      class=\"img-h-fluid\"\r\n      *ngIf=\"page.state === PageState.Loaded ? page.thumbnailURL : ''\"\r\n      [src]=\"page.thumbnailURL\"\r\n      alt=\"\"\r\n      (load)=\"drawAnnotations()\"\r\n    />\r\n    <canvas></canvas>\r\n  </div>\r\n</div>\r\n","import {\r\n  AfterViewInit,\r\n  Component,\r\n  ElementRef,\r\n  EventEmitter,\r\n  HostListener,\r\n  Input,\r\n  OnDestroy,\r\n  OnInit,\r\n  Output,\r\n  ViewChild,\r\n  ViewEncapsulation,\r\n} from '@angular/core';\r\nimport { TranslateService } from '@ngx-translate/core';\r\nimport { PerfectScrollbarDirective } from 'ngx-perfect-scrollbar-portable';\r\nimport { ToastrService } from 'ngx-toastr';\r\nimport { Subject, Subscription } from 'rxjs';\r\n\r\nimport { PdfViewerComponent } from 'ng2-pdf-viewer';\r\nimport { Annotation, CalculationsService, DelayService } from 'shared-code-lib';\r\nimport { Action, ActionEvent } from '../../../../blocks/core/actions';\r\nimport { LockStatus } from '../../../../blocks/models/lock-status';\r\nimport { IWorkItem } from '../../../../blocks/models/work-item';\r\nimport { ActionService } from '../../../../blocks/services/action.service';\r\nimport { HydraApiService } from '../../../../blocks/services/hydra-api.service';\r\nimport { UserStateService } from '../../../../blocks/services/user-state.service';\r\nimport { DocumentCaptureService } from '../../../../views/document-capture/capture-services/document-capture.service';\r\nimport { Capabilities, CapturedDocument, DragData, Page, PageState } from '../../capture-models';\r\nimport { CaptureConstants } from '../../capture-models/capture-constants';\r\nimport { CaptureUpdateService } from '../../capture-services/capture-update.service';\r\nimport { DocumentLastTouchedService } from '../../capture-services/document-last-touched.service';\r\nimport { DocumentLockingService } from '../../capture-services/document-locking.service';\r\nimport { DocumentViewerService } from '../../capture-services/document-viewer.service';\r\n\r\ndeclare const $: any;\r\n\r\n@Component({\r\n  selector: 'app-thumbnails',\r\n  templateUrl: './thumbnails.component.html',\r\n  styleUrls: ['./thumbnails.component.scss'],\r\n  encapsulation: ViewEncapsulation.None,\r\n})\r\nexport class ThumbnailsComponent implements OnInit, OnDestroy, AfterViewInit {\r\n  @Input() wrapper: ElementRef;\r\n  @Input() annotationsAllowed: boolean = false;\r\n  @Output() toggleSpinner = new EventEmitter<boolean>();\r\n  @ViewChild('thumbnailsPanel', { static: true }) thumbnailsPanelElementRef: ElementRef;\r\n  @ViewChild('thumbnailsUl', { static: true }) thumbnailsUl: ElementRef;\r\n  @ViewChild('viewer') viewer: PdfViewerComponent;\r\n  @ViewChild(PerfectScrollbarDirective, { static: true }) directiveRef?: PerfectScrollbarDirective;\r\n  thumbnailsPanelElement: Element;\r\n\r\n  currentDocument: CapturedDocument;\r\n  selectedPage: Page;\r\n  isPageDraggable: boolean;\r\n  pageCanBeDeleted: boolean;\r\n  subscriptions: Subscription;\r\n  widthResizedSubject: Subject<number>;\r\n  currentPage: Page;\r\n  waitingPages: Page[] = [];\r\n\r\n  documentLocked: boolean;\r\n\r\n  pageString = CaptureConstants.page;\r\n\r\n  @HostListener('window:resize')\r\n  onResize() {\r\n    this.widthResized();\r\n  }\r\n\r\n  constructor(\r\n    private viewerService: DocumentViewerService,\r\n    public capture: DocumentCaptureService,\r\n    private captureUpdate: CaptureUpdateService,\r\n    private actionService: ActionService,\r\n    private hydraApi: HydraApiService,\r\n    private toastr: ToastrService,\r\n    private translate: TranslateService,\r\n    private calculate: CalculationsService,\r\n    private delay: DelayService,\r\n    private documentLockingService: DocumentLockingService,\r\n    private userStateService: UserStateService,\r\n    private documentLastTouchedService: DocumentLastTouchedService\r\n  ) {\r\n    this.subscriptions = new Subscription();\r\n    this.widthResizedSubject = new Subject<number>();\r\n  }\r\n\r\n  ngAfterViewInit() {\r\n    this.thumbnailsPanelElement = this.thumbnailsPanelElementRef.nativeElement;\r\n    this.thumbnailsPanelElement.addEventListener('ps-scroll-y', this.onPanelScrolled);\r\n  }\r\n\r\n  ngOnInit() {\r\n    this.subscriptions.add(this.captureUpdate.onChangeDocumentPage.subscribe((page) => (this.selectedPage = page)));\r\n    this.subscriptions.add(this.documentLockingService.lockStatusChanged.subscribe(this.lockStatusChanged));\r\n\r\n    this.subscriptions.add(\r\n      this.captureUpdate.onChangeDocument.subscribe((doc) => {\r\n        this.documentLocked = false;\r\n\r\n        this.delay.execute(() => {\r\n          this.currentDocument = doc;\r\n          this.thumbnailsPanelElement.scrollTop = 0;\r\n          this.currentPage = null;\r\n          this.waitingPages = [];\r\n\r\n          if (doc) {\r\n            setTimeout(() => {\r\n              this.viewerService.thumbnailScrolled(0);\r\n              this.widthResized();\r\n            }, 50);\r\n          }\r\n\r\n          const ws = this.capture.getWorkflowStepById(this.capture.getCurrentStepId());\r\n          this.isPageDraggable = ws && ws.hasCapability(Capabilities.allowDropDocumentPage);\r\n          this.pageCanBeDeleted = ws && ws.hasCapability(Capabilities.deletePage);\r\n        }, 10);\r\n      })\r\n    );\r\n\r\n    this.subscriptions.add(this.actionService.onActivateAction.subscribe(this.invokeAction));\r\n\r\n    window.addEventListener('resize', this.onPanelScrolled);\r\n\r\n    this.subscriptions.add(\r\n      this.captureUpdate.onRotatePage.subscribe(() => {\r\n        this.capture.loadDocumentPage(this.selectedPage, () => {\r\n          this.getThumbnail(this.selectedPage);\r\n        });\r\n      })\r\n    );\r\n  }\r\n\r\n  lockStatusChanged = (ls: LockStatus): void => {\r\n    if (!this.currentDocument || !this.currentDocument.workitem) return;\r\n\r\n    if (ls.id == this.currentDocument.workitem.id) {\r\n      this.documentLocked = ls.locked && ls.lockedByUserId == this.userStateService.user.id && !ls.expired();\r\n    }\r\n  };\r\n\r\n  invokeAction = (event: ActionEvent): void => {\r\n    if (event.action === Action.NextPage) {\r\n      this.movePageSelection(1);\r\n      return;\r\n    } else if (event.action === Action.PreviousPage) {\r\n      this.movePageSelection(-1);\r\n      return;\r\n    } else if (event.action === Action.BreakDocument) {\r\n      this.breakDocument();\r\n      return;\r\n    }\r\n  };\r\n\r\n  movePageSelection(offset: number) {\r\n    if (!this.selectedPage) return;\r\n\r\n    let nextPageOrder = this.selectedPage.order + offset;\r\n\r\n    if (nextPageOrder < 1) {\r\n      nextPageOrder = this.currentDocument.pageCount;\r\n    } else if (nextPageOrder > this.currentDocument.pageCount) {\r\n      nextPageOrder = 1;\r\n    }\r\n\r\n    this.setSelectedPage(nextPageOrder);\r\n  }\r\n\r\n  breakDocument(): void {\r\n    if (this.selectedPage.order < 2 || !this.isPageDraggable) return;\r\n    if (!this.documentLocked) return;\r\n\r\n    this.hydraApi.splitDocumentByPageNumber(\r\n      this.capture.getCurrentWorkItem().id,\r\n      this.currentDocument.id,\r\n      this.selectedPage.order,\r\n      (newWorkItem: IWorkItem) => {\r\n        const documentId = newWorkItem.files[0];\r\n\r\n        const parentFolder = this.capture.findFolder(this.currentDocument.parentFolderId);\r\n        const searchResult = parentFolder.findDocument(documentId);\r\n        if (searchResult) {\r\n          this.capture.selectDocument(\r\n            searchResult.document,\r\n            searchResult.workItem,\r\n            this.currentDocument.parentFolderId\r\n          );\r\n          return;\r\n        }\r\n\r\n        this.documentLastTouchedService.setLastTouchedWorkItem(newWorkItem.id);\r\n      },\r\n      (err) => {\r\n        this.toastr.error(this.translate.instant('Document_Capture.document-break-failed'));\r\n      }\r\n    );\r\n  }\r\n\r\n  setSelectedPage(order: number) {\r\n    this.selectedPage = this.currentDocument.pages.find((p) => p.order === order);\r\n    this.capture.selectSpecificPage(this.selectedPage);\r\n\r\n    const pageElementId = `page-${order - 1}`;\r\n    const element = document.getElementById(pageElementId);\r\n    const container = this.thumbnailsPanelElementRef.nativeElement;\r\n    if (!this.calculate.isVisibleInScrollableElement(element, container, false)) {\r\n      this.directiveRef.scrollToElement(`#${pageElementId}`, 0, 100);\r\n    }\r\n  }\r\n\r\n  ngOnDestroy() {\r\n    this.subscriptions.unsubscribe();\r\n\r\n    window.removeEventListener('resize', this.onPanelScrolled);\r\n    if (this.thumbnailsPanelElement) {\r\n      this.thumbnailsPanelElement.removeEventListener('ps-scroll-y', this.onPanelScrolled);\r\n    }\r\n  }\r\n\r\n  onSort(dragData: DragData) {\r\n    this.toggleSpinner.emit(true);\r\n    this.capture\r\n      .handleSortingPages(dragData)\r\n      .then(() => {\r\n        this.capture.sortPages(true);\r\n        this.toggleSpinner.emit(false);\r\n      })\r\n      .catch(() => {\r\n        this.capture.sortPages(false);\r\n        this.toggleSpinner.emit(false);\r\n      });\r\n  }\r\n\r\n  onToggleSpinner(state: boolean) {\r\n    if (state) {\r\n      this.toggleSpinner.emit(true);\r\n    } else {\r\n      this.toggleSpinner.emit(false);\r\n    }\r\n  }\r\n\r\n  onPanelScrolled = (ev?: Event): any => {\r\n    this.viewerService.thumbnailScrolled(this.thumbnailsPanelElement.scrollTop);\r\n  };\r\n\r\n  onScroll(position: number) {\r\n    this.directiveRef.scrollToY(position, 100);\r\n  }\r\n\r\n  widthResized() {\r\n    const ulWidth = $(this.thumbnailsUl.nativeElement).width();\r\n    this.waitingPages = [];\r\n    this.widthResizedSubject.next(ulWidth);\r\n    this.onPanelScrolled();\r\n  }\r\n\r\n  onPageLoad() {\r\n    this.onPanelScrolled();\r\n  }\r\n\r\n  renderNextThumbnail() {\r\n    if (this.capture.currentPage?.order) {\r\n      this.waitingPages = this.waitingPages.sort((p1) => this.capture.currentPage.order - p1.order);\r\n    }\r\n\r\n    const nextThumbnail = this.waitingPages.splice(0, 1)[0];\r\n    this.getThumbnail(nextThumbnail);\r\n  }\r\n\r\n  getThumbnail(page: Page) {\r\n    if (!page || !page.viewerURL) return;\r\n\r\n    const pageAlreadyHasThumbnailUrl = !!page.thumbnailURL;\r\n    if (pageAlreadyHasThumbnailUrl) this.renderNextThumbnail();\r\n\r\n    if (this.currentPage) {\r\n      const isPageInQueue = this.waitingPages.findIndex((p) => p.id === page.id) !== -1;\r\n      if (!isPageInQueue) this.waitingPages.push(page);\r\n    } else {\r\n      this.currentPage = page;\r\n    }\r\n\r\n    this.updateSize();\r\n  }\r\n\r\n  onRender() {\r\n    if (!this.currentPage) {\r\n      return;\r\n    }\r\n\r\n    const canvas = document.querySelector('.canvasWrapper canvas') as HTMLCanvasElement;\r\n\r\n    this.waitingPages = this.waitingPages.filter((p) => p.id !== this.currentPage.id);\r\n\r\n    this.currentPage.thumbnailURL = canvas.toDataURL('image/jpeg');\r\n    this.currentPage.state = PageState.Loaded;\r\n    this.currentPage = null;\r\n\r\n    this.renderNextThumbnail();\r\n  }\r\n\r\n  onAnnotationsLoaded = () => {\r\n    if (!this.annotationsAllowed) return;\r\n\r\n    this.currentDocument.pages.forEach((page) => {\r\n      page.onAnnotationsChanged();\r\n    });\r\n  };\r\n\r\n  onAnnotationAdded = (annotation: Annotation) => {\r\n    if (!this.annotationsAllowed) return;\r\n\r\n    const page = this.currentDocument.pages.find((x) => x.order == annotation.pageNumber);\r\n    if (!page) return;\r\n\r\n    page.annotations.push(annotation);\r\n    page.onAnnotationsChanged();\r\n  };\r\n\r\n  onAnnotationUpdated = (annotation: Annotation) => {\r\n    if (!this.annotationsAllowed) return;\r\n\r\n    const page = this.currentDocument.pages.find((x) => x.order == annotation.pageNumber);\r\n    if (!page) return;\r\n\r\n    const index = page.annotations.findIndex((x) => x.id == annotation.id);\r\n    if (index == -1) return;\r\n    page.annotations[index] = annotation;\r\n    page.onAnnotationsChanged();\r\n  };\r\n\r\n  onAnnotationRemoved = (annotation: Annotation) => {\r\n    if (!this.annotationsAllowed) return;\r\n\r\n    const page = this.currentDocument.pages.find((x) => x.order == annotation.pageNumber);\r\n    if (!page) return;\r\n\r\n    const index = page.annotations.findIndex((x) => x.id == annotation.id);\r\n    if (index == -1) return;\r\n    page.annotations.splice(index, 1);\r\n    page.onAnnotationsChanged();\r\n  };\r\n\r\n  updateSize() {\r\n    if (this.viewer && this.viewer.page) {\r\n      this.viewer.updateSize();\r\n    }\r\n  }\r\n}\r\n","<section class=\"thumbnails\" #thumbnails>\r\n  <div\r\n    #thumbnailsPanel\r\n    class=\"scrollable-section\"\r\n    fxFlex=\"auto\"\r\n    [perfectScrollbar]=\"{ suppressScrollX: true }\"\r\n    [autoUpdatePerfectScroll]=\"directiveRef\"\r\n  >\r\n    <ul\r\n      class=\"thumbnails-wrapper tree p-1 mb-0\"\r\n      #thumbnailsUl\r\n      [hidden]=\"!currentDocument\"\r\n      appDragNDrop\r\n      [isSortable]=\"isPageDraggable && documentLocked\"\r\n      [sortableList]=\"currentDocument?.pages\"\r\n      [sortableListLength]=\"currentDocument?.pages.length\"\r\n      [sortableElementType]=\"pageString\"\r\n      [sortableParentStepId]=\"currentDocument?.parentStepId\"\r\n      [autoScroll]=\"true\"\r\n      [wrapper]=\"wrapper\"\r\n      [scrollableWrapper]=\"$any(thumbnailsPanel)\"\r\n      [autoScrollStep]=\"30\"\r\n      (sort)=\"onSort($event)\"\r\n      (scrollToTop)=\"onScroll($event)\"\r\n      (scrollToBottom)=\"onScroll($event)\"\r\n    >\r\n      <li class=\"page pb-1 mx-1\" *ngFor=\"let page of currentDocument?.pages\">\r\n        <app-thumbnail\r\n          class=\"d-block\"\r\n          [page]=\"page\"\r\n          [canBeDeleted]=\"pageCanBeDeleted && documentLocked\"\r\n          [isPageDraggable]=\"isPageDraggable && documentLocked\"\r\n          [onWidthResized]=\"widthResizedSubject.asObservable()\"\r\n          [class.selected]=\"capture.currentPage?.order === page.order\"\r\n          [annotationsAllowed]=\"annotationsAllowed\"\r\n          (loaded)=\"onPageLoad()\"\r\n          (getThumbnail)=\"getThumbnail($event)\"\r\n          (toggleSpinner)=\"onToggleSpinner($event)\"\r\n        >\r\n        </app-thumbnail>\r\n      </li>\r\n    </ul>\r\n  </div>\r\n\r\n  <div class=\"thumbnail-generator-wrapper\" *ngIf=\"currentPage?.viewerURL\">\r\n    <pdf-viewer\r\n      [style.width.px]=\"thumbnails.clientWidth\"\r\n      [style.height.px]=\"thumbnails.clientHeight\"\r\n      [src]=\"currentPage.viewerURL\"\r\n      [original-size]=\"true\"\r\n      [fit-to-page]=\"true\"\r\n      [show-all]=\"false\"\r\n      [page]=\"1\"\r\n      [render-text]=\"false\"\r\n      (page-rendered)=\"onRender()\"\r\n      #viewer\r\n    >\r\n    </pdf-viewer>\r\n  </div>\r\n</section>\r\n","import {\r\n  AfterViewInit,\r\n  ChangeDetectionStrategy,\r\n  ChangeDetectorRef,\r\n  Component,\r\n  ElementRef,\r\n  EventEmitter,\r\n  Inject,\r\n  Input,\r\n  OnDestroy,\r\n  OnInit,\r\n  Output,\r\n  QueryList,\r\n  Renderer2,\r\n  ViewChild,\r\n  ViewChildren,\r\n  ViewEncapsulation,\r\n} from '@angular/core';\r\nimport { TranslateService } from '@ngx-translate/core';\r\nimport { BsDropdownDirective } from 'ngx-bootstrap/dropdown';\r\nimport { NgxSmartModalService } from 'ngx-smart-modal';\r\nimport { Subscription } from 'rxjs';\r\n\r\nimport { DOCUMENT } from '@angular/common';\r\nimport { filter } from 'rxjs/operators';\r\nimport {\r\n  BlurEvent,\r\n  ContextMenuComponent,\r\n  DelayService,\r\n  FieldDefinition,\r\n  FieldDisplayMode,\r\n  FolderTreeAction,\r\n  Key,\r\n  MetaData,\r\n  MetaDataCollection,\r\n  MetaDataDefinition,\r\n  MetaDataType,\r\n  MetaDataValidity,\r\n  MetaDataValueType,\r\n  RolePermissions,\r\n  SaveLookupsEvent,\r\n  StickyFieldsService,\r\n} from 'shared-code-lib';\r\nimport { Action, ActionEvent } from '../../../../blocks/core/actions';\r\nimport { Filename } from '../../../../blocks/core/fileName';\r\nimport { Document as DocumentType } from '../../../../blocks/models/document';\r\nimport { FolderItem } from '../../../../blocks/models/folder-item';\r\nimport { LockStatus } from '../../../../blocks/models/lock-status';\r\nimport { IOutcome } from '../../../../blocks/models/outcome';\r\nimport { InteractiveWorkflowStep, WorkflowStep } from '../../../../blocks/models/workflow-step';\r\nimport { ActionService } from '../../../../blocks/services/action.service';\r\nimport { DragDropService } from '../../../../blocks/services/drag-drop.service';\r\nimport { ModalsUtilitiesService } from '../../../../blocks/services/modals-utilities.service';\r\nimport { Dictionary } from '../../../../blocks/services/models';\r\nimport { SpinnerStateService } from '../../../../blocks/services/spinner-state.service';\r\nimport { UserStateService } from '../../../../blocks/services/user-state.service';\r\nimport {\r\n  Capabilities,\r\n  DocumentListStyle,\r\n  DragData,\r\n  IndexingPanels,\r\n  ValueLocation,\r\n  ValueObj,\r\n} from '../../capture-models';\r\nimport { CaptureConstants } from '../../capture-models/capture-constants';\r\nimport { IndexingPanelService } from '../../capture-services';\r\nimport { CaptureUpdateService } from '../../capture-services/capture-update.service';\r\nimport { DocumentCaptureService } from '../../capture-services/document-capture.service';\r\nimport { DocumentLastTouchedService } from '../../capture-services/document-last-touched.service';\r\nimport { DocumentListStyleService } from '../../capture-services/document-list-style.service';\r\nimport { DocumentLockingService } from '../../capture-services/document-locking.service';\r\nimport { FolderViewEventsService } from '../../capture-services/folder-view-events.service';\r\nimport { OutcomesService } from '../../capture-services/outcomes.service';\r\nimport { SelectedItemsService } from '../../capture-services/selected-items.service';\r\n\r\ndeclare const $: any;\r\n\r\n@Component({\r\n  selector: 'app-document',\r\n  templateUrl: './document.component.html',\r\n  styleUrls: ['./document.component.scss'],\r\n  encapsulation: ViewEncapsulation.None,\r\n  changeDetection: ChangeDetectionStrategy.OnPush,\r\n})\r\nexport class DocumentComponent implements OnInit, OnDestroy, AfterViewInit {\r\n  @ViewChild('docName') docName: ElementRef;\r\n  @ViewChild('docWrapper', { static: true }) docWrapper: ElementRef;\r\n  @ViewChild('wrapper') wrapper: ElementRef;\r\n  @ViewChild('menu') menu: ElementRef;\r\n  @ViewChildren('fieldCell', { read: ElementRef })\r\n  fieldElements: QueryList<ElementRef>;\r\n\r\n  @Input() folderItem: FolderItem;\r\n  @Input() parentFolderId: string;\r\n  @Input() doc: DocumentType;\r\n  @Input() selected: boolean;\r\n  @Input() stepMetadataDefinitions: Array<MetaDataDefinition> = [];\r\n  @Input() stepMetadataDefinitionsFields: Array<FieldDefinition> = [];\r\n  @Input() contextMenu: ContextMenuComponent;\r\n  @Output() documentLoaded = new EventEmitter();\r\n\r\n  isViewerLoaded: boolean;\r\n  editing: boolean;\r\n  lastDocumentName: string;\r\n  subscriptions: Subscription;\r\n  dragStarted: boolean;\r\n  dropEnabled: boolean;\r\n  overallValidity: MetaDataValidity;\r\n  canDeleteDocument: boolean;\r\n  canReplaceDocument: boolean;\r\n  canRescanDocument: boolean;\r\n  canManageWorkitem: boolean;\r\n  hoverOver: boolean;\r\n  hoverOverMenu: boolean;\r\n  showMenu: boolean;\r\n  dropup: boolean;\r\n  FILENAME_CELL_INDEX: number = -1;\r\n  selectedCellIndex: number;\r\n  isGridView: boolean;\r\n  DocumentGridPanel = IndexingPanels['DocumentGrid'];\r\n\r\n  fieldDocumentName: FieldDefinition;\r\n  fieldsValues = new Dictionary('', '');\r\n\r\n  documentLocked: boolean;\r\n  oneItemSelected: boolean;\r\n  isDocumentSelected: boolean;\r\n  multipleSelectedItems: boolean;\r\n\r\n  documentString = CaptureConstants.document;\r\n\r\n  outcomes: IOutcome[] = [];\r\n\r\n  get metaDataValidity() {\r\n    return MetaDataValidity;\r\n  }\r\n\r\n  constructor(\r\n    private capture: DocumentCaptureService,\r\n    private cdr: ChangeDetectorRef,\r\n    private indexingService: IndexingPanelService,\r\n    private userState: UserStateService,\r\n    private delay: DelayService,\r\n    private translate: TranslateService,\r\n    private actionService: ActionService,\r\n    private spinnerState: SpinnerStateService,\r\n    private stickyService: StickyFieldsService,\r\n    private captureUpdate: CaptureUpdateService,\r\n    private documentListStyleService: DocumentListStyleService,\r\n    private folderViewEvents: FolderViewEventsService,\r\n    private documentLockingService: DocumentLockingService,\r\n    public userStateService: UserStateService,\r\n    private selectedItemsService: SelectedItemsService,\r\n    private documentLastTouchedService: DocumentLastTouchedService,\r\n    private dragDropService: DragDropService,\r\n    private outcomesService: OutcomesService,\r\n    private ngxSmartModalService: NgxSmartModalService,\r\n    private renderer: Renderer2,\r\n    private modalsUtilitiesService: ModalsUtilitiesService,\r\n    @Inject(DOCUMENT) private document: Document\r\n  ) {\r\n    this.isViewerLoaded = false;\r\n    this.editing = false;\r\n    this.subscriptions = new Subscription();\r\n    this.dragStarted = false;\r\n    this.dropEnabled = false;\r\n    this.documentLocked = true;\r\n  }\r\n\r\n  ngOnInit() {\r\n    this.fieldDocumentName = new FieldDefinition({\r\n      type: MetaDataType.Text,\r\n      required: false,\r\n      label: '',\r\n    });\r\n\r\n    this.lastDocumentName = this.doc.filename;\r\n\r\n    this.subscriptions.add(this.documentLockingService.lockStatusChanged.subscribe(this.lockStatusChanged));\r\n\r\n    this.isGridView = this.documentListStyleService.getStyle() === DocumentListStyle.Grid;\r\n    this.updateFieldsDisplayMode();\r\n\r\n    this.subscriptions.add(this.indexingService.onInit.subscribe(() => (this.isViewerLoaded = true)));\r\n    this.subscriptions.add(this.actionService.onActivateAction.subscribe(this.invokeAction));\r\n\r\n    this.documentLoaded.emit();\r\n\r\n    this.renderer.listen(this.docWrapper.nativeElement, 'contextmenu', (event) => {\r\n      if (!this.isDocumentSelected) {\r\n        this.selectDocument();\r\n      }\r\n\r\n      this.contextMenu.open(event, null, null, this.getDocumentContextMenuActions());\r\n    });\r\n\r\n    this.subscriptions.add(\r\n      this.indexingService.onChangeCurrentFieldValue.subscribe((valueObj: ValueObj) => {\r\n        if (this.folderItem.workItem.id !== valueObj.updateFieldData.context.id) return;\r\n\r\n        if (valueObj.panel !== IndexingPanels.LineItemIndexing) {\r\n          this.setMetaDataValueAndLocation(valueObj);\r\n        }\r\n\r\n        if (this.isGridView && valueObj.panel === this.DocumentGridPanel && this.selected) {\r\n          if (this.selectedCellIndex === this.FILENAME_CELL_INDEX) {\r\n            this.onFilenameBlur(valueObj.updateFieldData.value);\r\n          } else {\r\n            const mdd = this.stepMetadataDefinitions[this.selectedCellIndex];\r\n            if (mdd.type === MetaDataType.Expression) {\r\n              this.moveToNextCell();\r\n              return;\r\n            }\r\n\r\n            this.checkValues(valueObj.updateFieldData.value, mdd, this.selectedCellIndex);\r\n            this.fieldsValues[mdd.name] = this.getFieldValue(mdd);\r\n          }\r\n\r\n          this.cdr.detectChanges();\r\n          this.moveToNextCell();\r\n        }\r\n      })\r\n    );\r\n\r\n    this.subscriptions.add(\r\n      this.captureUpdate.onChangeDocument.subscribe((doc) => {\r\n        this.documentLocked = true; // assume positive locking cause we screw up focus otherwise\r\n        this.selected = doc && doc.id === this.doc.id;\r\n        if (this.selected && this.isGridView) {\r\n          const valuesWithValidLocation: Array<ValueLocation> = [];\r\n\r\n          this.stepMetadataDefinitions.forEach((field) => {\r\n            const fieldId = field.id;\r\n            const md = this.getWorkItemMetadata(field.name) as MetaData;\r\n            if (md && md.location && md.location.valid) {\r\n              const location = md.location;\r\n              const validity = md.validity;\r\n              valuesWithValidLocation.push({ fieldId, location, validity });\r\n            }\r\n          });\r\n\r\n          this.captureUpdate.hasValuesWithValidLocation(valuesWithValidLocation);\r\n\r\n          this.delay.execute(() => {\r\n            if (!this.selectedCellIndex) {\r\n              const lastTouchedField = this.getLastTouchedField();\r\n              this.selectedCellIndex = lastTouchedField !== null ? lastTouchedField : -1;\r\n            }\r\n\r\n            this.updateCellUI(this.selectedCellIndex, true);\r\n          }, 0);\r\n        } else {\r\n          this.selectedCellIndex = this.FILENAME_CELL_INDEX;\r\n        }\r\n      })\r\n    );\r\n\r\n    this.subscriptions.add(\r\n      this.indexingService.onPointAndClickInitialized.subscribe(() => {\r\n        if (this.isGridView && this.selected) {\r\n          this.emitCurrentCellChange(this.getCurrentFieldName());\r\n        }\r\n      })\r\n    );\r\n\r\n    this.subscriptions.add(\r\n      this.documentListStyleService.onChangeDocumentListStyle.subscribe((style: DocumentListStyle) => {\r\n        this.isGridView = style === DocumentListStyle.Grid;\r\n        if (this.isGridView) this.delay.execute(this.setGridCellsStyles, 0);\r\n        this.updateFieldsValues();\r\n        this.updateFieldsDisplayMode();\r\n        this.cdr.detectChanges();\r\n      })\r\n    );\r\n\r\n    this.subscriptions.add(\r\n      this.folderViewEvents.onUpdateItem\r\n        .pipe(filter((a) => a.workItem.id == this.folderItem.workItem.id))\r\n        .subscribe((folderItem) => {\r\n          this.folderItem = folderItem;\r\n          this.overallValidity = folderItem.workItem.getOverallValidity(this.getCurrentWorkflowStep(), this.userState);\r\n        })\r\n    );\r\n\r\n    this.onChangedSelectedItems();\r\n    this.subscriptions.add(this.selectedItemsService.onChangeSelectedItems.subscribe(this.onChangedSelectedItems));\r\n\r\n    this.subscriptions.add(this.dragDropService.onElementDragStarted.subscribe(this.elementDragStarted));\r\n\r\n    this.subscriptions.add(\r\n      this.dragDropService.onElementDragEnded.subscribe(() => {\r\n        this.dragStarted = false;\r\n      })\r\n    );\r\n\r\n    this.overallValidity = this.folderItem.workItem.getOverallValidity(this.getCurrentWorkflowStep(), this.userState);\r\n\r\n    const ws: WorkflowStep = this.capture.getWorkflowStepById(this.folderItem.workItem.workflowStepId);\r\n    if (ws) {\r\n      if (ws.hasCapability(Capabilities.deleteDocument)) {\r\n        this.canDeleteDocument = true;\r\n      }\r\n\r\n      if (ws.hasCapability(Capabilities.allowCaptureReimportPage)) {\r\n        this.canReplaceDocument = true;\r\n      }\r\n\r\n      if (ws.hasCapability(Capabilities.allowCaptureRescanPage)) {\r\n        this.canRescanDocument = true;\r\n      }\r\n    }\r\n\r\n    this.canManageWorkitem = this.userState.hasRolePermission(RolePermissions.WORKITEM_MANAGE);\r\n\r\n    this.subscriptions.add(\r\n      this.captureUpdate.onWorkitemMetadataUpdated.subscribe((metadataCollection: MetaDataCollection) => {\r\n        this.updateFieldsValues();\r\n      })\r\n    );\r\n\r\n    this.updateFieldsValues();\r\n\r\n    this.subscriptions.add(\r\n      this.captureUpdate.onChangeOutcomeButtons.subscribe((outcomes) => {\r\n        this.outcomes = outcomes;\r\n        this.detectChanges();\r\n      })\r\n    );\r\n  }\r\n\r\n  getLastTouchedField() {\r\n    const lastTouchedFieldId = this.documentLastTouchedService.getLastTouchedField();\r\n    const lastTouchedDocumentId = this.documentLastTouchedService.getLastTouchedDocumentId();\r\n\r\n    if (lastTouchedFieldId && lastTouchedDocumentId && lastTouchedDocumentId === this.doc.id) {\r\n      this.documentLastTouchedService.clearLastTouchedField();\r\n      this.documentLastTouchedService.clearLastTouchedDocumentId();\r\n\r\n      return this.stepMetadataDefinitions.findIndex((mdd) => mdd.id === lastTouchedFieldId);\r\n    }\r\n\r\n    return null;\r\n  }\r\n\r\n  lockStatusChanged = (ls: LockStatus): void => {\r\n    if (!this.folderItem || !this.folderItem.workItem) return;\r\n\r\n    if (ls.id == this.folderItem.workItem.id) {\r\n      this.documentLocked = ls.locked && ls.lockedByUserId == this.userStateService.user.id && !ls.expired();\r\n    }\r\n\r\n    this.cdr.detectChanges();\r\n  };\r\n\r\n  getDocumentContextMenuActions = (): Array<FolderTreeAction> => {\r\n    const actions: Array<FolderTreeAction> = [];\r\n    if (!this.isGridView && this.oneItemSelected) {\r\n      actions.push({\r\n        name: this.translate.instant('document-actions.rename'),\r\n        action: () => {\r\n          this.editDocumentName();\r\n        },\r\n        disabled: !this.documentLocked,\r\n      });\r\n    }\r\n\r\n    if (this.canDeleteDocument) {\r\n      actions.push({\r\n        name: this.translate.instant('document-actions.delete'),\r\n        action: () => {\r\n          this.deleteSelectedItems();\r\n        },\r\n        disabled: !this.documentLocked && !this.multipleSelectedItems,\r\n      });\r\n    }\r\n\r\n    if (this.canReplaceDocument && this.oneItemSelected) {\r\n      actions.push({\r\n        name: this.translate.instant('document-actions.replace-document'),\r\n        action: () => {\r\n          this.replace();\r\n        },\r\n        disabled: !this.documentLocked,\r\n      });\r\n    }\r\n\r\n    if (this.canRescanDocument && this.oneItemSelected) {\r\n      actions.push({\r\n        name: this.translate.instant('document-actions.rescan-document'),\r\n        action: () => {\r\n          this.rescan();\r\n        },\r\n        disabled: !this.documentLocked,\r\n      });\r\n    }\r\n\r\n    if (this.canManageWorkitem && this.oneItemSelected) {\r\n      actions.push({\r\n        name: this.translate.instant('document-actions.properties'),\r\n        action: () => {\r\n          this.showWorkitemProperties();\r\n        },\r\n      });\r\n    }\r\n\r\n    this.outcomes.forEach((outcome: IOutcome) => {\r\n      if (outcome.enabled) {\r\n        actions.push({\r\n          name: outcome.label,\r\n          action: () => {\r\n            this.capture.executeOutcome(outcome);\r\n          },\r\n          disabled: !this.documentLocked || !this.isDocumentSelected,\r\n        });\r\n      }\r\n    });\r\n\r\n    return actions;\r\n  };\r\n\r\n  onChangedSelectedItems = () => {\r\n    this.oneItemSelected = this.selectedItemsService.isOneItemSelected();\r\n    this.isDocumentSelected = this.selectedItemsService.isItemSelected(\r\n      this.folderItem.workItem.id,\r\n      this.folderItem.workItem.workflowStepId\r\n    );\r\n    this.multipleSelectedItems = this.selectedItemsService.areMultipleItemsSelected();\r\n  };\r\n\r\n  elementDragStarted = () => {\r\n    if (this.isDocumentSelected) {\r\n      this.dragStarted = true;\r\n\r\n      if (!this.dragDropService.isItemDragged(this.folderItem.workItem.id) && this.multipleSelectedItems) {\r\n        const dragData: DragData = {\r\n          element: this.folderItem.workItem,\r\n          elementParentId: this.parentFolderId,\r\n          elementParentStepId: this.folderItem.workItem.workflowStepId,\r\n          elementType: CaptureConstants.document,\r\n          document: this.doc,\r\n        };\r\n        this.dragDropService.pushDragData(dragData);\r\n      }\r\n    }\r\n  };\r\n\r\n  ngAfterViewInit() {\r\n    this.setGridCellsStyles();\r\n    this.focusLastTouchedField();\r\n  }\r\n\r\n  setGridCellsStyles = () => {\r\n    const headerCells = (this.document.getElementById('grid-header-row') as HTMLTableRowElement).children;\r\n    const dataCells = (this.document.getElementById('grid-data-row') as HTMLTableRowElement).children;\r\n\r\n    for (let i = 0; i < headerCells.length - 1; i++) {\r\n      const width = headerCells.item(i).getBoundingClientRect().width.toFixed(2);\r\n      (dataCells.item(i) as HTMLElement).style.width = width + 'px';\r\n      (headerCells.item(i) as HTMLElement).style.width = width + 'px';\r\n    }\r\n  };\r\n\r\n  focusLastTouchedField() {\r\n    if (!this.isGridView) return;\r\n\r\n    const lastTouchedField = this.getLastTouchedField();\r\n    if (lastTouchedField === null) return;\r\n\r\n    this.delay.execute(() => {\r\n      this.updateCellUI(lastTouchedField, false);\r\n    }, 100);\r\n  }\r\n\r\n  updateFieldsValues() {\r\n    if (!this.isGridView) return;\r\n\r\n    this.stepMetadataDefinitions.forEach((mdd) => {\r\n      this.fieldsValues[mdd.name] = this.getFieldValue(mdd);\r\n    });\r\n  }\r\n\r\n  updateFieldsDisplayMode() {\r\n    this.stepMetadataDefinitionsFields.forEach(\r\n      (x) => (x.displayMode = this.isGridView ? FieldDisplayMode.grid : FieldDisplayMode.vertical)\r\n    );\r\n  }\r\n\r\n  invokeAction = (event: ActionEvent): void => {\r\n    if (!this.selected) return;\r\n\r\n    if (event.action === Action.EditSelection) {\r\n      if (!this.documentLocked) return;\r\n\r\n      this.editDocumentName();\r\n    } else if (event.action === Action.DeleteSelectedItem || event.action === Action.CtrlDeleteSelectedItem) {\r\n      if (!this.documentLocked || !this.canDeleteDocument || this.modalsUtilitiesService.isAnyModalOpened()) return;\r\n\r\n      this.deleteSelectedItems();\r\n    }\r\n  };\r\n\r\n  getCurrentWorkflowStep(): InteractiveWorkflowStep {\r\n    return this.capture.getWorkflowStepById(this.folderItem.workItem.workflowStepId) as InteractiveWorkflowStep;\r\n  }\r\n\r\n  ngOnDestroy() {\r\n    this.subscriptions.unsubscribe();\r\n  }\r\n\r\n  selectDocument(event?: MouseEvent): void {\r\n    if (event) {\r\n      const target = event.target as HTMLElement;\r\n      if (target && target.className === 'icomoon-more') return;\r\n    }\r\n\r\n    this.capture.selectDocument(\r\n      this.doc,\r\n      this.folderItem.workItem,\r\n      this.parentFolderId,\r\n      null,\r\n      null,\r\n      event?.ctrlKey || false\r\n    );\r\n  }\r\n\r\n  get canDragDocuments(): boolean {\r\n    const ws = this.capture.getWorkflowStepById(this.folderItem.workItem.workflowStepId);\r\n\r\n    return !this.editing && ws.hasCapability(Capabilities.allowDropDocument);\r\n  }\r\n\r\n  isFilenameFocused() {\r\n    return this.selected && this.selectedCellIndex === this.FILENAME_CELL_INDEX;\r\n  }\r\n\r\n  edit(e): void {\r\n    e.stopPropagation();\r\n    this.hide();\r\n    this.editDocumentName();\r\n  }\r\n\r\n  editDocumentName = (): void => {\r\n    this.editing = true;\r\n    this.docName.nativeElement.removeAttribute('readonly');\r\n    this.docName.nativeElement.removeAttribute('hidden');\r\n    this.docName.nativeElement.value = '';\r\n\r\n    this.delay.execute(() => {\r\n      const strLength = this.docName.nativeElement.value.length;\r\n      if (this.docName.nativeElement.setSelectionRange != undefined) {\r\n        this.docName.nativeElement.setSelectionRange(strLength, strLength);\r\n      }\r\n\r\n      this.docName.nativeElement.value = this.doc.filename;\r\n      this.docName.nativeElement.focus();\r\n    }, 10);\r\n\r\n    this.cdr.detectChanges();\r\n  };\r\n\r\n  onBlur() {\r\n    setTimeout(() => {\r\n      if (this.editing) {\r\n        this.cancel();\r\n      }\r\n    }, 200);\r\n  }\r\n\r\n  onClick(e: any) {\r\n    if (!this.editing) {\r\n      this.docName.nativeElement.blur();\r\n      this.actionService.activateAction(new ActionEvent(Action.SetFocusTreePanel));\r\n    } else {\r\n      e.stopPropagation();\r\n    }\r\n  }\r\n\r\n  save(e?: Event): void {\r\n    e?.stopPropagation();\r\n\r\n    this.editing = false;\r\n    this.docName.nativeElement.setAttribute('readonly', 'readonly');\r\n    this.docName.nativeElement.setAttribute('hidden', 'hidden');\r\n\r\n    this.lastDocumentName = this.doc.filename;\r\n    this.doc.filename = this.docName.nativeElement.value;\r\n\r\n    this.capture\r\n      .editDocumentName(this.doc.id, this.doc.fileType, this.docName.nativeElement.value, this.folderItem.workItem.id)\r\n      .then((newDocument: DocumentType) => {\r\n        this.doc = newDocument;\r\n        this.lastDocumentName = this.doc.filename;\r\n\r\n        if (this.doc.id === this.capture.getCurrentDocument().id) {\r\n          this.capture.updateDocumentName(this.doc.filename);\r\n        }\r\n\r\n        this.actionService.activateAction(new ActionEvent(Action.SetFocusTreePanel));\r\n      })\r\n      .catch((err: any) => this.cancel());\r\n  }\r\n\r\n  cancel(e?: Event): void {\r\n    e?.stopPropagation();\r\n\r\n    this.editing = false;\r\n    this.docName.nativeElement.setAttribute('readonly', 'readonly');\r\n    this.docName.nativeElement.setAttribute('hidden', 'hidden');\r\n    this.docName.nativeElement.value = this.doc.filename;\r\n    this.docName.nativeElement.blur();\r\n\r\n    this.doc.filename = this.lastDocumentName;\r\n\r\n    this.cdr.detectChanges();\r\n  }\r\n\r\n  checkValidity(e: KeyboardEvent) {\r\n    if (!e) return;\r\n\r\n    if (e.key === Key.Escape) {\r\n      this.cancel();\r\n      this.docName.nativeElement.blur();\r\n    } else if (e.key === Key.Enter) {\r\n      this.save();\r\n      this.docName.nativeElement.blur();\r\n    }\r\n  }\r\n\r\n  onDrop(dragData: DragData) {\r\n    if (dragData instanceof DragEvent || !this.dropEnabled) return;\r\n\r\n    if (dragData.elementType === CaptureConstants.page) this.dropPageIntoDocument(dragData);\r\n\r\n    if (dragData.elementType === CaptureConstants.document) this.dropWorkItemsIntoDocument();\r\n\r\n    this.dropEnabled = false;\r\n  }\r\n\r\n  dropPageIntoDocument(dragData: DragData) {\r\n    this.onToggleSpinner(true);\r\n\r\n    this.capture\r\n      .handleDragDropPageIntoDocument(dragData, this.folderItem.workItem, this.doc)\r\n      .then(() => {\r\n        this.onToggleSpinner(false);\r\n      })\r\n      .catch(() => {\r\n        this.onToggleSpinner(false);\r\n      });\r\n  }\r\n\r\n  dropWorkItemsIntoDocument() {\r\n    this.onToggleSpinner(true);\r\n\r\n    this.capture\r\n      .handleDragDropWorkItemsIntoDocument(\r\n        this.dragDropService.dragDataArray,\r\n        this.folderItem.workItem,\r\n        this.doc,\r\n        this.parentFolderId\r\n      )\r\n      .then(() => {\r\n        this.dragDropService.clearDragData();\r\n        this.onToggleSpinner(false);\r\n      })\r\n      .catch(() => {\r\n        this.dragDropService.clearDragData();\r\n        this.onToggleSpinner(false);\r\n      });\r\n  }\r\n\r\n  onDragOver(dragData: DragData) {\r\n    if (\r\n      dragData &&\r\n      dragData.elementParentStepId === this.folderItem.workItem.workflowStepId &&\r\n      (this.isPageDragged(dragData) || this.isDocumentDragged(dragData))\r\n    ) {\r\n      this.dropEnabled = true;\r\n    }\r\n  }\r\n\r\n  isPageDragged(dragData: DragData): boolean {\r\n    return dragData.elementType === CaptureConstants.page && dragData.elementParentId !== this.doc.id;\r\n  }\r\n\r\n  isDocumentDragged(dragData: DragData): boolean {\r\n    return (\r\n      dragData.elementType === CaptureConstants.document &&\r\n      !this.dragDropService.isItemDragged(this.folderItem.workItem.id)\r\n    );\r\n  }\r\n\r\n  onDragLeave(dragData: DragData) {\r\n    this.dropEnabled = false;\r\n  }\r\n\r\n  getPageCountText = (): string => {\r\n    if (!this.doc) return '';\r\n\r\n    return Filename.getPageCountText(this.doc.pageCount, this.translate);\r\n  };\r\n\r\n  onToggleSpinner(state: boolean) {\r\n    if (state) {\r\n      this.translate\r\n        .get('Document_Capture.UpdatingDocument')\r\n        .subscribe((value) => this.spinnerState.show(value, document.getElementById('app-spinner-panel')));\r\n    } else {\r\n      this.spinnerState.hide();\r\n    }\r\n  }\r\n\r\n  onMouseEnter(isMenu?: boolean) {\r\n    if (isMenu) {\r\n      this.hoverOverMenu = true;\r\n    } else {\r\n      this.hoverOver = true;\r\n    }\r\n\r\n    this.cdr.detectChanges();\r\n  }\r\n\r\n  onMouseLeave(isMenu?: boolean) {\r\n    this.delay.execute(() => {\r\n      if (isMenu) {\r\n        this.hoverOverMenu = false;\r\n      } else {\r\n        this.hoverOver = false;\r\n      }\r\n\r\n      this.cdr.detectChanges();\r\n    }, 10);\r\n  }\r\n\r\n  onClickMenuButton(event: MouseEvent, dropdown: BsDropdownDirective) {\r\n    if (!this.multipleSelectedItems || !this.isDocumentSelected) {\r\n      this.capture.selectDocument(this.doc, this.folderItem.workItem, this.parentFolderId, null, null, event.ctrlKey);\r\n    }\r\n\r\n    this.contextMenu.open(event, null, null, this.getDocumentContextMenuActions());\r\n  }\r\n\r\n  replace() {\r\n    this.hide();\r\n    const result = this.capture.findFolder(this.parentFolderId).findDocument(this.doc.id);\r\n    this.actionService.activateAction({ action: Action.ReimportDocument, documentResult: result });\r\n  }\r\n\r\n  rescan() {\r\n    this.hide();\r\n    const result = this.capture.findFolder(this.parentFolderId).findDocument(this.doc.id);\r\n    this.actionService.activateAction({ action: Action.RescanDocument, documentResult: result });\r\n  }\r\n\r\n  hide() {\r\n    this.hoverOver = false;\r\n    this.hoverOverMenu = false;\r\n  }\r\n\r\n  onHidden() {\r\n    this.showMenu = false;\r\n  }\r\n\r\n  getFieldValue(mdd: MetaDataDefinition): string {\r\n    const metadata = this.getWorkItemMetadata(mdd.name);\r\n\r\n    if (!metadata || metadata.valueType !== MetaDataValueType.String) {\r\n      return '';\r\n    }\r\n\r\n    if (!mdd.stickyField) return <string>metadata.value;\r\n\r\n    if (metadata.value) {\r\n      this.stickyService.setStickyField(mdd.name, <string>metadata.value);\r\n      return <string>metadata.value;\r\n    }\r\n\r\n    const stickyValue = this.stickyService.getStickyField(mdd.name);\r\n    if (!stickyValue) return '';\r\n\r\n    this.capture.validateAndSaveIndexingValue(stickyValue, mdd, this.folderItem.workItem);\r\n    return stickyValue;\r\n  }\r\n\r\n  getValidity(mdd: MetaDataDefinition) {\r\n    const metadata = this.getWorkItemMetadata(mdd.name);\r\n    if (metadata) {\r\n      return metadata.validity || MetaDataValidity.unknown;\r\n    }\r\n  }\r\n\r\n  onFocusCell(cellIndex: number, mdd?: MetaDataDefinition) {\r\n    this.updateCellUI(cellIndex, true);\r\n    this.scrollToCell(cellIndex + 1);\r\n  }\r\n\r\n  onFocusFilenameCell(cellIndex: number) {\r\n    this.updateCellUI(cellIndex, true);\r\n    this.scrollToCell(0);\r\n  }\r\n\r\n  moveToNextCell() {\r\n    if (this.selectedCellIndex === this.stepMetadataDefinitions.length - 1) {\r\n      this.captureUpdate.selectNextDocument();\r\n    } else {\r\n      this.selectedCellIndex += 1;\r\n      this.delay.execute(() => {\r\n        this.updateCellUI(this.selectedCellIndex, true);\r\n      }, 0);\r\n    }\r\n  }\r\n\r\n  moveToPreviousCell() {\r\n    if (this.selectedCellIndex > this.FILENAME_CELL_INDEX) {\r\n      this.selectedCellIndex -= 1;\r\n      this.updateCellUI(this.selectedCellIndex, true);\r\n    }\r\n  }\r\n\r\n  emitCurrentCellChange(fieldLabelText: string) {\r\n    this.indexingService.changeCurrentField(this.DocumentGridPanel, fieldLabelText);\r\n  }\r\n\r\n  onCellBlur(event: BlurEvent, mdd: MetaDataDefinition): void {\r\n    if (event.context == null) return;\r\n    if (event.mdd) mdd = event.mdd;\r\n\r\n    this.capture.validateAndSaveIndexingValue(event.value, mdd, event.context);\r\n\r\n    if (mdd.stickyField) {\r\n      this.stickyService.setStickyField(mdd.name, event.value);\r\n    }\r\n  }\r\n\r\n  onCellTab(event: BlurEvent, mdd: MetaDataDefinition, index: number) {\r\n    if (index === this.stepMetadataDefinitions.length - 1) {\r\n      this.onCellBlur(event, mdd);\r\n    }\r\n  }\r\n\r\n  onCellTabKey(event: Event) {\r\n    if (event) {\r\n      event.preventDefault();\r\n    }\r\n\r\n    this.moveToNextCell();\r\n  }\r\n\r\n  onCellShiftTabKey(event: Event) {\r\n    if (event) {\r\n      event.preventDefault();\r\n    }\r\n\r\n    this.moveToPreviousCell();\r\n  }\r\n\r\n  onFilenameBlur(value: string) {\r\n    this.saveFilename(value);\r\n  }\r\n\r\n  checkValues(value: any, mdd: MetaDataDefinition, itemIndex: number) {\r\n    if (!this.capture.getCurrentWorkItem()) {\r\n      return;\r\n    }\r\n\r\n    if (!this.folderItem) {\r\n      return;\r\n    }\r\n\r\n    const prevValue = this.getFieldValue(mdd);\r\n    if (value !== prevValue) {\r\n      this.capture.validateAndSaveIndexingValue(value, mdd, this.folderItem.workItem);\r\n\r\n      if (mdd.stickyField) {\r\n        this.stickyService.setStickyField(mdd.name, value);\r\n      }\r\n    }\r\n  }\r\n\r\n  getWorkItemMetadata(name: string) {\r\n    return this.folderItem.workItem.getMetaData(name);\r\n  }\r\n\r\n  updateCellUI(cellIndex: number, zoomIntoField: boolean) {\r\n    this.updateCellIndex(cellIndex);\r\n    this.zoomIntoViewerField(cellIndex, zoomIntoField);\r\n  }\r\n\r\n  zoomIntoViewerField(cellIndex: number, zoomIntoField: boolean) {\r\n    let zoomInFieldId = null;\r\n    if (zoomIntoField && cellIndex > this.FILENAME_CELL_INDEX) {\r\n      const md = this.stepMetadataDefinitions[cellIndex];\r\n      const metaData = this.getWorkItemMetadata(md.name);\r\n      if (metaData) {\r\n        const location = metaData.location;\r\n        if (location && location.valid) {\r\n          zoomInFieldId = md.id;\r\n        }\r\n      }\r\n    }\r\n\r\n    this.captureUpdate.zoomIntoValue(zoomInFieldId);\r\n    this.cdr.detectChanges();\r\n  }\r\n\r\n  updateCellIndex(cellIndex: number) {\r\n    this.selectedCellIndex = cellIndex;\r\n    this.emitCurrentCellChange(this.getCurrentFieldName());\r\n    this.documentLastTouchedService.setLastTouchedField(\r\n      cellIndex > this.FILENAME_CELL_INDEX ? this.stepMetadataDefinitions[cellIndex].id : null\r\n    );\r\n    this.documentLastTouchedService.setLastTouchedDocumentId(this.doc.id);\r\n    this.cdr.detectChanges();\r\n  }\r\n\r\n  getCurrentFieldName() {\r\n    return this.selectedCellIndex === this.FILENAME_CELL_INDEX\r\n      ? (this.translate.instant('folder.DocumentNameColumn') as string)\r\n      : this.stepMetadataDefinitions[this.selectedCellIndex]?.name;\r\n  }\r\n\r\n  onSaveLookupValues(event: SaveLookupsEvent, index: number) {\r\n    this.capture.updateMetadataValues(event.context, event.lookups);\r\n\r\n    if (event.move) {\r\n      if (event.forward) {\r\n        this.moveToNextCell();\r\n      } else {\r\n        this.moveToPreviousCell();\r\n      }\r\n    }\r\n\r\n    this.updateFieldsValues();\r\n    this.cdr.detectChanges();\r\n  }\r\n\r\n  onCellReturn(value: any, mdd: MetaDataDefinition) {\r\n    this.capture.validateAndSaveIndexingValue(value, mdd, this.folderItem.workItem);\r\n  }\r\n\r\n  onFilenameReturn(value: string) {\r\n    this.saveFilename(value);\r\n  }\r\n\r\n  saveFilename(value: any) {\r\n    if (value === this.doc.filename) return;\r\n\r\n    this.capture\r\n      .editDocumentName(this.doc.id, this.doc.fileType, value, this.folderItem.workItem.id)\r\n      .then((newDocument: DocumentType) => {\r\n        this.doc = newDocument;\r\n\r\n        if (this.doc.id === this.capture.getCurrentDocument().id) {\r\n          this.capture.updateDocumentName(this.doc.filename);\r\n        }\r\n      });\r\n  }\r\n\r\n  scrollToCell(cellIndex: number) {\r\n    const cellField = this.getCellElement(cellIndex);\r\n    if (!cellField) return;\r\n\r\n    const workflowPanel = $('#workflow-panel');\r\n    const cellElement = $(cellField.nativeElement);\r\n    const scrollLeft = workflowPanel.scrollLeft();\r\n    const panelWidth = workflowPanel.width();\r\n    const elementOffsetLeft = cellElement.offset().left;\r\n    const elementLeft = cellField.nativeElement.getBoundingClientRect().left;\r\n    const elementRight = elementOffsetLeft + cellElement.width();\r\n    const scrollOffset = 72;\r\n    let cellOffset: number = elementRight - scrollOffset - panelWidth;\r\n\r\n    const leftOffset = elementLeft - scrollOffset;\r\n\r\n    if (cellIndex === 0) {\r\n      workflowPanel.scrollLeft(0);\r\n    } else if (leftOffset < 0 || cellOffset > 0) {\r\n      if (cellIndex === this.fieldElements.length - 1) {\r\n        const menuAreaWidth: number = 30;\r\n        cellOffset += menuAreaWidth;\r\n      }\r\n\r\n      workflowPanel.scrollLeft(scrollLeft + cellOffset);\r\n    }\r\n  }\r\n\r\n  getCellElement(cellIndex: number) {\r\n    if (!this.fieldElements || cellIndex >= this.fieldElements.length) return null;\r\n\r\n    const fields = this.fieldElements.toArray();\r\n    if (!fields || fields.length === 0) return null;\r\n\r\n    return fields[cellIndex];\r\n  }\r\n\r\n  onValueChanged(value: any, mdd: MetaDataDefinition) {\r\n    this.fieldsValues[mdd.name] = value;\r\n  }\r\n\r\n  deleteSelectedItems = (): void => {\r\n    this.outcomesService.confirmDeleteSelectedItems(this.confirmedDeleteSelectedItems);\r\n  };\r\n\r\n  confirmedDeleteSelectedItems = (data: any) => {\r\n    this.capture.transitionSelectedItems(data.id);\r\n  };\r\n\r\n  onDragStarted() {\r\n    this.dragStarted = true;\r\n    this.dragDropService.elementDragStarted();\r\n  }\r\n\r\n  onDragEnded() {\r\n    this.dragStarted = false;\r\n    this.dragDropService.elementDragEnded();\r\n  }\r\n\r\n  showWorkitemProperties = () => {\r\n    this.ngxSmartModalService.getModal('workitemProperties').open();\r\n  };\r\n\r\n  handleAction(action: Function) {\r\n    this.showMenu = false;\r\n    action();\r\n  }\r\n\r\n  setMetaDataValueAndLocation(valueObj: ValueObj) {\r\n    const mdd = this.userStateService.user.metaData.find((x) => x.name == this.indexingService.getCurrentFieldName());\r\n\r\n    if (mdd) {\r\n      this.capture\r\n        .getCurrentWorkItem()\r\n        .setMetaData(\r\n          mdd.name,\r\n          valueObj.updateFieldData.value,\r\n          MetaDataValidity.valid,\r\n          valueObj.updateFieldData.location\r\n        );\r\n\r\n      this.capture.validateAndSaveIndexingValue(\r\n        valueObj.updateFieldData.value,\r\n        mdd as MetaDataDefinition,\r\n        this.capture.getCurrentWorkItem(),\r\n        true\r\n      );\r\n    }\r\n  }\r\n\r\n  detectChanges = (): void => {\r\n    if (!this.cdr['destroyed']) {\r\n      this.cdr.detectChanges();\r\n    }\r\n  };\r\n}\r\n","<div\r\n  class=\"_document pl-0 d-flex justify-content-evently align-items-center\"\r\n  [ngClass]=\"{ dragging: dragStarted, droppable: dropEnabled }\"\r\n  #docWrapper\r\n  (click)=\"selectDocument($event)\"\r\n  appDragNDrop\r\n  [isDraggable]=\"canDragDocuments\"\r\n  [isDroppable]=\"true\"\r\n  [element]=\"folderItem.workItem\"\r\n  [elementParentId]=\"parentFolderId\"\r\n  [sortableParentStepId]=\"folderItem.workItem.workflowStepId\"\r\n  [elementType]=\"documentString\"\r\n  [document]=\"this.doc\"\r\n  (dragStarted)=\"onDragStarted()\"\r\n  (dragEnd)=\"onDragEnded()\"\r\n  (drop)=\"onDrop($event)\"\r\n  (dragOver)=\"onDragOver($event)\"\r\n  (dragLeave)=\"onDragLeave($event)\"\r\n  (mouseleave)=\"onMouseLeave()\"\r\n  (mouseenter)=\"onMouseEnter()\"\r\n>\r\n  <span class=\"document-gripper-space\" [ngClass]=\"{ 'icomoon-grip-small grip drag-handler': canDragDocuments }\"></span>\r\n  <span class=\"validation-icon-color\"></span>\r\n  <i *ngIf=\"overallValidity === metaDataValidity.valid\" class=\"validation-icon valid icon-checkmark\"></i>\r\n  <i *ngIf=\"overallValidity === metaDataValidity.notValid\" class=\"validation-icon not-valid icon-warning\"></i>\r\n  <i *ngIf=\"overallValidity === metaDataValidity.unknown\" class=\"validation-icon unknown icon-question\"></i>\r\n  <i *ngIf=\"overallValidity === metaDataValidity.suspicious\" class=\"validation-icon suspicious icon-warning\"></i>\r\n  <span class=\"icon-file-empty file-icon ml-1\"></span>\r\n\r\n  <div class=\"doc-section col\" [class.d-block]=\"isGridView\">\r\n    <input\r\n      *ngIf=\"!isGridView\"\r\n      class=\"doc-name text-truncate\"\r\n      [ngModel]=\"doc.filename\"\r\n      [ngModelOptions]=\"{ standalone: true }\"\r\n      (keyup)=\"checkValidity($event)\"\r\n      (blur)=\"onBlur()\"\r\n      (click)=\"onClick($event)\"\r\n      maxlength=\"256\"\r\n      readonly\r\n      hidden\r\n      #docName\r\n    />\r\n\r\n    <div *ngIf=\"isGridView\" class=\"document-grid-row\">\r\n      <table>\r\n        <tr id=\"grid-data-row\">\r\n          <td>\r\n            <app-field\r\n              [field]=\"fieldDocumentName\"\r\n              [(value)]=\"doc.filename\"\r\n              class=\"document-grid-field-column\"\r\n              [focused]=\"selected && selectedCellIndex === -1\"\r\n              (focus)=\"onFocusFilenameCell(-1)\"\r\n              (blur)=\"onFilenameBlur($event)\"\r\n              (tabex)=\"onCellTab($event, null, -1)\"\r\n              (keydown.tab)=\"onCellTabKey($event)\"\r\n              (keydown.shift.tab)=\"onCellShiftTabKey($event)\"\r\n              (return)=\"onFilenameReturn($event)\"\r\n              [disabled]=\"selected && !documentLocked\"\r\n              #fieldCell\r\n            >\r\n            </app-field>\r\n          </td>\r\n\r\n          <td *ngFor=\"let mdd of stepMetadataDefinitions; let cellIndex = index\">\r\n            <app-field\r\n              [context]=\"folderItem.workItem\"\r\n              [field]=\"stepMetadataDefinitionsFields[cellIndex]\"\r\n              [value]=\"fieldsValues[mdd.name]\"\r\n              [validity]=\"getValidity(mdd)\"\r\n              class=\"document-grid-field-column\"\r\n              [focused]=\"selected && cellIndex === selectedCellIndex\"\r\n              [findMetaDataService]=\"userStateService\"\r\n              [metaDataCollection]=\"folderItem.workItem.metadata\"\r\n              (focus)=\"onFocusCell(cellIndex, mdd)\"\r\n              (blurex)=\"onCellBlur($event, mdd)\"\r\n              (tabex)=\"onCellTab($event, mdd, cellIndex)\"\r\n              (keydown.tab)=\"onCellTabKey($event)\"\r\n              (keydown.shift.tab)=\"onCellShiftTabKey($event)\"\r\n              (saveLookupValues)=\"onSaveLookupValues($event, cellIndex)\"\r\n              (return)=\"onCellReturn($event, mdd)\"\r\n              (valueChange)=\"onValueChanged($event, mdd)\"\r\n              [disabled]=\"selected && !documentLocked\"\r\n              #fieldCell\r\n            >\r\n            </app-field>\r\n          </td>\r\n        </tr>\r\n      </table>\r\n    </div>\r\n\r\n    <div class=\"doc-display text-truncate\" *ngIf=\"!editing && !isGridView\" [title]=\"doc.filename\">\r\n      {{ doc.filename }}\r\n    </div>\r\n    <div *ngIf=\"!editing && !isGridView\" class=\"doc-pages\">{{ getPageCountText() }}</div>\r\n  </div>\r\n\r\n  <div class=\"actions\" [ngClass]=\"{ 'document-grid-menu': isGridView }\">\r\n    <div #wrapper class=\"edit-delete\" *ngIf=\"!editing && (hoverOver || hoverOverMenu)\">\r\n      <div\r\n        class=\"btn-group\"\r\n        dropdown\r\n        container=\"body\"\r\n        #dropdown=\"bs-dropdown\"\r\n        (onHidden)=\"onHidden()\"\r\n        *ngIf=\"!isGridView || canReplaceDocument || canReplaceDocument\"\r\n      >\r\n        <button\r\n          id=\"button-basic\"\r\n          type=\"button\"\r\n          class=\"button-icon\"\r\n          (click)=\"onClickMenuButton($event, dropdown)\"\r\n          *ngIf=\"!(multipleSelectedItems && !canDeleteDocument)\"\r\n        >\r\n          <i class=\"icomoon-more\"></i>\r\n        </button>\r\n      </div>\r\n    </div>\r\n    <div class=\"save-cancel d-flex\" *ngIf=\"editing\" [title]=\"'document-actions.save' | translate\">\r\n      <button class=\"button-icon edit\" (click)=\"save($event)\">\r\n        <app-save-icon></app-save-icon>\r\n      </button>\r\n      <button class=\"button-icon remove\" (click)=\"cancel($event)\" [title]=\"'document-actions.cancel' | translate\">\r\n        <app-clear-icon></app-clear-icon>\r\n      </button>\r\n    </div>\r\n  </div>\r\n</div>\r\n","import {\r\n  AfterViewInit,\r\n  Component,\r\n  ElementRef,\r\n  OnDestroy,\r\n  OnInit,\r\n  Renderer2,\r\n  ViewChild,\r\n  ViewEncapsulation,\r\n} from '@angular/core';\r\n\r\nimport { TranslateService } from '@ngx-translate/core';\r\nimport { PerfectScrollbarDirective } from 'ngx-perfect-scrollbar-portable';\r\nimport { ToastrService } from 'ngx-toastr';\r\nimport { Subscription } from 'rxjs';\r\n\r\nimport { ContextMenuComponent, DelayService, Key, UserPreferencesService } from 'shared-code-lib';\r\nimport { Action, ActionEvent } from '../../../blocks/core/actions';\r\nimport { Log } from '../../../blocks/core/log';\r\nimport { ListHeaderOptions } from '../../../blocks/directives/list-header.directive';\r\nimport { FolderItem } from '../../../blocks/models/folder-item';\r\nimport { Workflow } from '../../../blocks/models/workflow';\r\nimport { WorkflowFolder } from '../../../blocks/models/workflow-folder';\r\nimport { ActionService } from '../../../blocks/services/action.service';\r\nimport { HydraApiService } from '../../../blocks/services/hydra-api.service';\r\nimport { DocumentListStyle } from '../capture-models';\r\nimport { CaptureUpdateService } from '../capture-services/capture-update.service';\r\nimport { DocumentCaptureService } from '../capture-services/document-capture.service';\r\nimport { DocumentListStyleService } from '../capture-services/document-list-style.service';\r\n\r\n@Component({\r\n  selector: 'app-documents-list',\r\n  templateUrl: './documents-list.component.html',\r\n  styleUrls: ['./documents-list.component.scss'],\r\n  encapsulation: ViewEncapsulation.None,\r\n})\r\nexport class DocumentsListComponent implements OnInit, AfterViewInit, OnDestroy {\r\n  @ViewChild('wrapper', { static: true }) wrapper: ElementRef;\r\n  @ViewChild('scrollbar', { static: true }) scrollbar?: PerfectScrollbarDirective;\r\n  @ViewChild('workflowPanel', { static: true }) panel: ElementRef;\r\n  @ViewChild('listHeader') listHeader: ElementRef;\r\n\r\n  private _currentWorkflow: Workflow;\r\n\r\n  get currentWorkflow() {\r\n    return this._currentWorkflow;\r\n  }\r\n\r\n  lastWorkFlowSelection: Workflow;\r\n  loadingFoldersInProgress: boolean;\r\n  folders: Array<WorkflowFolder>;\r\n  listHeaderDirectiveOpts: ListHeaderOptions;\r\n  subscriptions: Subscription;\r\n  documentListStyle: DocumentListStyle;\r\n  isGridView: boolean;\r\n  contextMenu: ContextMenuComponent;\r\n\r\n  readonly DocumentListStylePreference = 'DocumentListStylePreferenceId';\r\n\r\n  constructor(\r\n    public capture: DocumentCaptureService,\r\n    private captureUpdate: CaptureUpdateService,\r\n    private hydraApi: HydraApiService,\r\n    private translate: TranslateService,\r\n    private toastr: ToastrService,\r\n    private actionService: ActionService,\r\n    private delay: DelayService,\r\n    private documentListStyleService: DocumentListStyleService,\r\n    private renderer: Renderer2,\r\n    private userPreferencesService: UserPreferencesService\r\n  ) {\r\n    this.subscriptions = new Subscription();\r\n  }\r\n\r\n  ngOnInit() {\r\n    Log.enter('DocumentsListComponent.ngOnInit');\r\n\r\n    this.renderer.listen(this.wrapper.nativeElement, 'contextmenu', (event) => {\r\n      event.preventDefault();\r\n    });\r\n\r\n    try {\r\n      this.isGridView = this.documentListStyleService.getStyle() === DocumentListStyle.Grid;\r\n      this.subscriptions.add(\r\n        this.captureUpdate.onChangeWorkflow.subscribe((workflow) => {\r\n          const el = document.querySelector('#workflow-panel');\r\n          if (el) {\r\n            el.scrollTop = 0;\r\n          }\r\n\r\n          if (!this.loadingFoldersInProgress) {\r\n            this._currentWorkflow = workflow;\r\n            this.loadFolders();\r\n          } else {\r\n            this.lastWorkFlowSelection = workflow;\r\n          }\r\n        })\r\n      );\r\n\r\n      this.subscriptions.add(\r\n        this.captureUpdate.onSelectNextDocument.subscribe(() => {\r\n          this.selectNextDocument();\r\n        })\r\n      );\r\n\r\n      this.subscriptions.add(\r\n        this.captureUpdate.onScrollToDocument.subscribe((id: string) => {\r\n          const documentElementID = `#doc-${id}`;\r\n          const documentElement = document.querySelector(documentElementID);\r\n\r\n          this.scrollbar.update();\r\n          this.delay.execute(() => {\r\n            this.scrollbar.scrollToElement(documentElementID, -100);\r\n          }, 50);\r\n        })\r\n      );\r\n\r\n      this.subscriptions.add(this.actionService.onActivateAction.subscribe(this.invokeAction));\r\n      this.subscriptions.add(\r\n        this.captureUpdate.onChangeFolder.subscribe((folder) => {\r\n          if (folder) {\r\n            this.focusPanel();\r\n          }\r\n        })\r\n      );\r\n\r\n      this.subscriptions.add(this.scrollbar.psScrollDown.subscribe(() => this.contextMenu.close()));\r\n      this.subscriptions.add(this.scrollbar.psScrollUp.subscribe(() => this.contextMenu.close()));\r\n\r\n      this.actionService.activateAction(new ActionEvent(Action.SetFocusTreePanel));\r\n    } catch (e) {\r\n      Log.error('DocumentsListComponent.ngOnInit', e);\r\n    }\r\n  }\r\n\r\n  ngAfterViewInit() {\r\n    this.listHeaderDirectiveOpts = {\r\n      scrollbar: this.scrollbar,\r\n      listWrapper: this.panel,\r\n      disabled: this.documentListStyleService.getStyle() === DocumentListStyle.Tree,\r\n    };\r\n  }\r\n\r\n  invokeAction = (event: ActionEvent): void => {\r\n    if (event.action === Action.SetFocusTreePanel) {\r\n      this.focusPanel();\r\n      return;\r\n    }\r\n  };\r\n\r\n  ngOnDestroy() {\r\n    this.subscriptions.unsubscribe();\r\n  }\r\n\r\n  onRenderContextMenu(menu: ContextMenuComponent): void {\r\n    this.contextMenu = menu;\r\n  }\r\n\r\n  loadFolders(): void {\r\n    if (this._currentWorkflow) {\r\n      this.folders = null;\r\n      this.loadingFoldersInProgress = true;\r\n      this.hydraApi.getWorkflowFolders(\r\n        this._currentWorkflow.id,\r\n        this.loadFolderViewCallback,\r\n        this.loadFolderViewFailed\r\n      );\r\n    }\r\n  }\r\n\r\n  loadFolderViewCallback = (folders: Array<WorkflowFolder>) => {\r\n    if (this.lastWorkFlowSelection && this.lastWorkFlowSelection.id !== this._currentWorkflow.id) {\r\n      this._currentWorkflow = this.lastWorkFlowSelection;\r\n      this.loadFolders();\r\n    } else {\r\n      this.folders = folders;\r\n      this.capture.setWorkflowFirstFolder(this.folders[0]);\r\n      this.loadingFoldersInProgress = false;\r\n      this.lastWorkFlowSelection = null;\r\n    }\r\n  };\r\n\r\n  loadFolderViewFailed = () => {\r\n    this.toastr.error(this.translate.instant('Common.LoadingDataError'));\r\n  };\r\n\r\n  onScroll(position: number) {\r\n    this.scrollbar.scrollToY(position, 100);\r\n  }\r\n\r\n  selectNextDocument = (): void => {\r\n    const items = new Array<any>();\r\n\r\n    this.getFlatList(items, this.folders);\r\n    const index = this.getCurrentSelection(items);\r\n    if (index === -1) {\r\n      return;\r\n    }\r\n\r\n    for (let next = index + 1; next < items.length; next++) {\r\n      if (items[next] instanceof FolderItem) {\r\n        const folderItem = items[next] as FolderItem;\r\n        this.capture.selectDocument(folderItem.documents[0], folderItem.workItem, folderItem.parentId);\r\n        return;\r\n      }\r\n    }\r\n\r\n    for (let next = 0; next < index && next < items.length; next++) {\r\n      if (items[next] instanceof FolderItem) {\r\n        const folderItem = items[next] as FolderItem;\r\n        this.capture.selectDocument(folderItem.documents[0], folderItem.workItem, folderItem.parentId);\r\n        return;\r\n      }\r\n    }\r\n  };\r\n\r\n  getPageSize = (): number => {\r\n    return 12;\r\n  };\r\n\r\n  expandFolder = (expand: boolean): void => {\r\n    const currentFolder = this.capture.getSelectedFolder();\r\n    if (currentFolder == null) {\r\n      return;\r\n    }\r\n\r\n    if (expand) {\r\n      this.captureUpdate.expandFolder(currentFolder);\r\n    } else {\r\n      this.captureUpdate.collapseFolder(currentFolder);\r\n    }\r\n  };\r\n\r\n  moveSelection = (offset: number): void => {\r\n    const items = new Array<any>();\r\n\r\n    this.getFlatList(items, this.folders);\r\n    const index = this.getCurrentSelection(items);\r\n    if (index === -1) {\r\n      return;\r\n    }\r\n\r\n    let newIndex = index + offset;\r\n    if (newIndex >= items.length) {\r\n      newIndex = items.length - 1;\r\n    }\r\n\r\n    if (newIndex < 0) {\r\n      newIndex = 0;\r\n    }\r\n\r\n    if (newIndex > items.length) {\r\n      return;\r\n    }\r\n\r\n    if (newIndex === index) {\r\n      return;\r\n    }\r\n\r\n    if (items[newIndex] instanceof WorkflowFolder) {\r\n      this.capture.selectFolder(<WorkflowFolder>items[newIndex]);\r\n    } else if (items[newIndex] instanceof FolderItem) {\r\n      const folderItem = items[newIndex] as FolderItem;\r\n      this.capture.selectDocument(folderItem.documents[0], folderItem.workItem, folderItem.parentId);\r\n    }\r\n  };\r\n\r\n  getCurrentSelection = (items: Array<any>): number => {\r\n    const currentFolder = this.capture.getSelectedFolder();\r\n    const currentDocument = this.capture.getCurrentDocument();\r\n\r\n    for (let index = 0; index < items.length; index++) {\r\n      if (currentFolder) {\r\n        if (!(items[index] instanceof WorkflowFolder)) {\r\n          continue;\r\n        }\r\n\r\n        if (currentFolder.id === items[index].id) {\r\n          return index;\r\n        }\r\n      } else if (currentDocument) {\r\n        if (!(items[index] instanceof FolderItem)) {\r\n          continue;\r\n        }\r\n\r\n        if (currentDocument.id === items[index].documents[0].id) {\r\n          return index;\r\n        }\r\n      }\r\n    }\r\n\r\n    return -1;\r\n  };\r\n\r\n  getFlatList = (items: Array<any>, folders: Array<WorkflowFolder>) => {\r\n    for (const folder of folders) {\r\n      items.push(folder);\r\n\r\n      if (folder.expanded) {\r\n        if (folder.items) {\r\n          for (const item of folder.items) {\r\n            if (!item.documents) {\r\n              continue;\r\n            }\r\n\r\n            items.push(item);\r\n          }\r\n        }\r\n\r\n        if (folder.folders) {\r\n          this.getFlatList(items, folder.folders);\r\n        }\r\n      }\r\n    }\r\n  };\r\n\r\n  isDocumentVisible = (element: Element): boolean => {\r\n    const panelElement = document.querySelector('#workflow-panel');\r\n    return (\r\n      panelElement &&\r\n      element &&\r\n      (<any>element).offsetTop > panelElement.scrollTop &&\r\n      (<any>element).offsetTop + (<any>element).clientHeight < panelElement.scrollTop + panelElement.clientHeight\r\n    );\r\n  };\r\n\r\n  onKeyDown = (event: KeyboardEvent): void => {\r\n    if (event.ctrlKey || event.altKey || event.shiftKey) {\r\n      return;\r\n    }\r\n\r\n    switch (event.key) {\r\n      case Key.ArrowUp:\r\n        this.moveSelection(-1);\r\n        break;\r\n      case Key.ArrowDown:\r\n        this.moveSelection(1);\r\n        break;\r\n      case Key.ArrowLeft:\r\n        this.expandFolder(false);\r\n        break;\r\n      case Key.ArrowRight:\r\n        this.expandFolder(true);\r\n        break;\r\n      case Key.PageUp:\r\n        this.moveSelection(-1 * this.getPageSize());\r\n        break;\r\n      case Key.PageDown:\r\n        this.moveSelection(this.getPageSize());\r\n        break;\r\n      case Key.Home:\r\n        this.moveSelection(-1000000);\r\n        break;\r\n      case Key.End:\r\n        this.moveSelection(1000000);\r\n    }\r\n  };\r\n\r\n  getDocumentListStyle = (): DocumentListStyle => {\r\n    return this.documentListStyleService.getStyle();\r\n  };\r\n\r\n  changeDocumentListStyle = (): void => {\r\n    (document.activeElement as HTMLElement)?.blur();\r\n\r\n    const newStyle =\r\n      this.documentListStyleService.getStyle() === DocumentListStyle.Tree\r\n        ? DocumentListStyle.Grid\r\n        : DocumentListStyle.Tree;\r\n    this.documentListStyleService.update(newStyle);\r\n    this.userPreferencesService.setPreference(this.DocumentListStylePreference, newStyle);\r\n    this.isGridView = this.documentListStyleService.getStyle() === DocumentListStyle.Grid;\r\n\r\n    if (newStyle === DocumentListStyle.Grid) {\r\n      this.listHeaderDirectiveOpts.disabled = false;\r\n      this.listHeaderDirectiveOpts = { ...this.listHeaderDirectiveOpts };\r\n    } else {\r\n      this.listHeaderDirectiveOpts.disabled = true;\r\n      this.listHeaderDirectiveOpts = { ...this.listHeaderDirectiveOpts };\r\n    }\r\n  };\r\n\r\n  getViewIconTextId() {\r\n    return this.isGridView ? 'Document_Capture.ChangeToDocumentGridView' : 'Document_Capture.ChangeToDocumentTreeView';\r\n  }\r\n\r\n  focusPanel() {\r\n    this.delay.execute(() => {\r\n      this.panel.nativeElement.focus();\r\n    }, 50);\r\n  }\r\n\r\n  trackFolderId(index, item) {\r\n    return item.id;\r\n  }\r\n\r\n  onDocumentLoaded() {\r\n    this.scrollbar.update();\r\n  }\r\n}\r\n","<section class=\"documents-list h-100 d-flex flex-column\" #wrapper>\r\n  <div class=\"pannel-header\">\r\n    <div class=\"pannel-title\">{{ 'Exceptions_Queue.Documents' | translate }}</div>\r\n    <div class=\"btn-group\">\r\n      <div class=\"d-flex justify-content-center align-items-center\">\r\n        <button class=\"button-icon\" title=\"{{ getViewIconTextId() | translate }}\" (click)=\"changeDocumentListStyle()\">\r\n          <div class=\"d-flex justify-content-right align-items-center\">\r\n            <img src=\"assets/icons/tree-view.svg\" *ngIf=\"isGridView\" width=\"18\" alt=\"\" />\r\n            <img src=\"assets/icons/grid-view.svg\" *ngIf=\"!isGridView\" width=\"18\" alt=\"\" />\r\n          </div>\r\n        </button>\r\n      </div>\r\n    </div>\r\n  </div>\r\n  <div class=\"col p-0\">\r\n    <div\r\n      id=\"workflow-panel\"\r\n      class=\"workflow-panel scrollable-section pb-2\"\r\n      fxFlex=\"auto\"\r\n      [perfectScrollbar]=\"{}\"\r\n      #scrollbar=\"ngxPerfectScrollbar\"\r\n      #workflowPanel\r\n      appDragNDrop\r\n      [autoScroll]=\"true\"\r\n      [wrapper]=\"$any(wrapper)\"\r\n      [scrollableWrapper]=\"$any(workflowPanel)\"\r\n      (scrollToTop)=\"onScroll($event)\"\r\n      (scrollToBottom)=\"onScroll($event)\"\r\n      (keydown)=\"onKeyDown($event)\"\r\n      tabindex=\"0\"\r\n    >\r\n      <div class=\"list-wrapper\">\r\n        <app-folder\r\n          class=\"d-block\"\r\n          *ngFor=\"let folder of folders; trackBy: trackFolderId\"\r\n          [folder]=\"folder\"\r\n          [workflow]=\"currentWorkflow\"\r\n          appListHeader\r\n          [options]=\"listHeaderDirectiveOpts\"\r\n          [contextMenu]=\"contextMenu\"\r\n          (documentLoaded)=\"onDocumentLoaded()\"\r\n        >\r\n        </app-folder>\r\n      </div>\r\n    </div>\r\n  </div>\r\n</section>\r\n\r\n<app-context-menu (rendered)=\"onRenderContextMenu($event)\"></app-context-menu>\r\n","import {\r\n  Component,\r\n  ElementRef,\r\n  EventEmitter,\r\n  Input,\r\n  OnDestroy,\r\n  OnInit,\r\n  Output,\r\n  Renderer2,\r\n  ViewChild,\r\n  ViewEncapsulation,\r\n} from '@angular/core';\r\n\r\nimport { TranslateService } from '@ngx-translate/core';\r\nimport { BsDropdownDirective } from 'ngx-bootstrap/dropdown';\r\nimport { Subscription } from 'rxjs';\r\n\r\nimport { ToastrService } from 'ngx-toastr';\r\nimport {\r\n  ContextMenuComponent,\r\n  DelayService,\r\n  FieldDataSource,\r\n  FieldDefinition,\r\n  FolderTreeAction,\r\n  IMetaDataDefinition,\r\n  MetaDataCascadingOptionsDataSource,\r\n  MetaDataDefinition,\r\n  MetaDataType,\r\n} from 'shared-code-lib';\r\nimport { Action, ActionEvent, FolderActionEvent } from '../../../../blocks/core/actions';\r\nimport { Filename } from '../../../../blocks/core/fileName';\r\nimport { Log } from '../../../../blocks/core/log';\r\nimport { FolderItem } from '../../../../blocks/models/folder-item';\r\nimport { IOutcome, Outcome } from '../../../../blocks/models/outcome';\r\nimport { WorkItem } from '../../../../blocks/models/work-item';\r\nimport { Workflow } from '../../../../blocks/models/workflow';\r\nimport { WorkflowFolder } from '../../../../blocks/models/workflow-folder';\r\nimport { InteractiveWorkflowStep, WorkflowStep, WorkflowStepSortType } from '../../../../blocks/models/workflow-step';\r\nimport { ActionService } from '../../../../blocks/services/action.service';\r\nimport { DragDropService } from '../../../../blocks/services/drag-drop.service';\r\nimport { HydraApiService } from '../../../../blocks/services/hydra-api.service';\r\nimport { ModalsUtilitiesService } from '../../../../blocks/services/modals-utilities.service';\r\nimport { SpinnerStateService } from '../../../../blocks/services/spinner-state.service';\r\nimport { UserStateService } from '../../../../blocks/services/user-state.service';\r\nimport { Capabilities, DocumentListStyle, DragData } from '../../capture-models';\r\nimport { CaptureConstants } from '../../capture-models/capture-constants';\r\nimport { DocumentsGridSortingConfig, SortingType } from '../../capture-models/sorting';\r\nimport { DocumentCaptureService } from '../../capture-services';\r\nimport { CaptureUpdateService } from '../../capture-services/capture-update.service';\r\nimport { DocumentListStyleService } from '../../capture-services/document-list-style.service';\r\nimport { FolderViewEventsService } from '../../capture-services/folder-view-events.service';\r\nimport { OutcomesService } from '../../capture-services/outcomes.service';\r\nimport { SelectedItemsService } from '../../capture-services/selected-items.service';\r\n\r\ndeclare const $: any;\r\n\r\n@Component({\r\n  selector: 'app-folder',\r\n  templateUrl: './folder.component.html',\r\n  styleUrls: ['./folder.component.scss'],\r\n  encapsulation: ViewEncapsulation.None,\r\n})\r\nexport class FolderComponent implements OnInit, OnDestroy {\r\n  @ViewChild('folderEl', { static: true }) folderEl: ElementRef;\r\n  @ViewChild('wrapper') wrapper: ElementRef;\r\n  @ViewChild('menu') menu: ElementRef;\r\n  @Output() openParentFolder = new EventEmitter();\r\n  @Input() workflow: Workflow;\r\n  @Input() folder: WorkflowFolder;\r\n  @Input() isBatch: boolean;\r\n  @Output() toggleSpinner = new EventEmitter<boolean>();\r\n  @Output() documentLoaded = new EventEmitter();\r\n  @Input() stepMetadataDefinitions: Array<MetaDataDefinition> = [];\r\n  @Input() stepMetadataDefinitionsFields: Array<FieldDefinition> = [];\r\n  @Input() contextMenu: ContextMenuComponent;\r\n\r\n  childrenWorkItems: Array<WorkItem>;\r\n  isExpanded: boolean;\r\n  isWorkflowRoot: boolean;\r\n  loadingItems: boolean;\r\n  subscriptions: Subscription;\r\n  dropEnabled: boolean;\r\n  discardOutcome: IOutcome;\r\n  canDeleteDocuments: boolean;\r\n\r\n  canImportNew: boolean;\r\n  canScanNew: boolean;\r\n  canDragDocuments: boolean;\r\n\r\n  hoverOver: boolean;\r\n  hoverOverMenu: boolean;\r\n  showMenu: boolean;\r\n  dropup: boolean;\r\n  isGridView: boolean;\r\n  isFolderSelected: boolean;\r\n  multipleItemsSelected: boolean;\r\n\r\n  sortingConfig = new DocumentsGridSortingConfig();\r\n\r\n  folderString = CaptureConstants.folder;\r\n\r\n  field = 'documents[0].filename';\r\n  dir: 'asc' | 'desc' = 'asc';\r\n  outcomes: IOutcome[];\r\n\r\n  constructor(\r\n    private hydraApi: HydraApiService,\r\n    private folderView: FolderViewEventsService,\r\n    private capture: DocumentCaptureService,\r\n    private captureUpdate: CaptureUpdateService,\r\n    private translate: TranslateService,\r\n    private spinnerState: SpinnerStateService,\r\n    private actionService: ActionService,\r\n    private delay: DelayService,\r\n    private userStateService: UserStateService,\r\n    private documentListStyleService: DocumentListStyleService,\r\n    private toastr: ToastrService,\r\n    private selectedItemsService: SelectedItemsService,\r\n    private dragDropService: DragDropService,\r\n    private outcomesService: OutcomesService,\r\n    private renderer: Renderer2,\r\n    private modalsUtilitiesService: ModalsUtilitiesService\r\n  ) {\r\n    this.isExpanded = false;\r\n    this.isWorkflowRoot = false;\r\n    this.childrenWorkItems = [];\r\n    this.subscriptions = new Subscription();\r\n    this.dropEnabled = false;\r\n  }\r\n\r\n  changeSort(field, dir) {\r\n    this.field = field;\r\n    this.dir = dir;\r\n  }\r\n\r\n  ngOnInit() {\r\n    Log.enter('FolderComponent.ngOnInit');\r\n\r\n    // set default sorting\r\n    this.defaultSort();\r\n\r\n    this.renderer.listen(this.folderEl.nativeElement, 'contextmenu', (event) => {\r\n      this.contextMenu.open(event, null, null, this.getFolderContextMenuActions());\r\n    });\r\n\r\n    try {\r\n      this.isWorkflowRoot = this.folder.workflowStepId === this.folder.parentID;\r\n      this.isGridView = this.documentListStyleService.getStyle() === DocumentListStyle.Grid;\r\n      this.capture.addToFolders(this.folder);\r\n\r\n      if (this.isWorkflowRoot && (this.folder.folders.length || this.folder.itemCount > 0)) {\r\n        this.isExpanded = true;\r\n        this.folder.expanded = true;\r\n        this.loadFolderItems();\r\n      }\r\n\r\n      const ws: WorkflowStep = this.capture.getWorkflowStepById(this.folder.workflowStepId);\r\n      if (ws) {\r\n        if (ws.hasCapability(Capabilities.deleteDocument)) {\r\n          this.discardOutcome = {\r\n            id: Outcome.SendToDoneId,\r\n            outcomeType: '',\r\n            text: this.translate.instant('Scanning.Discard'),\r\n            label: this.translate.instant('Scanning.Discard'),\r\n            enabled: true,\r\n            requiresConfirmation: true,\r\n            requiresValidMetaData: false,\r\n            nextId: '',\r\n          };\r\n\r\n          this.canDeleteDocuments = true;\r\n        }\r\n\r\n        this.canImportNew = ws.hasCapability(Capabilities.allowCaptureImport);\r\n        this.canScanNew = ws.hasCapability(Capabilities.allowCaptureScan);\r\n        this.canDragDocuments = ws.hasCapability(Capabilities.allowDropDocument);\r\n        if (this.isWorkflowRoot) {\r\n          this.loadStepMetadataDefinitions(ws);\r\n        }\r\n      }\r\n\r\n      this.subscriptions.add(this.captureUpdate.onExpandFolder.subscribe((f) => this.expandFolder(f, true)));\r\n      this.subscriptions.add(this.captureUpdate.onCollapseFolder.subscribe((f) => this.expandFolder(f, false)));\r\n      this.subscriptions.add(this.actionService.onActivateAction.subscribe(this.invokeAction));\r\n\r\n      this.subscriptions.add(\r\n        this.folderView.onAddFolder.subscribe((folderView) => {\r\n          if (folderView.parentId === this.folder.id) {\r\n            const newFolder = new WorkflowFolder(\r\n              folderView.id,\r\n              folderView.parentId,\r\n              this.folder,\r\n              folderView.workflowStepId,\r\n              folderView.name,\r\n              folderView.itemCount,\r\n              [],\r\n              null\r\n            );\r\n\r\n            this.folder.folders.push(newFolder);\r\n          }\r\n        })\r\n      );\r\n\r\n      this.subscriptions.add(\r\n        this.folderView.onDeleteFolder.subscribe((folderView) => {\r\n          if (folderView.parentId === this.folder.id) {\r\n            this.folder.folders = this.folder.folders.filter((folder) => {\r\n              return folder.id !== folderView.id;\r\n            });\r\n          }\r\n        })\r\n      );\r\n\r\n      this.subscriptions.add(\r\n        this.folderView.onUpdateFolder.subscribe((folderView) => {\r\n          if (folderView.id === this.folder.id) {\r\n            this.folder.itemCount = folderView.itemCount;\r\n          }\r\n        })\r\n      );\r\n\r\n      this.subscriptions.add(\r\n        this.folderView.onAddItem.subscribe((folderItem) => {\r\n          if (this.folder.id === folderItem.parentId) {\r\n            if (this.capture.hasChangedByCurrentUser(folderItem.workItem, false)) {\r\n              this.openParentFolder.emit();\r\n            }\r\n\r\n            this.addFolderItem(folderItem);\r\n          }\r\n        })\r\n      );\r\n\r\n      this.subscriptions.add(this.folderView.onUpdateItem.subscribe((folderItem) => this.updateFolderItem(folderItem)));\r\n\r\n      this.subscriptions.add(\r\n        this.folderView.onDeleteItem.subscribe((folderItem) => {\r\n          if (this.folder.id === folderItem.parentId && this.folder.items) {\r\n            this.capture.unselectDocument(folderItem.documents[0].id);\r\n\r\n            this.folder.items = this.folder.items.filter((f) => {\r\n              return f.workItem.id !== folderItem.workItem.id;\r\n            });\r\n          }\r\n        })\r\n      );\r\n\r\n      this.documentListStyleService.onChangeDocumentListStyle.subscribe((style: DocumentListStyle) => {\r\n        this.isGridView = style === DocumentListStyle.Grid;\r\n      });\r\n\r\n      this.subscriptions.add(\r\n        this.folderView.onSortGridColumnData.subscribe((sortingConfig: DocumentsGridSortingConfig) => {\r\n          if (sortingConfig.workflowStepId !== this.folder.workflowStepId) return;\r\n\r\n          this.sortingConfig = sortingConfig;\r\n          this.sortDocuments(this.sortingConfig);\r\n        })\r\n      );\r\n\r\n      this.onChangedSelectedItems();\r\n      this.subscriptions.add(this.selectedItemsService.onChangeSelectedItems.subscribe(this.onChangedSelectedItems));\r\n    } catch (e) {\r\n      Log.error('FolderComponent.ngOnInit', e);\r\n    }\r\n\r\n    this.subscriptions.add(\r\n      this.captureUpdate.onChangeOutcomeButtons.subscribe((outcomes) => {\r\n        this.outcomes = outcomes;\r\n      })\r\n    );\r\n  }\r\n\r\n  private defaultSort() {\r\n    const workflowStep = this.workflow.workflowSteps.find((a) => a.id == this.folder.workflowStepId);\r\n\r\n    if (workflowStep) {\r\n      const interactivestep = new InteractiveWorkflowStep(workflowStep);\r\n      this.dir = interactivestep.sortDirection == 0 ? 'asc' : 'desc';\r\n\r\n      if (interactivestep.sortBy == WorkflowStepSortType.DateCreated) {\r\n        this.field = 'documents[0].fileTimeCreated';\r\n      } else {\r\n        this.field = 'documents[0].filename';\r\n      }\r\n    }\r\n  }\r\n\r\n  ngOnDestroy() {\r\n    this.subscriptions.unsubscribe();\r\n    this.capture.removeFolder(this.folder.id);\r\n  }\r\n\r\n  getFolderContextMenuActions(): Array<FolderTreeAction> {\r\n    this.selectFolder();\r\n\r\n    const actions: Array<FolderTreeAction> = [];\r\n    if (this.canDeleteDocuments) {\r\n      let actionName: string;\r\n      if (this.isFolderSelected && this.multipleItemsSelected) {\r\n        actionName = this.translate.instant('document-actions.delete');\r\n      } else {\r\n        actionName = this.translate.instant('folder.DeleteDocuments');\r\n      }\r\n      actions.push({\r\n        name: actionName,\r\n        action: () => {\r\n          this.deleteSelectedItems();\r\n        },\r\n        disabled: !this.folder.folderHasItems(),\r\n      });\r\n    }\r\n\r\n    if (this.canImportNew && !this.isWorkflowRoot && !(this.isFolderSelected && this.multipleItemsSelected)) {\r\n      actions.push({\r\n        name: this.translate.instant('folder.ImportNew'),\r\n        action: () => {\r\n          this.addDocument();\r\n        },\r\n      });\r\n    }\r\n\r\n    if (this.canScanNew && !this.isWorkflowRoot && !(this.isFolderSelected && this.multipleItemsSelected)) {\r\n      actions.push({\r\n        name: this.translate.instant('folder.ScanNew'),\r\n        action: () => {\r\n          this.scanDocument();\r\n        },\r\n      });\r\n    }\r\n\r\n    // sort actions\r\n\r\n    if (!(this.isFolderSelected && this.multipleItemsSelected)) {\r\n      actions.push(\r\n        {\r\n          name: this.translate.instant('folder.SortByFileNameAsc'),\r\n          action: () => {\r\n            this.changeSort('documents[0].filename', 'asc');\r\n          },\r\n          disabled: !this.isFolderSelected || !this.folder.folderHasItems(),\r\n        },\r\n        {\r\n          name: this.translate.instant('folder.SortByFileNameDesc'),\r\n          action: () => {\r\n            this.changeSort('documents[0].filename', 'desc');\r\n          },\r\n          disabled: !this.isFolderSelected || !this.folder.folderHasItems(),\r\n        },\r\n        {\r\n          name: this.translate.instant('folder.SortByDateAsc'),\r\n          action: () => {\r\n            this.changeSort('documents[0].fileTimeCreated', 'asc');\r\n          },\r\n          disabled: !this.isFolderSelected || !this.folder.folderHasItems(),\r\n        },\r\n        {\r\n          name: this.translate.instant('folder.SortByDateDesc'),\r\n          action: () => {\r\n            this.changeSort('documents[0].fileTimeCreated', 'desc');\r\n          },\r\n          disabled: !this.isFolderSelected || !this.folder.folderHasItems(),\r\n        }\r\n      );\r\n    }\r\n\r\n    this.outcomes.forEach((outcome: IOutcome) => {\r\n      if (outcome.enabled) {\r\n        actions.push({\r\n          name: outcome.label,\r\n          action: () => {\r\n            this.capture.executeOutcome(outcome);\r\n          },\r\n          disabled: !this.isFolderSelected || !this.folder.folderHasItems(),\r\n        });\r\n      }\r\n    });\r\n\r\n    return actions;\r\n  }\r\n\r\n  getColumns = (): IMetaDataDefinition[] => {\r\n    const columns: IMetaDataDefinition[] = [];\r\n\r\n    this.stepMetadataDefinitions.forEach((x) => {\r\n      if (x.type == MetaDataType.CascadingOptions) {\r\n        ((x as MetaDataDefinition).dataSource as MetaDataCascadingOptionsDataSource).dataSet.forEach((o) => {\r\n          const optionMDD = this.userStateService.findMetaDataById(o.metaDataId);\r\n\r\n          columns.push(optionMDD);\r\n        });\r\n\r\n        return;\r\n      }\r\n\r\n      columns.push(x);\r\n    });\r\n\r\n    return columns;\r\n  };\r\n\r\n  getFolderItem = (id: string): FolderItem => {\r\n    const item: FolderItem = this.folder.items.find((i, index) => {\r\n      return i.workItem.id === id;\r\n    });\r\n    return item;\r\n  };\r\n\r\n  onChangedSelectedItems = () => {\r\n    this.isFolderSelected = this.selectedItemsService.isItemSelected(this.folder.id, this.folder.workflowStepId);\r\n    this.multipleItemsSelected = this.selectedItemsService.areMultipleItemsSelected();\r\n  };\r\n\r\n  invokeAction = (event: ActionEvent): void => {\r\n    if (!this.isFolderSelected) return;\r\n\r\n    if (event.action === Action.DeleteSelectedItem || event.action === Action.CtrlDeleteSelectedItem) {\r\n      if (!this.canDeleteDocuments || this.modalsUtilitiesService.isAnyModalOpened()) return;\r\n\r\n      this.deleteSelectedItems();\r\n      return;\r\n    }\r\n  };\r\n\r\n  updateFolderItem = (folderItem: FolderItem): void => {\r\n    if (this.folder.id === folderItem.parentId) {\r\n      if (this.folder.items !== null && this.folder.items.length) {\r\n        const item: FolderItem = this.getFolderItem(folderItem.workItem.id);\r\n        if (item) {\r\n          for (let i = 0; i < this.folder.items.length; i++) {\r\n            if (this.folder.items[i].workItem.id === folderItem.workItem.id) {\r\n              this.folder.items[i] = folderItem;\r\n              this.folderView.sortGridColumnData(this.sortingConfig);\r\n              this.expandAndSelectDocument(folderItem);\r\n              break;\r\n            }\r\n          }\r\n        } else {\r\n          this.addFolderItem(folderItem);\r\n        }\r\n      } else {\r\n        this.folder.items = [];\r\n        this.addFolderItem(folderItem);\r\n      }\r\n    } else {\r\n      if (this.folder.items) {\r\n        this.folder.items = this.folder.items.filter((f) => {\r\n          return f.workItem.id !== folderItem.workItem.id;\r\n        });\r\n\r\n        if (!this.existsInSameWorkflowStep(folderItem)) {\r\n          const currentWorkItem = this.capture.getCurrentWorkItem();\r\n          if (currentWorkItem && currentWorkItem.id == folderItem.workItem.id) {\r\n            this.capture.unselectDocument(folderItem.documents[0].id);\r\n          }\r\n        }\r\n      }\r\n    }\r\n  };\r\n\r\n  existsInSameWorkflowStep = (folderItem: FolderItem): boolean => {\r\n    return this.capture.getCurrentStepId() == folderItem.workItem.workflowStepId;\r\n  };\r\n\r\n  addFolderItem(folderItem: FolderItem) {\r\n    if (!this.folder || !this.folder.items) return;\r\n\r\n    this.folder.items.push(folderItem);\r\n    this.folderView.sortGridColumnData(this.sortingConfig);\r\n    this.delay.execute(() => {\r\n      this.captureUpdate.scrollToDocument(folderItem.documents[0].id);\r\n    }, 500);\r\n    this.expandAndSelectDocument(folderItem);\r\n  }\r\n\r\n  expandAndSelectDocument(folderItem: FolderItem) {\r\n    if (this.capture.hasChangedByCurrentUser(folderItem.workItem, true)) {\r\n      if (!this.isExpanded) {\r\n        this.toggleExpand();\r\n      }\r\n\r\n      this.capture.selectDocument(folderItem.documents[0], folderItem.workItem, this.folder.id);\r\n\r\n      this.openParentFolder.emit();\r\n    }\r\n  }\r\n\r\n  expandFolder = (folder: WorkflowFolder, expand: boolean): void => {\r\n    if (folder.id != this.folder.id) return;\r\n\r\n    if (this.isExpanded == expand) return;\r\n\r\n    this.toggleExpand();\r\n  };\r\n\r\n  toggleExpand() {\r\n    this.isExpanded = !this.isExpanded;\r\n    this.folder.expanded = this.isExpanded;\r\n\r\n    if (\r\n      (this.isExpanded && !this.folder.items) ||\r\n      (this.isExpanded && this.folder.itemCount !== this.folder.items.length)\r\n    ) {\r\n      this.loadFolderItems();\r\n    }\r\n  }\r\n\r\n  loadFolderItems() {\r\n    this.folder.items = [];\r\n\r\n    this.loadingItems = true;\r\n    this.hydraApi.getWorkflowFolderItems(\r\n      this.folder.id,\r\n      this.workflow.id,\r\n      (items: Array<FolderItem>) => {\r\n        this.folder.items = items;\r\n        this.onDocumentLoaded();\r\n        this.loadingItems = false;\r\n\r\n        this.folderView.sortGridColumnData(this.sortingConfig);\r\n      },\r\n      (error) => {\r\n        this.toastr.error(this.translate.instant('errors.failed-get-workflow-folder-items'));\r\n\r\n        this.loadingItems = false;\r\n      }\r\n    );\r\n  }\r\n\r\n  onAddNewFolder() {\r\n    if (!this.isExpanded) {\r\n      this.toggleExpand();\r\n    }\r\n\r\n    this.openParentFolder.emit();\r\n  }\r\n\r\n  selectFolder(event: MouseEvent = null) {\r\n    if (event) {\r\n      const target = event.target as HTMLElement;\r\n      if (target && target.className === 'icomoon-more') return;\r\n    }\r\n\r\n    this.capture.selectFolder(this.folder, event?.ctrlKey || false);\r\n    this.expandFolder(this.folder, true);\r\n  }\r\n\r\n  onDragOver(dragData: DragData) {\r\n    const ws = this.capture.getWorkflowStepById(this.folder.workflowStepId);\r\n    if (ws == null) return;\r\n\r\n    this.dropEnabled = false;\r\n\r\n    if (!dragData) {\r\n      this.dropEnabled = ws.hasCapability(Capabilities.allowDropExternalDocument) && this.isPrimaryStep();\r\n      return;\r\n    }\r\n\r\n    const _document = dragData.element as WorkItem;\r\n    if (_document.workflowStepId === this.folder.workflowStepId && dragData.elementParentId !== this.folder.id) {\r\n      if (!ws.hasCapability(Capabilities.allowDropDocument)) return;\r\n\r\n      this.dropEnabled = true;\r\n      if (!this.isExpanded) {\r\n        this.toggleExpand();\r\n      }\r\n    } else if (\r\n      dragData.elementType === CaptureConstants.page &&\r\n      this.folder.workflowStepId === dragData.elementParentStepId\r\n    ) {\r\n      if (!ws.hasCapability(Capabilities.allowDropDocumentPage)) return;\r\n\r\n      this.dropEnabled = true;\r\n      if (!this.isExpanded) {\r\n        this.toggleExpand();\r\n      }\r\n    }\r\n  }\r\n\r\n  onDragLeave(dragData: DragData) {\r\n    this.dropEnabled = false;\r\n  }\r\n\r\n  onDrop(dragData: DragData) {\r\n    const ws = this.capture.getWorkflowStepById(this.folder.workflowStepId);\r\n    if (ws == null) return;\r\n\r\n    if (dragData instanceof DragEvent) {\r\n      if (!ws.hasCapability(Capabilities.allowDropExternalDocument) || !this.isPrimaryStep()) return;\r\n      this.dropFiles(dragData);\r\n    }\r\n\r\n    const firstDragData = this.dragDropService.dragDataArray[0];\r\n\r\n    this.dragDropService.dragDataArray.forEach((dragDataItem) => {\r\n      dragDataItem.target = firstDragData.target;\r\n      dragDataItem.targetType = firstDragData.targetType;\r\n\r\n      if (dragDataItem.elementType === CaptureConstants.document) {\r\n        if (!ws.hasCapability(Capabilities.allowDropDocument)) return;\r\n        this.dropDocument(dragDataItem);\r\n      }\r\n\r\n      if (\r\n        dragDataItem.elementType === CaptureConstants.page &&\r\n        this.folder.workflowStepId === dragDataItem.elementParentStepId\r\n      ) {\r\n        if (!ws.hasCapability(Capabilities.allowDropDocumentPage)) return;\r\n        this.dropPage(dragDataItem);\r\n      }\r\n    });\r\n\r\n    this.dragDropService.clearDragData();\r\n    this.dropEnabled = false;\r\n  }\r\n\r\n  isPrimaryStep() {\r\n    const currentStep = this.getCurrentStep();\r\n    const primaryInteractiveStep = this.workflow.workflowSteps.find((step) => step instanceof InteractiveWorkflowStep);\r\n    return currentStep.id === primaryInteractiveStep.id;\r\n  }\r\n\r\n  dropFiles(dragData: DragEvent) {\r\n    //TODO: if (!(this.getCurrentStep() instanceof CaptureWorkflowStep)) return;\r\n\r\n    const files = dragData.dataTransfer.files;\r\n    if (!files.length) return;\r\n    for (let i = 0; i < files.length; i++) {\r\n      const fileName = Filename.getFileNameWithoutExtension(files[i].name);\r\n      let fileExtension = Filename.getFileExtension(files[i].name);\r\n      this.capture.addFiletoFolder(files[i], fileName, fileExtension, this.folder);\r\n    }\r\n  }\r\n\r\n  dropDocument(dragData: DragData) {\r\n    this.capture.handleDragDropDocuments(\r\n      dragData,\r\n      this.folder.workflowStepId,\r\n      this.capture.getGroupingFolderValues(this.folder)\r\n    );\r\n  }\r\n\r\n  dropPage(dragData: DragData) {\r\n    this.onToggleSpinner(true);\r\n    this.capture\r\n      .addPageToFolder(dragData.element, dragData.elementPosition, this.folder)\r\n      .then(() => {\r\n        this.onToggleSpinner(false);\r\n      })\r\n      .catch(() => {\r\n        this.onToggleSpinner(false);\r\n      });\r\n  }\r\n\r\n  getCurrentStep() {\r\n    return this.capture.getWorkflowStepById(this.folder.workflowStepId);\r\n  }\r\n\r\n  getDocumentCountText(): string {\r\n    if (!this.folder || this.folder.itemCount <= 0) {\r\n      return '';\r\n    }\r\n\r\n    const pageSuffix = this.translate.instant(\r\n      this.folder.itemCount === 1 ? 'Document_Capture.document' : 'Document_Capture.documents'\r\n    );\r\n\r\n    return `(${this.folder.itemCount} ${pageSuffix})`;\r\n  }\r\n\r\n  onToggleSpinner(state: boolean) {\r\n    if (state) {\r\n      this.translate\r\n        .get('Document_Capture.UpdatingDocument')\r\n        .subscribe((value) => this.spinnerState.show(value, document.getElementById('app-spinner-panel')));\r\n    } else {\r\n      this.spinnerState.hide();\r\n    }\r\n  }\r\n\r\n  onMouseEnter(isMenu?: boolean) {\r\n    if (isMenu) {\r\n      this.hoverOverMenu = true;\r\n    } else {\r\n      this.hoverOver = true;\r\n    }\r\n  }\r\n\r\n  onMouseLeave(isMenu?: boolean) {\r\n    this.delay.execute(() => {\r\n      if (isMenu) {\r\n        this.hoverOverMenu = false;\r\n      } else {\r\n        this.hoverOver = false;\r\n      }\r\n    }, 10);\r\n  }\r\n\r\n  onClickMenuButton(event: Event, dropdown: BsDropdownDirective) {\r\n    console.log('onClickMenuButton');\r\n\r\n    this.selectFolder();\r\n\r\n    this.contextMenu.open(event, null, null, this.getFolderContextMenuActions());\r\n  }\r\n\r\n  addDocument() {\r\n    this.hide();\r\n    const actionEvent = new FolderActionEvent(Action.ImportToUnselectedFolder, this.folder);\r\n    this.actionService.activateAction(actionEvent);\r\n  }\r\n\r\n  scanDocument() {\r\n    this.hide();\r\n    const actionEvent = new FolderActionEvent(Action.ScanToUnselectedFolder, this.folder);\r\n    this.actionService.activateAction(actionEvent);\r\n  }\r\n\r\n  hide() {\r\n    this.hoverOver = false;\r\n    this.hoverOverMenu = false;\r\n  }\r\n\r\n  onHidden() {\r\n    this.showMenu = false;\r\n  }\r\n\r\n  loadStepMetadataDefinitions = (workflowStep: WorkflowStep): void => {\r\n    const interactiveWorkflowStep = workflowStep as InteractiveWorkflowStep;\r\n\r\n    for (const id of interactiveWorkflowStep.metaDataIds) {\r\n      const metadataDefinition = this.userStateService.findMetaDataById(id);\r\n      if (metadataDefinition == null) {\r\n        continue;\r\n      }\r\n\r\n      if (metadataDefinition.type === MetaDataType.LineItems) {\r\n        continue;\r\n      }\r\n\r\n      this.stepMetadataDefinitions.push(metadataDefinition as MetaDataDefinition);\r\n    }\r\n\r\n    this.initializeStepMetaDataDefinitionsFields();\r\n  };\r\n\r\n  initializeStepMetaDataDefinitionsFields() {\r\n    this.stepMetadataDefinitions.forEach((mdd) => {\r\n      const fieldDefinition = mdd.asFieldDefinition();\r\n      fieldDefinition.label = '';\r\n\r\n      fieldDefinition.datasource = FieldDataSource.create(mdd, this.hydraApi);\r\n\r\n      this.stepMetadataDefinitionsFields.push(fieldDefinition);\r\n    });\r\n  }\r\n\r\n  trackWorkItemId(index, item) {\r\n    return item.id;\r\n  }\r\n\r\n  trackFolderId(index, folder) {\r\n    return folder.id;\r\n  }\r\n\r\n  onDocumentLoaded() {\r\n    this.documentLoaded.emit();\r\n  }\r\n\r\n  onGridColumnClicked(sortingIndex: number) {\r\n    let sortingType = SortingType.Asc;\r\n    if (this.sortingConfig.index === sortingIndex) {\r\n      sortingType = this.sortingConfig.type === SortingType.Asc ? SortingType.Desc : SortingType.Asc;\r\n    }\r\n\r\n    this.sortingConfig.index = sortingIndex;\r\n    this.sortingConfig.type = sortingType;\r\n    this.sortingConfig.workflowStepId = this.folder.workflowStepId;\r\n\r\n    this.folderView.sortGridColumnData(this.sortingConfig);\r\n  }\r\n\r\n  sortDocuments = (sortingConfig: DocumentsGridSortingConfig) => {\r\n    if (\r\n      this.sortingConfig.index === undefined ||\r\n      this.sortingConfig.type === SortingType.None ||\r\n      this.sortingConfig.workflowStepId !== this.folder.workflowStepId ||\r\n      !this.folder.items\r\n    ) {\r\n      return;\r\n    }\r\n\r\n    this.folder.items.sort((first, second) => {\r\n      let firstValue: string, secondValue: string;\r\n\r\n      if (sortingConfig.index === -1) {\r\n        firstValue = first.documents[0].filename;\r\n        secondValue = second.documents[0].filename;\r\n      } else if (sortingConfig.index >= 0) {\r\n        firstValue = this.getMetaDataValue(first.workItem, sortingConfig.index);\r\n        secondValue = this.getMetaDataValue(second.workItem, sortingConfig.index);\r\n      }\r\n\r\n      return this.getCompareResult(sortingConfig.index, firstValue, secondValue) * Number(sortingConfig.type);\r\n    });\r\n  };\r\n\r\n  getMetaDataValue = (workItem: WorkItem, metaDataIndex: number): string => {\r\n    return workItem.getMetaData(this.getColumns()[metaDataIndex].name).value.toString();\r\n  };\r\n\r\n  getCompareResult = (metaDataIndex: number, firstValue: string, secondValue: string): number => {\r\n    const metaDataType = metaDataIndex === -1 ? MetaDataType.Text : this.getColumns()[metaDataIndex].type;\r\n\r\n    if (metaDataType === MetaDataType.Integer || metaDataType === MetaDataType.Decimal) {\r\n      return Number(firstValue) - Number(secondValue);\r\n    }\r\n\r\n    if (metaDataType === MetaDataType.Date) {\r\n      return Date.parse(firstValue) <= Date.parse(secondValue) ? -1 : 1;\r\n    }\r\n\r\n    return firstValue.localeCompare(secondValue);\r\n  };\r\n\r\n  showSortingIcon(index: number): boolean {\r\n    return (\r\n      this.sortingConfig.workflowStepId === this.folder.workflowStepId &&\r\n      this.sortingConfig.type !== SortingType.None &&\r\n      this.sortingConfig.index === index\r\n    );\r\n  }\r\n\r\n  getSortingIconClass(): string {\r\n    if (this.sortingConfig.type === SortingType.Asc) return 'k-i-sort-asc-sm';\r\n    if (this.sortingConfig.type === SortingType.Desc) return 'k-i-sort-desc-sm';\r\n    return '';\r\n  }\r\n\r\n  deleteSelectedItems(): void {\r\n    this.hide();\r\n    this.outcomesService.confirmDeleteSelectedItems(this.confirmedDeleteSelectedItems);\r\n  }\r\n\r\n  confirmedDeleteSelectedItems = (data: any) => {\r\n    this.capture.transitionSelectedItems(data.id);\r\n  };\r\n}\r\n","<div\r\n  class=\"folder\"\r\n  [ngClass]=\"{\r\n    selected: isFolderSelected,\r\n    droppable: dropEnabled\r\n  }\"\r\n  appDragNDrop\r\n  [element]=\"folder\"\r\n  [elementParentId]=\"folder.parentID\"\r\n  [elementType]=\"folderString\"\r\n  [isDroppable]=\"true\"\r\n  (dragOver)=\"onDragOver($event)\"\r\n  (dragLeave)=\"onDragLeave($event)\"\r\n  (drop)=\"onDrop($event)\"\r\n>\r\n  <div\r\n    class=\"_folder d-flex align-items-center text-truncate pl-2\"\r\n    #folderEl\r\n    [title]=\"folder.name\"\r\n    (mouseleave)=\"onMouseLeave()\"\r\n    (mouseenter)=\"onMouseEnter()\"\r\n  >\r\n    <i [ngClass]=\"isExpanded ? 'minus-icon icon-play3' : 'plus-icon icon-play3'\" (click)=\"toggleExpand()\"> </i>\r\n    <div class=\"selection-wrapper col d-flex justify-content-between align-items-center\" (click)=\"selectFolder($event)\">\r\n      <div class=\"justify-content-start\">\r\n        <i\r\n          *ngIf=\"!isGridView\"\r\n          [ngClass]=\"{\r\n            'icon-folder-open': isExpanded,\r\n            'icon-folder': !isExpanded,\r\n            'folder-icon-root': isWorkflowRoot,\r\n            'folder-icon': !isWorkflowRoot,\r\n            'mr-1': true\r\n          }\"\r\n        >\r\n        </i>\r\n        <span [ngClass]=\"isWorkflowRoot ? 'workflow-folder' : ''\" class=\"name m-0 mr-1\">{{ folder.name }}</span>\r\n        <span class=\"item-count\" *ngIf=\"folder.itemCount\">{{ getDocumentCountText() }}</span>\r\n      </div>\r\n\r\n      <div class=\"folder-actions\">\r\n        <div #wrapper class=\"edit-delete\" *ngIf=\"hoverOver || hoverOverMenu\">\r\n          <div\r\n            class=\"btn-group\"\r\n            dropdown\r\n            #dropdown=\"bs-dropdown\"\r\n            container=\"body\"\r\n            (onHidden)=\"onHidden()\"\r\n            *ngIf=\"canDeleteDocuments || (canImportNew && !isWorkflowRoot) || (canScanNew && !isWorkflowRoot)\"\r\n          >\r\n            <button id=\"button-basic\" type=\"button\" class=\"button-icon\" (click)=\"onClickMenuButton($event, dropdown)\">\r\n              <i class=\"icomoon-more\"></i>\r\n            </button>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  </div>\r\n  <div\r\n    class=\"grid-header\"\r\n    *ngIf=\"isGridView && isWorkflowRoot && isExpanded && (folder.items?.length || folder.folders?.length)\"\r\n  >\r\n    <div class=\"grid-header-columns\">\r\n      <div class=\"grid-header-left-space\" [ngClass]=\"{ 'grid-header-drag-adjustment': !canDragDocuments }\"></div>\r\n      <table>\r\n        <tr id=\"grid-header-row\">\r\n          <th>\r\n            <div\r\n              class=\"grid-header-column\"\r\n              title=\"{{ 'folder.DocumentNameColumn' | translate }}\"\r\n              (click)=\"onGridColumnClicked(-1)\"\r\n            >\r\n              {{ 'folder.DocumentNameColumn' | translate }}\r\n              <span *ngIf=\"showSortingIcon(-1)\" class=\"k-icon {{ getSortingIconClass() }}\"></span>\r\n            </div>\r\n          </th>\r\n          <th *ngFor=\"let metadata of getColumns(); let i = index\">\r\n            <div class=\"grid-header-column\" title=\"{{ metadata.label }}\" (click)=\"onGridColumnClicked(i)\">\r\n              {{ metadata.label }} <span *ngIf=\"showSortingIcon(i)\" class=\"k-icon {{ getSortingIconClass() }}\"></span>\r\n            </div>\r\n          </th>\r\n          <th>\r\n            <div class=\"grid-header-right-space\"></div>\r\n          </th>\r\n        </tr>\r\n      </table>\r\n    </div>\r\n  </div>\r\n\r\n  <div *ngIf=\"loadingItems\" class=\"loading\">\r\n    <img src=\"assets/shared/img/animated-spinner.gif\" width=\"15\" height=\"3\" />\r\n    {{ 'folder.loading' | translate }}\r\n  </div>\r\n\r\n  <div class=\"folder-content-wrapper\">\r\n    <ul class=\"children-items-nodes\" *ngIf=\"folder.items?.length\" [class.expanded]=\"isExpanded\">\r\n      <li *ngFor=\"let folderItem of folder.items | sort : field : dir; let i = index; trackBy: trackWorkItemId\">\r\n        <div class=\"pr-1\">\r\n          <app-work-item\r\n            [folderItem]=\"folderItem\"\r\n            [parentFolderId]=\"folder.id\"\r\n            [stepMetadataDefinitions]=\"stepMetadataDefinitions\"\r\n            [stepMetadataDefinitionsFields]=\"stepMetadataDefinitionsFields\"\r\n            [contextMenu]=\"contextMenu\"\r\n            (documentLoaded)=\"onDocumentLoaded()\"\r\n          ></app-work-item>\r\n        </div>\r\n      </li>\r\n    </ul>\r\n\r\n    <ul\r\n      class=\"children-folders-nodes\"\r\n      [class.expanded]=\"isExpanded\"\r\n      [ngClass]=\"{\r\n        expanded: isExpanded,\r\n        'p-0': isGridView\r\n      }\"\r\n    >\r\n      <li *ngFor=\"let childFolder of folder.folders; trackBy: trackFolderId\">\r\n        <app-folder\r\n          [folder]=\"childFolder\"\r\n          [workflow]=\"workflow\"\r\n          [isBatch]=\"isWorkflowRoot\"\r\n          (openParentFolder)=\"onAddNewFolder()\"\r\n          [stepMetadataDefinitions]=\"stepMetadataDefinitions\"\r\n          [stepMetadataDefinitionsFields]=\"stepMetadataDefinitionsFields\"\r\n          [contextMenu]=\"contextMenu\"\r\n        ></app-folder>\r\n      </li>\r\n    </ul>\r\n  </div>\r\n</div>\r\n","import { Component, EventEmitter, Input, OnDestroy, OnInit, Output } from '@angular/core';\r\n\r\nimport { Subscription } from 'rxjs';\r\n\r\nimport { ContextMenuComponent, FieldDefinition, MetaDataDefinition } from 'shared-code-lib';\r\nimport { IDocument } from '../../../../blocks/models/document';\r\nimport { FolderItem } from '../../../../blocks/models/folder-item';\r\nimport { CapturedDocument } from '../../capture-models/document';\r\nimport { DocumentCaptureService } from '../../capture-services';\r\nimport { CaptureUpdateService } from '../../capture-services/capture-update.service';\r\nimport { SelectedItemsService } from '../../capture-services/selected-items.service';\r\n\r\n@Component({\r\n  selector: 'app-work-item',\r\n  templateUrl: './work-item.component.html',\r\n  styleUrls: ['./work-item.component.scss'],\r\n})\r\nexport class WorkItemComponent implements OnInit, OnDestroy {\r\n  @Input() folderItem: FolderItem;\r\n  @Input() parentFolderId: string;\r\n  @Input() stepMetadataDefinitions: Array<MetaDataDefinition> = [];\r\n  @Input() stepMetadataDefinitionsFields: Array<FieldDefinition> = [];\r\n  @Input() contextMenu: ContextMenuComponent;\r\n  @Output() documentLoaded = new EventEmitter();\r\n\r\n  currentDocument: CapturedDocument;\r\n  document: IDocument;\r\n  isDocumentSelected: boolean;\r\n\r\n  subscriptions: Subscription;\r\n  constructor(\r\n    private capture: DocumentCaptureService,\r\n    private captureUpdate: CaptureUpdateService,\r\n    private selectedItemsService: SelectedItemsService\r\n  ) {\r\n    this.subscriptions = new Subscription();\r\n  }\r\n\r\n  ngOnInit() {\r\n    this.currentDocument = this.capture.getCurrentDocument();\r\n    this.subscriptions.add(this.captureUpdate.onChangeDocument.subscribe((doc) => (this.currentDocument = doc)));\r\n\r\n    this.document = this.folderItem.documents[0];\r\n\r\n    this.onChangedSelectedItems();\r\n    this.subscriptions.add(this.selectedItemsService.onChangeSelectedItems.subscribe(this.onChangedSelectedItems));\r\n  }\r\n\r\n  onChangedSelectedItems = () => {\r\n    this.isDocumentSelected = this.selectedItemsService.isItemSelected(\r\n      this.folderItem.workItem.id,\r\n      this.folderItem.workItem.workflowStepId\r\n    );\r\n  };\r\n\r\n  ngOnDestroy() {\r\n    this.subscriptions.unsubscribe();\r\n  }\r\n\r\n  trackDocumentId(index, item) {\r\n    return item.id;\r\n  }\r\n\r\n  onDocumentLoaded() {\r\n    this.documentLoaded.emit();\r\n  }\r\n}\r\n","<app-document\r\n  *ngFor=\"let document of folderItem.documents; trackBy: trackDocumentId\"\r\n  [doc]=\"document\"\r\n  [folderItem]=\"folderItem\"\r\n  [parentFolderId]=\"parentFolderId\"\r\n  [id]=\"'doc-' + document.id\"\r\n  [class.selected]=\"isDocumentSelected\"\r\n  [selected]=\"isDocumentSelected\"\r\n  [stepMetadataDefinitions]=\"stepMetadataDefinitions\"\r\n  [stepMetadataDefinitionsFields]=\"stepMetadataDefinitionsFields\"\r\n  [contextMenu]=\"contextMenu\"\r\n  (documentLoaded)=\"onDocumentLoaded()\"\r\n>\r\n</app-document>\r\n","import {\r\n  ChangeDetectorRef,\r\n  Component,\r\n  EventEmitter,\r\n  OnDestroy,\r\n  OnInit,\r\n  Output,\r\n  ViewChild,\r\n  ViewEncapsulation,\r\n} from '@angular/core';\r\nimport { PerfectScrollbarComponent } from 'ngx-perfect-scrollbar-portable';\r\nimport { Subscription } from 'rxjs';\r\n\r\nimport {\r\n  BlurEvent,\r\n  DelayService,\r\n  DropDownService,\r\n  FieldDataSource,\r\n  FieldDefinition,\r\n  MetaDataDefinition,\r\n  MetaDataPreviewHilight,\r\n  MetaDataType,\r\n  MetaDataValidity,\r\n  SaveLookupsEvent,\r\n  StickyFieldsService,\r\n} from 'shared-code-lib';\r\nimport { LockStatus } from '../../../blocks/models/lock-status';\r\nimport { WorkflowFolder } from '../../../blocks/models/workflow-folder';\r\nimport { HydraApiService } from '../../../blocks/services/hydra-api.service';\r\nimport { UserStateService } from '../../../blocks/services/user-state.service';\r\nimport { CapturedDocument, IndexingPanels, ValueLocation, ValueObj } from '../capture-models';\r\nimport { DocumentCaptureService, IndexingPanelService } from '../capture-services';\r\nimport { CaptureUpdateService } from '../capture-services/capture-update.service';\r\nimport { DocumentLockingService } from '../capture-services/document-locking.service';\r\nimport { SelectedItemsService } from '../capture-services/selected-items.service';\r\n\r\n@Component({\r\n  selector: 'app-indexing-panel',\r\n  templateUrl: './indexing-panel.component.html',\r\n  styleUrls: ['./indexing-panel.component.scss'],\r\n  encapsulation: ViewEncapsulation.None,\r\n})\r\nexport class IndexingPanelComponent implements OnInit, OnDestroy {\r\n  @ViewChild('perfectScroll') perfectScroll: PerfectScrollbarComponent;\r\n  @Output() setCurrentField = new EventEmitter<string>();\r\n\r\n  indexingPanel = IndexingPanels['AdvancedIndexing'];\r\n  selectedDocument: CapturedDocument;\r\n  selectedFolder: WorkflowFolder;\r\n  fields: Array<MetaDataDefinition> = [];\r\n  currentField: MetaDataDefinition;\r\n  currentFieldIndex: number;\r\n  value: string;\r\n  subscriptions: Subscription;\r\n\r\n  documentLocked: boolean;\r\n  oneDocumentSelected: boolean;\r\n  hasSelectedItems: boolean;\r\n  private shouldFocusFirstField = true;\r\n\r\n  timeout: number;\r\n\r\n  disableBlur = false;\r\n\r\n  get getContext() {\r\n    return this.selectedDocument?.workitem;\r\n  }\r\n\r\n  constructor(\r\n    private indexingService: IndexingPanelService,\r\n    public capture: DocumentCaptureService,\r\n    private captureUpdate: CaptureUpdateService,\r\n    private hydraApi: HydraApiService,\r\n    private stickyService: StickyFieldsService,\r\n    private dropDown: DropDownService,\r\n    private documentLockingService: DocumentLockingService,\r\n    public userStateService: UserStateService,\r\n    private delay: DelayService,\r\n    private selectedItemsService: SelectedItemsService,\r\n    private documentCaptureService: DocumentCaptureService,\r\n    private cdr: ChangeDetectorRef\r\n  ) {\r\n    this.subscriptions = new Subscription();\r\n  }\r\n\r\n  ngOnInit() {\r\n    this.subscriptions.add(\r\n      this.captureUpdate.onChangeDocument.subscribe((doc) => {\r\n        this.currentField = null;\r\n        this.currentFieldIndex = null;\r\n        this.documentLocked = false;\r\n        this.value = null;\r\n\r\n        this.disableBlur = true;\r\n        this.selectedDocument = doc;\r\n\r\n        this.shouldFocusFirstField = true;\r\n        if (this.selectedDocument) {\r\n          const valuesWithValidLocation: Array<ValueLocation> = [];\r\n\r\n          this.fields.forEach((field) => {\r\n            const fieldId = field.id;\r\n            const location = this.capture.getValueLocation(field);\r\n            if (location && location.valid) {\r\n              const validity = this.capture.getFieldValidity(field);\r\n              valuesWithValidLocation.push({ fieldId, location, validity });\r\n            }\r\n          });\r\n\r\n          this.selectedDocument.workitem.metadata.metadata.forEach((md) => {\r\n            console.log(md);\r\n\r\n            if (md.previewHilight == MetaDataPreviewHilight.None) return;\r\n            if (!md.location) return;\r\n            if (!md.location.valid) return;\r\n\r\n            valuesWithValidLocation.push({ fieldId: md.name, location: md.location, validity: md.validity });\r\n          });\r\n\r\n          this.captureUpdate.hasValuesWithValidLocation(valuesWithValidLocation);\r\n        } else {\r\n          this.currentField = null;\r\n          this.currentFieldIndex = null;\r\n        }\r\n\r\n        const el = document.querySelector('#indexing-panel');\r\n        if (el) el.scrollTop = 0;\r\n\r\n        this.cdr.detectChanges();\r\n        this.perfectScroll.directiveRef.scrollToTop();\r\n        if (this.timeout) window.clearTimeout(this.timeout);\r\n        this.timeout = window.setTimeout(() => {\r\n          this.disableBlur = false;\r\n        }, 100);\r\n      })\r\n    );\r\n\r\n    this.subscriptions.add(this.documentLockingService.lockStatusChanged.subscribe(this.lockStatusChanged));\r\n\r\n    this.subscriptions.add(\r\n      this.indexingService.onChangeWorkflowStep.subscribe((metaDataArr) => {\r\n        this.fields = metaDataArr.filter((x) => x.allowedForWorkflow(this.documentCaptureService.currentWorkflow.id));\r\n\r\n        this.perfectScroll.directiveRef.update();\r\n        this.perfectScroll.directiveRef.scrollToTop();\r\n      })\r\n    );\r\n\r\n    this.subscriptions.add(\r\n      this.captureUpdate.onChangeFolder.subscribe((folder) => {\r\n        this.selectedFolder = folder;\r\n      })\r\n    );\r\n\r\n    this.subscriptions.add(this.indexingService.onTakeFocus.subscribe(this.onTakeFocusHandler));\r\n\r\n    this.subscriptions.add(\r\n      this.indexingService.onPointAndClickInitialized.subscribe(() => {\r\n        if (this.shouldFocusFirstField) {\r\n          this.init();\r\n          this.shouldFocusFirstField = false;\r\n        }\r\n        if (this.currentField) {\r\n          this.indexingService.changeCurrentField(this.indexingPanel, this.currentField.name);\r\n        }\r\n      })\r\n    );\r\n\r\n    this.subscriptions.add(\r\n      this.indexingService.onChangeCurrentFieldValue.subscribe((valueObj: ValueObj) => {\r\n        if (valueObj.panel === this.indexingPanel) {\r\n          if (this.selectedDocument && this.fields.length) {\r\n            this.value = valueObj.updateFieldData.value;\r\n            if (this.currentField.type !== MetaDataType.Lookup) {\r\n              this.delay.execute(() => {\r\n                this.moveTo(null);\r\n              }, 100);\r\n            }\r\n          }\r\n        }\r\n      })\r\n    );\r\n\r\n    this.onChangedSelectedItems();\r\n    this.subscriptions.add(this.selectedItemsService.onChangeSelectedItems.subscribe(this.onChangedSelectedItems));\r\n  }\r\n\r\n  onTakeFocusHandler = (panel: number) => {\r\n    this.currentField = null;\r\n    if (panel !== this.indexingPanel) return;\r\n\r\n    this.moveTo(this.getFocusFieldIndex());\r\n  };\r\n\r\n  getFocusFieldIndex(): number {\r\n    const fieldName = this.indexingService.getCurrentFieldName();\r\n    const currentFieldIndex = this.fields.findIndex((field) => field.name === fieldName);\r\n    return fieldName && currentFieldIndex !== -1 ? currentFieldIndex : 0;\r\n  }\r\n\r\n  onChangedSelectedItems = () => {\r\n    this.oneDocumentSelected = this.selectedItemsService.isOneDocumentSelected();\r\n    this.hasSelectedItems = this.selectedItemsService.hasItemsSelected();\r\n  };\r\n\r\n  lockStatusChanged = (ls: LockStatus): void => {\r\n    if (!this.selectedDocument || !this.selectedDocument.workitem) return;\r\n\r\n    if (ls.id == this.selectedDocument.workitem.id) {\r\n      this.documentLocked = ls.locked && ls.lockedByUserId == this.userStateService.user.id && !ls.expired();\r\n    }\r\n  };\r\n\r\n  ngOnDestroy() {\r\n    this.subscriptions.unsubscribe();\r\n  }\r\n\r\n  init() {\r\n    this.moveTo(0, false);\r\n  }\r\n\r\n  moveTo(fieldIndex: number | null, zoom?: boolean) {\r\n    this.value = '';\r\n\r\n    if (fieldIndex !== null) {\r\n      this.currentFieldIndex = fieldIndex;\r\n      this.currentField = this.fields[fieldIndex];\r\n\r\n      if (zoom !== false) {\r\n        const location = this.capture.getValueLocation(this.currentField);\r\n        if (location && location.valid) {\r\n          this.captureUpdate.zoomIntoValue(this.currentField.id);\r\n        } else {\r\n          this.captureUpdate.zoomIntoValue(null);\r\n        }\r\n      }\r\n    } else {\r\n      if (this.currentFieldIndex === this.fields.length - 1) {\r\n        this.captureUpdate.selectNextDocument();\r\n      } else {\r\n        this.moveTo(this.currentFieldIndex + 1);\r\n      }\r\n\r\n      return;\r\n    }\r\n\r\n    if (this.currentField) {\r\n      this.indexingService.changeCurrentField(this.indexingPanel, this.currentField.name);\r\n    }\r\n  }\r\n\r\n  getFieldDefinition = (mdd: MetaDataDefinition): FieldDefinition => {\r\n    const fd = mdd.asFieldDefinition();\r\n    fd.datasource = FieldDataSource.create(mdd, this.hydraApi);\r\n\r\n    return fd;\r\n  };\r\n\r\n  getFieldValue = (mdd: MetaDataDefinition): string => {\r\n    if (this.disableBlur) return;\r\n    if (!this.oneDocumentSelected || !this.selectedDocument) return '';\r\n\r\n    const mddValue = this.capture.getWorkItemIndexingValue(mdd.name);\r\n    if (!mdd.stickyField) return mddValue;\r\n\r\n    if (mddValue) {\r\n      this.stickyService.setStickyField(mdd.name, mddValue);\r\n      return mddValue;\r\n    }\r\n\r\n    const stickyValue = this.stickyService.getStickyField(mdd.name);\r\n    if (!stickyValue) return '';\r\n\r\n    this.capture.validateAndSaveIndexingValue(stickyValue, mdd, this.getContext);\r\n    return stickyValue;\r\n  };\r\n\r\n  shouldValueBeSet = (mdd: MetaDataDefinition): string => {\r\n    if (this.currentField) {\r\n      if (mdd.id === this.currentField.id) {\r\n        return this.value;\r\n      }\r\n    }\r\n\r\n    return '';\r\n  };\r\n\r\n  onFocus(index: number): void {\r\n    this.moveTo(index);\r\n  }\r\n\r\n  onBlur(blurEvent: BlurEvent, mdd: MetaDataDefinition): void {\r\n    console.log('onBlur', event, mdd);\r\n    if (this.disableBlur) return;\r\n    if (blurEvent.context.id != this.getContext.id) return;\r\n\r\n    if (blurEvent.mdd) mdd = blurEvent.mdd;\r\n\r\n    this.capture.validateAndSaveIndexingValue(blurEvent.value, mdd, blurEvent.context, true);\r\n\r\n    if (mdd.stickyField) this.stickyService.setStickyField(mdd.name, blurEvent.value);\r\n  }\r\n\r\n  onReturn(value: any, mdd: MetaDataDefinition) {\r\n    this.capture.validateAndSaveIndexingValue(value, mdd, this.getContext);\r\n    this.captureUpdate.changeValueValidity({ id: mdd.id, validity: MetaDataValidity.valid });\r\n  }\r\n\r\n  getValidity = (mdd: MetaDataDefinition) => {\r\n    const validity = this.capture.getFieldValidity(mdd);\r\n    return validity || MetaDataValidity.unknown;\r\n  };\r\n\r\n  onTab(event: BlurEvent, mdd: MetaDataDefinition, index: number) {\r\n    if (index !== this.fields.length - 1) return;\r\n\r\n    if (mdd.stickyField) this.stickyService.setStickyField(mdd.name, event.value);\r\n    if (document.activeElement && (document.activeElement as any).blur) (document.activeElement as any).blur();\r\n  }\r\n\r\n  onTabKey(event: Event, index: number) {\r\n    if (event) event.preventDefault();\r\n\r\n    if (index === this.fields.length - 1 && this.documentCaptureService.canAutomaticallyAdvanceOnTab()) {\r\n      this.captureUpdate.selectNextDocument();\r\n    } else {\r\n      this.moveTo(index + 1);\r\n    }\r\n  }\r\n\r\n  onShiftTabKey(event: Event, index: number) {\r\n    if (event) {\r\n      event.preventDefault();\r\n    }\r\n\r\n    if (index === 0) {\r\n      this.moveTo(this.fields.length - 1);\r\n    } else {\r\n      this.moveTo(index - 1);\r\n    }\r\n  }\r\n\r\n  onScroll() {\r\n    this.dropDown.scrolled();\r\n  }\r\n\r\n  onSaveLookupValues(event: SaveLookupsEvent, index: number) {\r\n    this.capture.updateMetadataValues(event.context, event.lookups);\r\n\r\n    if (event.move) {\r\n      this.delay.execute(() => {\r\n        if (event.forward) {\r\n          this.onTabKey(null, index);\r\n        } else {\r\n          this.onShiftTabKey(null, index);\r\n        }\r\n      }, 500);\r\n    }\r\n  }\r\n\r\n  trackByDocumentMetaDataField = (index: number, item: MetaDataDefinition) => {\r\n    return (this.selectedDocument?.id ?? '') + item?.id;\r\n  };\r\n}\r\n","<section class=\"indexing-panel h-100\">\r\n  <div class=\"pannel-header\">\r\n    <div class=\"pannel-title\">{{ 'Indexing.Indexing' | translate }}</div>\r\n  </div>\r\n  <perfect-scrollbar\r\n    #perfectScroll\r\n    [autoUpdatePerfectScroll]=\"perfectScroll.directiveRef\"\r\n    class=\"col p-0\"\r\n    [config]=\"{ suppressScrollX: false }\"\r\n    (ps-scroll-up)=\"onScroll()\"\r\n    (ps-scroll-down)=\"onScroll()\"\r\n  >\r\n    <div id=\"indexing-panel\" class=\"pb-5\">\r\n      <form class=\"indexing-form container-fluid mt-2\" *ngIf=\"!disableBlur\" appAutoFocusFirstInput>\r\n        <app-field\r\n          *ngFor=\"let field of fields; let i = index; trackBy: trackByDocumentMetaDataField\"\r\n          [context]=\"getContext\"\r\n          [field]=\"getFieldDefinition(field)\"\r\n          [value]=\"getFieldValue(field)\"\r\n          [disabled]=\"!oneDocumentSelected || !documentLocked || disableBlur\"\r\n          [class.hidden]=\"!hasSelectedItems\"\r\n          [focused]=\"oneDocumentSelected && field.id === currentField?.id\"\r\n          [validity]=\"getValidity(field)\"\r\n          [fillViaPointAClick]=\"shouldValueBeSet(field)\"\r\n          [findMetaDataService]=\"userStateService\"\r\n          [metaDataCollection]=\"capture && capture.getMetaDataCollection()\"\r\n          [metaDataValidator]=\"capture\"\r\n          (focus)=\"onFocus(i)\"\r\n          (blurex)=\"onBlur($event, field)\"\r\n          (return)=\"onReturn($event, field)\"\r\n          (tabex)=\"onTab($event, field, i)\"\r\n          (keydown.tab)=\"onTabKey($event, i)\"\r\n          (keydown.shift.tab)=\"onShiftTabKey($event, i)\"\r\n          (saveLookupValues)=\"onSaveLookupValues($event, i)\"\r\n          [triggerBlurEventOnLoad]=\"false\"\r\n        >\r\n        </app-field>\r\n      </form>\r\n    </div>\r\n  </perfect-scrollbar>\r\n</section>\r\n","import {\r\n  AfterViewChecked,\r\n  AfterViewInit,\r\n  ChangeDetectorRef,\r\n  Component,\r\n  effect,\r\n  EventEmitter,\r\n  OnDestroy,\r\n  OnInit,\r\n  Output,\r\n  viewChild,\r\n  ViewChild,\r\n  ViewEncapsulation,\r\n} from '@angular/core';\r\n\r\nimport { TranslateService } from '@ngx-translate/core';\r\nimport { NgxSmartModalService } from 'ngx-smart-modal';\r\nimport { ToastrService } from 'ngx-toastr';\r\nimport { fromEvent, Subject, Subscription } from 'rxjs';\r\n\r\nimport { CdkVirtualScrollViewport } from '@angular/cdk/scrolling';\r\nimport { PerfectScrollbarComponent } from 'ngx-perfect-scrollbar-portable';\r\nimport {\r\n  BlurEvent,\r\n  BulkValidationRequest,\r\n  DelayService,\r\n  DropDownService,\r\n  FieldDataSource,\r\n  FieldDefinition,\r\n  FieldDisplayMode,\r\n  ILocation,\r\n  IMetaData,\r\n  IMetaDataDefinition,\r\n  LineItemConfiguration,\r\n  MetaDataCascadingOptionsDataSource,\r\n  MetaDataCollection,\r\n  MetaDataCollectionDictionary,\r\n  MetaDataDefinition,\r\n  MetaDataLineItems,\r\n  MetaDataType,\r\n  MetaDataValidity,\r\n  SaveLookupsEvent,\r\n} from 'shared-code-lib';\r\nimport { Log } from '../../../blocks/core/log';\r\nimport { LockStatus } from '../../../blocks/models/lock-status';\r\nimport { WorkItem } from '../../../blocks/models/work-item';\r\nimport { HydraApiService } from '../../../blocks/services/hydra-api.service';\r\nimport { SpinnerStateService } from '../../../blocks/services/spinner-state.service';\r\nimport { UserStateService } from '../../../blocks/services/user-state.service';\r\nimport {\r\n  CapturedDocument,\r\n  GroupOfValuesObj,\r\n  IndexingPanels,\r\n  UpdateLineItemsEvent,\r\n  ValueLocation,\r\n  ValueObj,\r\n} from '../capture-models';\r\nimport { DocumentCaptureService, IndexingPanelService } from '../capture-services';\r\nimport { CaptureUpdateService } from '../capture-services/capture-update.service';\r\nimport { DocumentLockingService } from '../capture-services/document-locking.service';\r\nimport { SelectedItemsService } from '../capture-services/selected-items.service';\r\n\r\n@Component({\r\n  selector: 'app-line-item-indexing',\r\n  templateUrl: './line-item-indexing.component.html',\r\n  styleUrls: ['./line-item-indexing.component.scss'],\r\n  encapsulation: ViewEncapsulation.None,\r\n})\r\nexport class LineItemIndexingComponent implements OnInit, AfterViewInit, AfterViewChecked, OnDestroy {\r\n  @ViewChild('virtualScrollViewport', { static: false }) virtualScrollViewport: CdkVirtualScrollViewport;\r\n  cdkScrollElement = viewChild<CdkVirtualScrollViewport | undefined>('virtualScrollViewport');\r\n\r\n  @ViewChild('tableWrapper', { static: false }) tableWrapper: PerfectScrollbarComponent;\r\n  @Output() setCurrentCell = new EventEmitter<string>();\r\n  @Output() removeFocus = new EventEmitter();\r\n  lineItemPanel = IndexingPanels['LineItemIndexing'];\r\n  isInitialized: boolean;\r\n  selectedRowIndex: number;\r\n  selectedCellIndex: number;\r\n  subscriptions: Subscription;\r\n  toBeDeletedIndex: number;\r\n  value = '';\r\n  emptyLinesShouldBeRemoved: boolean;\r\n  defaultRowValues: string;\r\n\r\n  lineItemMetaDataId: string;\r\n  lineItemMetaDataName: string;\r\n  lineItemMDD: Array<IMetaDataDefinition>;\r\n  lineItems: MetaDataLineItems;\r\n  headerLabel: string;\r\n  loadingDefaultValues = false;\r\n\r\n  selectedDocument: CapturedDocument;\r\n  documentLocked: boolean;\r\n  oneDocumentSelected: boolean;\r\n  allowedTypesForTotals: MetaDataType[] = [MetaDataType.Integer, MetaDataType.Decimal];\r\n  isBusy: boolean;\r\n\r\n  virtualScrollViewportStyles = { width: '0px', height: '0px' };\r\n\r\n  addNewLineItemSubject = new Subject();\r\n\r\n  constructor(\r\n    public capture: DocumentCaptureService,\r\n    private captureUpdate: CaptureUpdateService,\r\n    private indexingService: IndexingPanelService,\r\n    private cdr: ChangeDetectorRef,\r\n    private delay: DelayService,\r\n    private hydraApi: HydraApiService,\r\n    private ngxSmartModalService: NgxSmartModalService,\r\n    private translate: TranslateService,\r\n    private toastr: ToastrService,\r\n    private dropDown: DropDownService,\r\n    private spinner: SpinnerStateService,\r\n    private documentLockingService: DocumentLockingService,\r\n    public userStateService: UserStateService,\r\n    private selectedItemsService: SelectedItemsService\r\n  ) {\r\n    this.subscriptions = new Subscription();\r\n\r\n    effect(() => {\r\n      const nativeScrollElement = this.cdkScrollElement()?.elementRef.nativeElement;\r\n      if (!nativeScrollElement) return;\r\n\r\n      const last = nativeScrollElement.lastElementChild;\r\n      if (nativeScrollElement.firstElementChild && last) {\r\n        nativeScrollElement.replaceChild(nativeScrollElement.firstElementChild, nativeScrollElement.lastElementChild);\r\n        nativeScrollElement.insertBefore(last, nativeScrollElement.firstElementChild);\r\n      }\r\n    });\r\n  }\r\n\r\n  ngOnInit() {\r\n    this.subscriptions.add(this.documentLockingService.lockStatusChanged.subscribe(this.lockStatusChanged));\r\n\r\n    this.subscriptions.add(\r\n      this.captureUpdate.onChangeDocument.subscribe((doc) => {\r\n        this.documentLocked = false;\r\n        this.selectedDocument = doc;\r\n        this.emptyLinesShouldBeRemoved = true;\r\n      })\r\n    );\r\n\r\n    this.subscriptions.add(\r\n      this.captureUpdate.onUpdateLineItemTableHead.subscribe((header) => {\r\n        this.isInitialized = true;\r\n        this.lineItemMetaDataId = header.id;\r\n        this.lineItemMetaDataName = header.name;\r\n        this.lineItemMDD = header.columns;\r\n        this.headerLabel = header.label;\r\n        if (!this.cdr['destroyed']) {\r\n          this.cdr.detectChanges();\r\n        }\r\n      })\r\n    );\r\n\r\n    this.subscriptions.add(\r\n      this.captureUpdate.onUpdateLineItemTableBody.subscribe((event: UpdateLineItemsEvent) => {\r\n        if (this.loadingDefaultValues) {\r\n          console.log('waiting for loading default values');\r\n\r\n          this.addNewLineItemSubject\r\n            .subscribe(() => {\r\n              this.updateLineItems(event);\r\n            })\r\n            .unsubscribe();\r\n        } else {\r\n          this.updateLineItems(event);\r\n        }\r\n      })\r\n    );\r\n\r\n    this.subscriptions.add(\r\n      this.indexingService.onTakeFocus.subscribe((panel: number) => {\r\n        if (panel !== this.lineItemPanel) {\r\n          this.delay.execute(this.reset, 10);\r\n        }\r\n      })\r\n    );\r\n\r\n    this.subscriptions.add(\r\n      this.indexingService.onChangeCurrentFieldValue.subscribe((valueObj: ValueObj) => {\r\n        if (valueObj.panel === this.lineItemPanel) {\r\n          const mdd = new MetaDataDefinition(this.lineItemMDD[this.selectedCellIndex]);\r\n\r\n          this.value = valueObj.updateFieldData.value;\r\n          this.setFieldValue(this.selectedRowIndex, mdd, this.value, true);\r\n        }\r\n      })\r\n    );\r\n\r\n    this.subscriptions.add(\r\n      this.indexingService.onFillGroupOfValues.subscribe((groupOfFieldsValuesObj: GroupOfValuesObj) => {\r\n        if (this.lineItemMDD[this.selectedCellIndex].type === MetaDataType.LargeText) {\r\n          this.setFieldValue(\r\n            this.selectedRowIndex,\r\n            this.lineItemMDD[this.selectedCellIndex],\r\n            groupOfFieldsValuesObj.UpdateGroupOfFields.values.join('\\n'),\r\n            true\r\n          );\r\n          return;\r\n        }\r\n\r\n        this.mapGroupOfValues(groupOfFieldsValuesObj.UpdateGroupOfFields.values);\r\n      })\r\n    );\r\n\r\n    this.onChangedSelectedItems();\r\n    this.subscriptions.add(this.selectedItemsService.onChangeSelectedItems.subscribe(this.onChangedSelectedItems));\r\n  }\r\n\r\n  ngAfterViewInit(): void {\r\n    this.addStopWritingInFieldsWhileLoadingListener();\r\n  }\r\n\r\n  ngAfterViewChecked(): void {\r\n    this.setVirtualScrollViewportStyles();\r\n  }\r\n\r\n  addStopWritingInFieldsWhileLoadingListener = () => {\r\n    const spinnerElement = this.getLineItemIndexingElement();\r\n    if (!spinnerElement) return;\r\n\r\n    this.subscriptions.add(fromEvent(spinnerElement, 'keydown').subscribe(this.stopWritingInFieldsWhileLoading));\r\n  };\r\n\r\n  stopWritingInFieldsWhileLoading = (event: Event) => {\r\n    if (!this.isBusy) return;\r\n\r\n    event.preventDefault();\r\n    event.stopPropagation();\r\n    return false;\r\n  };\r\n\r\n  onChangedSelectedItems = () => {\r\n    this.oneDocumentSelected = this.selectedItemsService.isOneDocumentSelected();\r\n  };\r\n\r\n  private updateLineItems(event: UpdateLineItemsEvent) {\r\n    const valuesWithValidLocation: Array<ValueLocation> = [];\r\n    if (!this.lineItemChanged(event.body)) return;\r\n    this.lineItems = event.body;\r\n    if (this.emptyLinesShouldBeRemoved) this.removeEmptyLines();\r\n    this.updateLineItemsReference();\r\n    this.lineItems.forEach((row, rowIndex) => {\r\n      row.metadata.forEach((item) => {\r\n        this.lineItemMDD.forEach((mdd, itemIndex) => {\r\n          if (item.location && item.name === mdd.name.toLowerCase()) {\r\n            const { location, validity } = item;\r\n            const fieldId = this.getFieldId(mdd.id, rowIndex, itemIndex);\r\n            valuesWithValidLocation.push({ fieldId: fieldId, location: location, validity: validity });\r\n          }\r\n        });\r\n      });\r\n    });\r\n    this.captureUpdate.hasValuesWithValidLocation(valuesWithValidLocation);\r\n  }\r\n\r\n  lineItemChanged = (updatedLineItem: MetaDataLineItems): boolean => {\r\n    if (!updatedLineItem && !this.lineItems) return false;\r\n    if ((!updatedLineItem && this.lineItems) || (updatedLineItem && !this.lineItems)) return true;\r\n\r\n    const currentItems = [...this.lineItems];\r\n    for (let i = 0; i < updatedLineItem.length; i++) {\r\n      const index = currentItems.findIndex((x) => this.getRowKey(x) == this.getRowKey(updatedLineItem[i]));\r\n      if (index == -1) return true;\r\n\r\n      currentItems.splice(index, 1);\r\n    }\r\n\r\n    for (let i = 0; i < currentItems.length; i++) {\r\n      if (this.getRowKey(currentItems[i]) != this.defaultRowValues) return true;\r\n    }\r\n\r\n    return false;\r\n  };\r\n\r\n  getRowKey = (row: MetaDataCollection): string => {\r\n    return JSON.stringify(row.metadata.map((x) => `${x.name}_${x.value}_${x.validity}`).sort());\r\n  };\r\n\r\n  ngOnDestroy() {\r\n    this.subscriptions.unsubscribe();\r\n  }\r\n\r\n  removeEmptyLines = (): void => {\r\n    this.lineItems = this.lineItems.filter(\r\n      (x) => x.metadata.length > 0 && x.metadata.filter((y) => y.value != '').length > 0\r\n    ) as MetaDataLineItems;\r\n    this.emptyLinesShouldBeRemoved = false;\r\n  };\r\n\r\n  lockStatusChanged = (ls: LockStatus): void => {\r\n    if (!this.selectedDocument || !this.selectedDocument.workitem) return;\r\n\r\n    if (ls.id == this.selectedDocument.workitem.id) {\r\n      this.documentLocked = ls.locked && ls.lockedByUserId == this.userStateService.user.id && !ls.expired();\r\n    }\r\n  };\r\n\r\n  reset = () => {\r\n    this.value = '';\r\n    this.selectedRowIndex = null;\r\n    this.selectedCellIndex = null;\r\n  };\r\n\r\n  onAddClicked(): void {\r\n    this.addItem(true);\r\n  }\r\n\r\n  addItem(saveValues = false): Promise<void> {\r\n    this.loadingDefaultValues = true;\r\n    this.showSpinner('Indexing.loading-line-items-defaults');\r\n\r\n    return this.getLineItemDefaults()\r\n      .then((mdDic) => {\r\n        const mdc = new MetaDataCollection(mdDic);\r\n        this.addMetaDataCollectionRow(mdc, saveValues);\r\n        this.defaultRowValues = this.getRowKey(mdc);\r\n\r\n        this.hideSpinner();\r\n        this.cdr.detectChanges();\r\n        this.loadingDefaultValues = false;\r\n        this.addNewLineItemSubject.next(true);\r\n      })\r\n      .catch((err) => {\r\n        this.toastr.error(this.translate.instant('Indexing.line-items-defaults-load-error'));\r\n\r\n        const mdc = new MetaDataCollection();\r\n        for (let i = 0; i < this.lineItemMDD.length; i++) {\r\n          mdc.set(this.lineItemMDD[i].name, '', MetaDataValidity.unknown);\r\n        }\r\n\r\n        this.addMetaDataCollectionRow(mdc);\r\n\r\n        this.hideSpinner();\r\n        this.cdr.detectChanges();\r\n        this.loadingDefaultValues = false;\r\n        this.addNewLineItemSubject.next(true);\r\n      });\r\n  }\r\n\r\n  showSpinner(msg: string) {\r\n    this.isBusy = true;\r\n    const spinnerElement = this.getLineItemIndexingElement();\r\n\r\n    this.spinner.show(this.translate.instant(msg), spinnerElement);\r\n  }\r\n\r\n  getLineItemIndexingElement = (): HTMLElement => {\r\n    return document.getElementById('line-item-indexing');\r\n  };\r\n\r\n  hideSpinner = (): void => {\r\n    this.isBusy = false;\r\n    this.spinner.hide();\r\n  };\r\n\r\n  getLineItemDefaults(): Promise<MetaDataCollectionDictionary> {\r\n    return new Promise((resolve, reject) => {\r\n      this.hydraApi.getLineItemDefaults(\r\n        this.capture.getCurrentWorkItem().id,\r\n        this.lineItemMetaDataId,\r\n        (metadataDic: MetaDataCollectionDictionary) => {\r\n          resolve(metadataDic);\r\n        },\r\n        (err) => {\r\n          reject(err);\r\n        }\r\n      );\r\n    });\r\n  }\r\n\r\n  getColumns = (): IMetaDataDefinition[] => {\r\n    const columns: IMetaDataDefinition[] = [];\r\n    this.lineItemMDD.forEach((x) => {\r\n      if (x.type == MetaDataType.CascadingOptions) {\r\n        ((x as MetaDataDefinition).dataSource as MetaDataCascadingOptionsDataSource).dataSet.forEach((o) => {\r\n          const optionMDD = this.userStateService.findMetaDataById(o.metaDataId);\r\n          columns.push(optionMDD);\r\n        });\r\n        return;\r\n      }\r\n\r\n      columns.push(x);\r\n    });\r\n\r\n    return columns;\r\n  };\r\n\r\n  getColSpan = (mdd: IMetaDataDefinition): number => {\r\n    if (mdd.type == MetaDataType.CascadingOptions)\r\n      return ((mdd as MetaDataDefinition).dataSource as MetaDataCascadingOptionsDataSource).dataSet.length;\r\n\r\n    return 1;\r\n  };\r\n\r\n  addMetaDataCollectionRow(mdc: MetaDataCollection, saveValues: boolean = false): void {\r\n    mdc.placeholder = true;\r\n    this.lineItems.push(mdc);\r\n    this.updateLineItemsReference();\r\n    this.cdr.detectChanges();\r\n    this.virtualScrollViewport.scrollToIndex(this.lineItems.length - 1);\r\n    this.selectCell(0, this.lineItems.length - 1);\r\n\r\n    const selectedMdd = this.lineItemMDD[this.selectedCellIndex];\r\n\r\n    if (saveValues) {\r\n      this.setFieldValue(this.lineItems.length - 1, selectedMdd, mdc.metadata[this.selectedCellIndex].value, false);\r\n    }\r\n\r\n    this.emitCurrentCellChange(selectedMdd.name);\r\n  }\r\n\r\n  selectCell(cellIndex: number, rowIndex: number, mdd?: IMetaDataDefinition, item?: MetaDataCollection) {\r\n    this.value = '';\r\n\r\n    let tempFieldId: string;\r\n\r\n    if (mdd && item) {\r\n      const location = this.getValueLocation(item, mdd);\r\n      if (location && location.valid) {\r\n        tempFieldId = this.getFieldId(mdd.id, rowIndex, cellIndex);\r\n      }\r\n    }\r\n\r\n    this.captureUpdate.zoomIntoValue(tempFieldId);\r\n    this.selectedRowIndex = rowIndex;\r\n    this.selectedCellIndex = cellIndex;\r\n    this.emitCurrentCellChange(this.lineItemMDD[cellIndex].name);\r\n  }\r\n\r\n  moveToNextCell(): Promise<void> {\r\n    this.value = '';\r\n\r\n    if (this.selectedCellIndex === this.lineItemMDD.length - 1) {\r\n      if (this.selectedRowIndex === this.lineItems.length - 1) {\r\n        return this.addItem();\r\n      } else {\r\n        this.selectedRowIndex += 1;\r\n        this.selectedCellIndex = 0;\r\n      }\r\n    } else {\r\n      this.selectedCellIndex += 1;\r\n    }\r\n\r\n    return Promise.resolve();\r\n  }\r\n\r\n  moveToPreviousCell() {\r\n    this.value = '';\r\n\r\n    if (this.selectedCellIndex === 0) {\r\n      if (this.selectedRowIndex === 0) {\r\n        this.selectedCellIndex = this.lineItemMDD.length - 1;\r\n        this.selectedRowIndex = this.lineItems.length - 1;\r\n      } else {\r\n        this.selectedRowIndex -= 1;\r\n        this.selectedCellIndex = this.lineItemMDD.length - 1;\r\n      }\r\n    } else {\r\n      this.selectedCellIndex -= 1;\r\n    }\r\n  }\r\n\r\n  emitCurrentCellChange(label: string) {\r\n    this.indexingService.changeCurrentField(this.lineItemPanel, label);\r\n  }\r\n\r\n  confirmDelete(itemIndex: number): void {\r\n    this.toBeDeletedIndex = itemIndex;\r\n\r\n    this.ngxSmartModalService.setModalData(\r\n      {\r\n        title: 'MainHeader.ActionConfirmation',\r\n        text: this.translate.instant('Document_Capture.Confirm_Delete_Line_Item'),\r\n        buttonText: this.translate.instant('Common.Delete'),\r\n        confirm: this.confirmedDelete,\r\n        cancel: this.cancelDelete,\r\n      },\r\n      'actionConfirmModal',\r\n      true\r\n    );\r\n\r\n    this.ngxSmartModalService.getModal('actionConfirmModal').open();\r\n  }\r\n\r\n  confirmedDelete = () => {\r\n    this.ngxSmartModalService.getModal('actionConfirmModal').close();\r\n    this.deleteItem(this.toBeDeletedIndex);\r\n    this.toBeDeletedIndex = null;\r\n  };\r\n\r\n  cancelDelete = () => {\r\n    this.ngxSmartModalService.getModal('actionConfirmModal').close();\r\n    this.toBeDeletedIndex = null;\r\n  };\r\n\r\n  private deleteItem(itemIndex: number) {\r\n    this.lineItems.splice(itemIndex, 1);\r\n    this.updateLineItemsReference();\r\n\r\n    this.showSpinner('Indexing.saving-items');\r\n    this.capture\r\n      .saveLineItems(this.lineItems)\r\n      .then(this.hideSpinner, this.hideSpinner)\r\n      .then(() => {\r\n        if (this.lineItems.length) {\r\n          if (this.selectedRowIndex === itemIndex) {\r\n            if (itemIndex >= this.lineItems.length) {\r\n              this.selectedRowIndex -= 1;\r\n            }\r\n\r\n            this.selectedCellIndex = 0;\r\n          } else if (this.selectedRowIndex > itemIndex) {\r\n            this.selectedRowIndex -= 1;\r\n          }\r\n\r\n          this.cdr.detectChanges();\r\n          this.virtualScrollViewport.scrollToIndex(itemIndex);\r\n        }\r\n\r\n        if (!this.lineItems.length) {\r\n          this.indexingService.takeFocus(IndexingPanels['AdvancedIndexing']);\r\n        }\r\n      });\r\n  }\r\n\r\n  onBlur(value: any, item: MetaDataCollection, mdd: IMetaDataDefinition, itemIndex: number) {\r\n    event?.preventDefault();\r\n    const shouldAddItem = (event as any)?.relatedTarget?.id == 'addLineItemButton';\r\n\r\n    if (value instanceof BlurEvent) {\r\n      mdd = value.mdd ?? mdd;\r\n      value = value.value;\r\n    }\r\n\r\n    this.checkValues(value, item, mdd, itemIndex, false, shouldAddItem);\r\n  }\r\n\r\n  onTab(value: any, item: MetaDataCollection, mdd: IMetaDataDefinition, itemIndex: number) {\r\n    event?.preventDefault();\r\n\r\n    let checkValues: Promise<any>;\r\n\r\n    if (value instanceof BlurEvent) {\r\n      checkValues = this.checkValues(value.value, item, value.mdd ? value.mdd : mdd, itemIndex);\r\n    } else {\r\n      checkValues = this.checkValues(value, item, mdd, itemIndex);\r\n    }\r\n\r\n    if (checkValues) {\r\n      checkValues.then(() => {\r\n        return this.moveToNextCell();\r\n      });\r\n    } else {\r\n      this.moveToNextCell()\r\n        .then(() => {})\r\n        .catch(() => {});\r\n    }\r\n  }\r\n\r\n  onShiftTab(value: string, item: MetaDataCollection, mdd: IMetaDataDefinition, itemIndex: number) {\r\n    event?.preventDefault();\r\n\r\n    this.checkValues(value, item, mdd, itemIndex);\r\n    this.moveToPreviousCell();\r\n  }\r\n\r\n  onReturn(value: string, item: MetaDataCollection, mdd: IMetaDataDefinition, rowIndex: number, cellIndex: number) {\r\n    item.set(mdd.name, value, MetaDataValidity.unknown);\r\n\r\n    this.checkValues(value, item, mdd, rowIndex, true).then(() => {\r\n      this.captureUpdate.changeValueValidity({ id: mdd.id + rowIndex + cellIndex, validity: MetaDataValidity.valid });\r\n    });\r\n  }\r\n\r\n  checkValues(\r\n    value: string,\r\n    item: MetaDataCollection,\r\n    mdd: IMetaDataDefinition,\r\n    itemIndex: number,\r\n    force: boolean = false,\r\n    addNewLineItem = false\r\n  ) {\r\n    const prevValue = this.getFieldValue(item, mdd);\r\n    const isSuspiciousField = this.getValidity(item, mdd) === MetaDataValidity.suspicious;\r\n\r\n    if (!this.isEqual(value, prevValue as string) || force || isSuspiciousField) {\r\n      return this.setFieldValue(itemIndex, mdd, value, false, 0, addNewLineItem);\r\n    }\r\n  }\r\n\r\n  isEqual(value1: string, value2: string): boolean {\r\n    if (typeof value1 != 'string' || typeof value2 != 'string') return false;\r\n    return value1.replace(/\\n/g, '') === value2.replace(/\\n/g, '');\r\n  }\r\n\r\n  getFieldDefinition(mdd: IMetaDataDefinition): FieldDefinition {\r\n    const fd = (mdd as MetaDataDefinition).asFieldDefinition();\r\n    fd.datasource = FieldDataSource.create(mdd as MetaDataDefinition, this.hydraApi);\r\n    fd.label = '';\r\n    fd.displayMode = FieldDisplayMode.grid;\r\n\r\n    return fd;\r\n  }\r\n\r\n  getFieldValue(item: MetaDataCollection, mdd: IMetaDataDefinition): string {\r\n    if (!item) return '';\r\n\r\n    const md = item.get(mdd.name);\r\n    if (!md) return '';\r\n\r\n    return `${md.value}`;\r\n  }\r\n\r\n  getValueLocation(item: MetaDataCollection, mdd: IMetaDataDefinition): ILocation {\r\n    if (!item) {\r\n      return null;\r\n    }\r\n\r\n    const md = item.get(mdd.name);\r\n    if (!md) {\r\n      return null;\r\n    }\r\n\r\n    return md.location;\r\n  }\r\n\r\n  setFieldValue(\r\n    itemIndex: number,\r\n    mdd: IMetaDataDefinition,\r\n    value: any,\r\n    moveNext: boolean,\r\n    counter: number = 0,\r\n    addNewLineItem = false\r\n  ) {\r\n    // copy the current line items to be saved when validation returns\r\n    // this way it preserves the instantly created row\r\n    const currentWorkItem: WorkItem = Object.assign({}, this.capture.getCurrentWorkItem());\r\n    const currentLineItems = new MetaDataLineItems();\r\n    currentLineItems.push(...this.lineItems);\r\n    const item = currentLineItems[itemIndex];\r\n\r\n    if (!item) {\r\n      if (counter > 10) {\r\n        this.hideSpinner();\r\n        return;\r\n      }\r\n\r\n      this.addItem().then(() => this.setFieldValue(itemIndex, mdd, value, moveNext, ++counter, addNewLineItem));\r\n      this.hideSpinner();\r\n      return;\r\n    }\r\n\r\n    const md = item.get(mdd.name);\r\n    if (!md) {\r\n      this.hideSpinner();\r\n      return;\r\n    }\r\n\r\n    md.validity = MetaDataValidity.unknown;\r\n\r\n    if (mdd.type === MetaDataType.Lookup) {\r\n      this.hideSpinner();\r\n      return;\r\n    }\r\n\r\n    this.showSpinner('Indexing.validating-items');\r\n    return this.capture\r\n      .validateLineItemValue(mdd, value, true)\r\n      .then((metadata: IMetaData) => {\r\n        item.set(mdd.name, metadata.value as string, metadata.validity);\r\n        this.showSpinner('Indexing.saving-items');\r\n        return this.capture\r\n          .saveLineItems(currentLineItems, currentWorkItem)\r\n          .then(() => {\r\n            if (currentWorkItem.id === this.capture.getCurrentWorkItem().id && moveNext) {\r\n              return this.moveToNextCell().then(() => {\r\n                this.hideSpinner();\r\n              });\r\n            } else if (addNewLineItem) {\r\n              return this.addItem(true).then(() => {\r\n                this.hideSpinner();\r\n              });\r\n            } else {\r\n              this.hideSpinner();\r\n            }\r\n          }, this.hideSpinner)\r\n          .catch((err) => {\r\n            console.log(err);\r\n            this.hideSpinner();\r\n          })\r\n          .then(this.hideSpinner);\r\n      }, this.hideSpinner)\r\n      .catch((err) => {\r\n        console.log(err);\r\n        this.hideSpinner();\r\n      })\r\n      .then(this.hideSpinner)\r\n      .catch(this.hideSpinner);\r\n  }\r\n\r\n  shouldValueBeSet(rowIndex: number, cellIndex: number): string {\r\n    if (rowIndex === this.selectedRowIndex && cellIndex === this.selectedCellIndex) return this.value;\r\n\r\n    return '';\r\n  }\r\n\r\n  mapGroupOfValues(values: Array<string>) {\r\n    const currentSelectedRowIndex = this.selectedRowIndex;\r\n    const existingItems = this.lineItems.slice(currentSelectedRowIndex);\r\n\r\n    if (existingItems.length < values.length) {\r\n      this.showSpinner('Indexing.loading-line-items-defaults');\r\n\r\n      this.getLineItemDefaults()\r\n        .then((defaultLineItem: MetaDataCollectionDictionary) => {\r\n          this.hideSpinner();\r\n\r\n          for (let i = existingItems.length; i < values.length; i++) {\r\n            this.lineItems.push(new MetaDataCollection(defaultLineItem));\r\n          }\r\n\r\n          this.updateLineItemsReference();\r\n\r\n          this.applyColumnMetaDataValues(values, currentSelectedRowIndex);\r\n        })\r\n        .catch((err) => {\r\n          this.hideSpinner();\r\n\r\n          this.toastr.error(this.translate.instant('Indexing.line-items-defaults-load-error'));\r\n        });\r\n    } else {\r\n      this.applyColumnMetaDataValues(values, currentSelectedRowIndex);\r\n    }\r\n  }\r\n\r\n  applyColumnMetaDataValues = (values: Array<string>, oldSelectedRowIndex: number): void => {\r\n    const promises = [];\r\n    for (let i = 0; i < values.length; i++) {\r\n      promises.push(\r\n        this.setFieldValue(\r\n          this.selectedRowIndex + i,\r\n          new MetaDataDefinition(this.lineItemMDD[this.selectedCellIndex]),\r\n          values[i],\r\n          false\r\n        )\r\n      );\r\n    }\r\n\r\n    Promise.all(promises).then(async () => {\r\n      this.value = values[0];\r\n      if (this.lineItemMDD[this.selectedCellIndex].type !== MetaDataType.Lookup) {\r\n        this.selectedRowIndex = oldSelectedRowIndex;\r\n        await this.moveToNextCell();\r\n      }\r\n\r\n      this.cdr.detectChanges();\r\n    });\r\n  };\r\n\r\n  getValidity(item: MetaDataCollection, mdd: IMetaDataDefinition): MetaDataValidity {\r\n    if (!item) {\r\n      return null;\r\n    }\r\n\r\n    const md = item.get(mdd.name);\r\n    if (!md) {\r\n      return null;\r\n    }\r\n\r\n    return md.validity;\r\n  }\r\n\r\n  onScroll() {\r\n    this.dropDown.scrolled();\r\n  }\r\n\r\n  onSaveLookupValues(event: SaveLookupsEvent, index: number) {\r\n    const item = this.lineItems[index];\r\n\r\n    event.lookups.forEach((lookup) => {\r\n      if (!lookup.overwrite) {\r\n        if (item.get(lookup.metadata.name).value) {\r\n          return;\r\n        }\r\n      }\r\n\r\n      item.set(lookup.metadata.name, lookup.value, lookup.validity);\r\n    });\r\n\r\n    this.showSpinner('Indexing.saving-items');\r\n    this.hydraApi.validateAndUpdateBulkMetadata(\r\n      new BulkValidationRequest(\r\n        item.serializable(),\r\n        event.lookups.map((x) => x.metaDataId),\r\n        true\r\n      ),\r\n      (mdc: MetaDataCollection) => this.onRowValidationSucceed(mdc, event, index),\r\n      this.onRowValidationFailed\r\n    );\r\n  }\r\n\r\n  onRowValidationSucceed = (mdc: MetaDataCollection, event: SaveLookupsEvent, index: number): void => {\r\n    this.lineItems[index] = mdc;\r\n    this.updateLineItemsReference();\r\n\r\n    this.capture.saveLineItems(this.lineItems).then(() => {\r\n      if (event.move) {\r\n        if (event.forward) {\r\n          this.moveToNextCell().then(() => this.hideSpinner());\r\n        } else {\r\n          this.moveToPreviousCell();\r\n          this.hideSpinner();\r\n        }\r\n      } else {\r\n        this.hideSpinner();\r\n      }\r\n    });\r\n  };\r\n\r\n  onRowValidationFailed = (err: any): void => {\r\n    this.hideSpinner();\r\n    Log.error('LineItemIndexingComponent.onRowValidationFailed', err);\r\n  };\r\n\r\n  getContext(): any {\r\n    return this.capture.getCurrentWorkItem();\r\n  }\r\n\r\n  showTotalsRow = (): boolean => {\r\n    if (!this.lineItemMDD) return false;\r\n\r\n    for (let i = 0; i < this.lineItemMDD.length; i++) {\r\n      if (this.canCalculateTotal(i)) return true;\r\n    }\r\n\r\n    return false;\r\n  };\r\n\r\n  canCalculateTotal = (cellIndex: number): boolean => {\r\n    if (!this.lineItems || this.lineItems.length == 0) return false;\r\n    if (!this.lineItemMDD || cellIndex >= this.lineItemMDD.length || cellIndex < 0) return false;\r\n\r\n    const mdd = this.lineItemMDD[cellIndex];\r\n\r\n    if (!mdd) return false;\r\n    if (this.allowedTypesForTotals.findIndex((x) => x == mdd.type) == -1) return false;\r\n\r\n    const lic = this.getLineItemConfigById(mdd.id);\r\n    if (!lic.showTotal) return false;\r\n\r\n    return true;\r\n  };\r\n\r\n  getLineItemConfigById = (metaDataId: string): LineItemConfiguration => {\r\n    const mdd = this.userStateService.findMetaDataById(this.lineItemMetaDataId);\r\n\r\n    if (!mdd) return null;\r\n    if (!(mdd as MetaDataDefinition).lineItemConfigurations) return null;\r\n\r\n    return (mdd as MetaDataDefinition).lineItemConfigurations.find((x) => x.metaDataId == metaDataId);\r\n  };\r\n\r\n  getColumnTotalText = (cellIndex: number): string => {\r\n    const total = this.getColumnTotal(cellIndex);\r\n    let text = total.toString();\r\n\r\n    if (this.hasCompareToField(cellIndex)) {\r\n      const compareToValue = this.getCompareToValue(cellIndex);\r\n      const op = total == compareToValue ? '=' : '<>';\r\n      const compareToFieldName = this.getCompareToField(cellIndex).label;\r\n\r\n      text += `   ${op} ${compareToFieldName} (${compareToValue})`;\r\n    }\r\n\r\n    return text;\r\n  };\r\n\r\n  getColumnTotal = (cellIndex: number): number => {\r\n    if (!this.lineItems || !this.lineItemMDD || cellIndex >= this.lineItemMDD.length || cellIndex < 0) return 0;\r\n\r\n    let total = 0;\r\n    const mdd = this.lineItemMDD[cellIndex];\r\n    this.lineItems.forEach((row) => {\r\n      row.metadata.forEach((item) => {\r\n        if (item.name != mdd.name.toLocaleLowerCase()) return;\r\n\r\n        total += parseFloat(item.value.toString()) || 0;\r\n      });\r\n    });\r\n\r\n    return total;\r\n  };\r\n\r\n  getCompareToValue = (cellIndex: number): number => {\r\n    const mdd = this.getCompareToField(cellIndex);\r\n    if (!mdd) return 0;\r\n\r\n    const mdc = this.capture.getMetaDataCollection();\r\n    if (!mdc) return 0;\r\n\r\n    const md = mdc.get(mdd.name);\r\n    if (!md || !md.value) return 0;\r\n\r\n    return parseFloat(md.value.toString()) || 0;\r\n  };\r\n\r\n  hasCompareToField = (cellIndex: number): boolean => {\r\n    return this.getCompareToField(cellIndex) != null;\r\n  };\r\n\r\n  getCompareToField = (cellIndex: number): IMetaDataDefinition => {\r\n    if (!this.canCalculateTotal(cellIndex)) return null;\r\n\r\n    const mdd = this.lineItemMDD[cellIndex];\r\n    if (!mdd) return null;\r\n    const lic = this.getLineItemConfigById(mdd.id);\r\n    if (!lic) return null;\r\n\r\n    return this.userStateService.findMetaDataById(lic.compareToMetaDataId);\r\n  };\r\n\r\n  trackLineItemById(index: number, item: MetaDataCollection): string {\r\n    return item.id;\r\n  }\r\n\r\n  getFieldId = (id: string, row: number, cell: number): string => {\r\n    return `${id}-${row}-${cell}`;\r\n  };\r\n\r\n  updateLineItemsReference() {\r\n    const lineItemsCopy = [...this.lineItems];\r\n    this.lineItems = new MetaDataLineItems();\r\n    this.lineItems.push(...lineItemsCopy);\r\n  }\r\n\r\n  setVirtualScrollViewportStyles() {\r\n    const lineItemIndexingWrapper = this.getLineItemIndexingElement();\r\n    if (!lineItemIndexingWrapper) return;\r\n\r\n    const tableWrapperElement = this.tableWrapper?.directiveRef.elementRef.nativeElement as HTMLElement;\r\n    if (!tableWrapperElement) return;\r\n\r\n    const { clientWidth, scrollWidth } = tableWrapperElement;\r\n\r\n    const minimumLineItemsTableWidth = 900;\r\n    const lineItemsHeaderHeight = 30;\r\n\r\n    this.virtualScrollViewportStyles = {\r\n      width: (clientWidth > minimumLineItemsTableWidth ? clientWidth : scrollWidth) + 'px',\r\n      height: lineItemIndexingWrapper.clientHeight - 2 * lineItemsHeaderHeight + 'px',\r\n    };\r\n  }\r\n}\r\n","<section\r\n  class=\"line-item-indexing\"\r\n  id=\"line-item-indexing\"\r\n  [class.disabled]=\"!oneDocumentSelected || !documentLocked || isBusy\"\r\n>\r\n  <div class=\"pannel-header pr-0\">\r\n    <div>{{ headerLabel }}</div>\r\n\r\n    <div class=\"btn-group\" *ngIf=\"isInitialized\">\r\n      <div class=\"d-flex justify-content-center align-items-center\">\r\n        <button\r\n          [disabled]=\"!oneDocumentSelected || loadingDefaultValues\"\r\n          class=\"button-icon\"\r\n          title=\"{{ 'Exceptions_Queue.Add_Item' | translate }}\"\r\n          (click)=\"onAddClicked()\"\r\n          id=\"addLineItemButton\"\r\n        >\r\n          <div class=\"circle d-flex justify-content-center align-items-center\">\r\n            <i class=\"icon-plus\"></i>\r\n          </div>\r\n        </button>\r\n      </div>\r\n    </div>\r\n  </div>\r\n\r\n  <perfect-scrollbar class=\"table-wrapper\" #tableWrapper *ngIf=\"isInitialized\" [config]=\"{ suppressScrollY: true }\">\r\n    <table class=\"line-items-table\">\r\n      <thead class=\"line-items-table-head\">\r\n        <tr>\r\n          <th *ngFor=\"let mdd of getColumns()\" title=\"{{ mdd.label }}\">\r\n            <p class=\"m-1 text-truncate\" [title]=\"mdd.label\">{{ mdd.label }}</p>\r\n          </th>\r\n          <th title=\"{{ 'Common.Actions' | translate }}\" style=\"width: 48px\"></th>\r\n        </tr>\r\n      </thead>\r\n      <tbody class=\"line-items-table-body p-0\" *ngIf=\"lineItems?.length\">\r\n        <cdk-virtual-scroll-viewport\r\n          itemSize=\"46\"\r\n          minBufferPx=\"184\"\r\n          maxBufferPx=\"368\"\r\n          [ngStyle]=\"virtualScrollViewportStyles\"\r\n          (scrolledIndexChange)=\"onScroll()\"\r\n          #virtualScrollViewport\r\n        >\r\n          <tr\r\n            class=\"line-items-table-row\"\r\n            *cdkVirtualFor=\"\r\n              let item of lineItems;\r\n              let rowIndex = index;\r\n              templateCacheSize: 0;\r\n              trackBy: trackLineItemById\r\n            \"\r\n            [class.active]=\"rowIndex === selectedRowIndex\"\r\n          >\r\n            <td\r\n              class=\"line-items-table-data\"\r\n              *ngFor=\"let mdd of lineItemMDD; let cellIndex = index\"\r\n              [class.active]=\"rowIndex === selectedRowIndex && cellIndex === selectedCellIndex\"\r\n              [attr.colspan]=\"getColSpan(mdd)\"\r\n            >\r\n              <app-field\r\n                [field]=\"getFieldDefinition(mdd)\"\r\n                [value]=\"getFieldValue(item, mdd)\"\r\n                [validity]=\"getValidity(item, mdd)\"\r\n                [focused]=\"rowIndex === selectedRowIndex && cellIndex === selectedCellIndex\"\r\n                [fillViaPointAClick]=\"shouldValueBeSet(rowIndex, cellIndex)\"\r\n                [findMetaDataService]=\"userStateService\"\r\n                [metaDataCollection]=\"item\"\r\n                (blurex)=\"onBlur($event, item, mdd, rowIndex)\"\r\n                (focus)=\"selectCell(cellIndex, rowIndex, mdd, item)\"\r\n                (tab)=\"onTab($event, item, mdd, rowIndex)\"\r\n                (shiftTab)=\"onShiftTab($event, item, mdd, rowIndex)\"\r\n                (saveLookupValues)=\"onSaveLookupValues($event, rowIndex)\"\r\n                (return)=\"onReturn($event, item, mdd, rowIndex, cellIndex)\"\r\n              >\r\n              </app-field>\r\n            </td>\r\n            <td class=\"line-items-table-data\" style=\"width: 30px\">\r\n              <div class=\"d-flex justify-content-center align-items-center\">\r\n                <button\r\n                  class=\"button-icon delete-button\"\r\n                  title=\"{{ 'Exceptions_Queue.Delete_Item' | translate }}\"\r\n                  (click)=\"confirmDelete(rowIndex)\"\r\n                >\r\n                  <i class=\"icon-cancel-circle\"></i>\r\n                </button>\r\n              </div>\r\n            </td>\r\n          </tr>\r\n\r\n          <tr class=\"line-items-table-row line-items-totals\" *ngIf=\"showTotalsRow()\">\r\n            <td\r\n              class=\"line-items-table-data\"\r\n              *ngFor=\"let mdd of lineItemMDD; let cellIndex = index\"\r\n              [attr.colspan]=\"getColSpan(mdd)\"\r\n            >\r\n              <div\r\n                *ngIf=\"canCalculateTotal(cellIndex)\"\r\n                [ngClass]=\"{\r\n                  valid: getCompareToField(cellIndex) && getColumnTotal(cellIndex) === getCompareToValue(cellIndex),\r\n                  'not-valid':\r\n                    getCompareToField(cellIndex) && getColumnTotal(cellIndex) !== getCompareToValue(cellIndex)\r\n                }\"\r\n              >\r\n                <app-label [text]=\"getColumnTotalText(cellIndex)\"></app-label>\r\n              </div>\r\n            </td>\r\n            <td class=\"line-items-table-data text-center\" style=\"width: 48px\">{{ 'Common.Total' | translate }}</td>\r\n          </tr>\r\n        </cdk-virtual-scroll-viewport>\r\n      </tbody>\r\n    </table>\r\n  </perfect-scrollbar>\r\n</section>\r\n","import {\r\n  ChangeDetectionStrategy,\r\n  ChangeDetectorRef,\r\n  Component,\r\n  EventEmitter,\r\n  OnDestroy,\r\n  OnInit,\r\n  Output,\r\n  ViewChild,\r\n  ViewEncapsulation,\r\n  isDevMode,\r\n} from '@angular/core';\r\n\r\nimport { TranslateService } from '@ngx-translate/core';\r\nimport { saveAs } from 'file-saver/FileSaver';\r\nimport { PerfectScrollbarDirective } from 'ngx-perfect-scrollbar-portable';\r\nimport { ToastrService } from 'ngx-toastr';\r\n\r\nimport { NgxSmartModalComponent, NgxSmartModalService } from 'ngx-smart-modal';\r\nimport { Subscription } from 'rxjs';\r\nimport {\r\n  Branding,\r\n  CalculationsService,\r\n  FieldDefinition,\r\n  FixedDataSource,\r\n  IFieldOptions,\r\n  MetaDataType,\r\n  RolePermissions,\r\n  UserPreferencesService,\r\n} from 'shared-code-lib';\r\nimport { ICapture } from '../../../blocks/components/document-scanner/models/scanner';\r\nimport { createPDFFromImages } from '../../../blocks/components/document-scanner/utils/pdf';\r\nimport { ISplitButtonItem } from '../../../blocks/components/split-button/split-item';\r\nimport { Action, ActionEvent, FolderActionEvent } from '../../../blocks/core/actions';\r\nimport { Filename } from '../../../blocks/core/fileName';\r\nimport { KeyboardActionMapping } from '../../../blocks/core/keyboardActionMapping';\r\nimport { Log } from '../../../blocks/core/log';\r\nimport { IDocument } from '../../../blocks/models/document';\r\nimport { LockStatus } from '../../../blocks/models/lock-status';\r\nimport { IOutcome } from '../../../blocks/models/outcome';\r\nimport { WorkItem } from '../../../blocks/models/work-item';\r\nimport { Workflow } from '../../../blocks/models/workflow';\r\nimport { WorkflowFolder } from '../../../blocks/models/workflow-folder';\r\nimport { WorkflowStep } from '../../../blocks/models/workflow-step';\r\nimport { ActionService } from '../../../blocks/services/action.service';\r\nimport { ErrorsService } from '../../../blocks/services/errors.service';\r\nimport { HydraApiService } from '../../../blocks/services/hydra-api.service';\r\nimport { InProgressService } from '../../../blocks/services/in-progress.service';\r\nimport { SpinnerStateService } from '../../../blocks/services/spinner-state.service';\r\nimport { UserStateService } from '../../../blocks/services/user-state.service';\r\nimport { Capabilities, Page } from '../capture-models';\r\nimport { CapturedDocument } from '../capture-models/document';\r\nimport {\r\n  DocumentProperties,\r\n  RescanDocument,\r\n  RescanPage,\r\n  ScanAdditionalPages,\r\n  ScanOptions,\r\n  ScanPages,\r\n  ScanToFolder,\r\n  ScanToWorkflow,\r\n} from '../capture-models/scan-commands';\r\nimport { CaptureUpdateService } from '../capture-services/capture-update.service';\r\nimport { DocumentCaptureService } from '../capture-services/document-capture.service';\r\nimport { DocumentLockingService } from '../capture-services/document-locking.service';\r\nimport { SelectedItemsService } from '../capture-services/selected-items.service';\r\n\r\ndeclare const $: any;\r\n\r\ntype ImporterCallback = (files: File[]) => void;\r\n\r\n@Component({\r\n  selector: 'app-toolbar',\r\n  templateUrl: './toolbar.component.html',\r\n  styleUrls: ['./toolbar.component.scss'],\r\n  encapsulation: ViewEncapsulation.None,\r\n  changeDetection: ChangeDetectionStrategy.OnPush,\r\n})\r\nexport class ToolbarComponent implements OnInit, OnDestroy {\r\n  @ViewChild(PerfectScrollbarDirective, { static: true }) directiveRef?: PerfectScrollbarDirective;\r\n  @Output() scan = new EventEmitter<ScanPages>();\r\n  @Output() discardDocuments = new EventEmitter();\r\n  destinations: Array<Workflow>;\r\n  selectedWorkflow: Workflow;\r\n  currentFolder: WorkflowFolder;\r\n  outcomeButtons: Array<IOutcome>;\r\n  currentDocument: CapturedDocument;\r\n  currentPage: Page;\r\n  subscriptions: Subscription;\r\n  scanSplitItems: Array<ISplitButtonItem> = [];\r\n  importSplitItems: Array<ISplitButtonItem> = [];\r\n  captureSplitItems: Array<ISplitButtonItem> = [];\r\n  classNamePrefix = 'project-item-';\r\n\r\n  documentLocked: boolean;\r\n  oneItemSelected: boolean;\r\n  hasSelectedItems: boolean;\r\n\r\n  showScanner: boolean = false;\r\n  isCameraAvailable: boolean = false;\r\n  isProfileAvailable: boolean = true;\r\n\r\n  invokedAction: Action = null;\r\n\r\n  readonly LastSelectedWorfklowId = 'LastSelectedWorkflowId';\r\n\r\n  readonly supportedFileTypes = Filename.supportedFileTypes;\r\n\r\n  captureModal: NgxSmartModalComponent;\r\n\r\n  fieldWorkflow: FieldDefinition;\r\n\r\n  workflowDataSource = new FixedDataSource(new Array<IFieldOptions>());\r\n\r\n  selectedWorkflowId: string;\r\n\r\n  Action = Action;\r\n\r\n  //note: folderEvents solves a chicken-egg problem - do not remove\r\n  constructor(\r\n    public captureService: DocumentCaptureService,\r\n    private toastr: ToastrService,\r\n    private translate: TranslateService,\r\n    private captureUpdate: CaptureUpdateService,\r\n    private cdr: ChangeDetectorRef,\r\n    public ngxSmartModalService: NgxSmartModalService,\r\n    private userState: UserStateService,\r\n    private inProgress: InProgressService,\r\n    private actionService: ActionService,\r\n    private hydraApi: HydraApiService,\r\n    private spinner: SpinnerStateService,\r\n    private documentLockingService: DocumentLockingService,\r\n    private userStateService: UserStateService,\r\n    private calculations: CalculationsService,\r\n    private selectedItemsService: SelectedItemsService,\r\n    private userPreferencesService: UserPreferencesService,\r\n    private ngxSmartModal: NgxSmartModalService,\r\n    private errorService: ErrorsService\r\n  ) {\r\n    this.subscriptions = new Subscription();\r\n  }\r\n\r\n  ngOnInit() {\r\n    this.subscriptions.add(this.documentLockingService.lockStatusChanged.subscribe(this.lockStatusChanged));\r\n\r\n    this.captureService\r\n      .loadWorkFlows()\r\n      .then((workflows: Array<Workflow>) => this.workflowsLoaded(workflows))\r\n      .catch((err: any) => this.loadWorkflowsFailed(err));\r\n\r\n    this.subscriptions.add(this.actionService.onActivateAction.subscribe(this.invokeAction));\r\n\r\n    this.subscriptions.add(\r\n      this.captureUpdate.onChangeFolder.subscribe((folder) => {\r\n        this.currentFolder = folder;\r\n        this.updateUI();\r\n      })\r\n    );\r\n\r\n    this.subscriptions.add(\r\n      this.captureUpdate.onChangeDocument.subscribe((doc) => {\r\n        this.documentLocked = false;\r\n        this.currentDocument = doc;\r\n        this.updateUI();\r\n      })\r\n    );\r\n\r\n    this.subscriptions.add(this.captureUpdate.onParentFolderChanged.subscribe((doc) => (this.currentDocument = doc)));\r\n\r\n    this.subscriptions.add(\r\n      this.captureUpdate.onChangeDocumentPage.subscribe((page) => {\r\n        this.currentPage = page;\r\n        this.updateUI();\r\n      })\r\n    );\r\n\r\n    this.subscriptions.add(\r\n      this.captureUpdate.onChangeOutcomeButtons.subscribe((outcomes) => {\r\n        this.outcomeButtons = this.updateOutcomesKeyboardMapping(outcomes);\r\n        this.detectChanges();\r\n      })\r\n    );\r\n\r\n    this.onChangedSelectedItems();\r\n    this.subscriptions.add(this.selectedItemsService.onChangeSelectedItems.subscribe(this.onChangedSelectedItems));\r\n    this.setCameraAvailability();\r\n  }\r\n\r\n  setCameraAvailability() {\r\n    if (isDevMode) {\r\n      this.isCameraAvailable = true;\r\n      return;\r\n    }\r\n\r\n    navigator.mediaDevices\r\n      .getUserMedia({\r\n        video: true,\r\n      })\r\n      .then(() => {\r\n        this.isCameraAvailable = true;\r\n      })\r\n      .catch(() => {\r\n        this.isCameraAvailable = false;\r\n      });\r\n  }\r\n\r\n  onChangedSelectedItems = () => {\r\n    this.oneItemSelected = this.selectedItemsService.isOneItemSelected();\r\n    this.hasSelectedItems = this.selectedItemsService.hasItemsSelected();\r\n    this.updateUI();\r\n  };\r\n\r\n  lockStatusChanged = (ls: LockStatus): void => {\r\n    if (!this.currentDocument || !this.currentDocument.workitem) return;\r\n\r\n    if (ls.id == this.currentDocument.workitem.id) {\r\n      this.documentLocked = ls.locked && ls.lockedByUserId == this.userStateService.user.id && !ls.expired();\r\n      this.updateUI();\r\n    }\r\n  };\r\n\r\n  updateOutcomesKeyboardMapping(outcomes: IOutcome[]): IOutcome[] {\r\n    for (let i = outcomes.length - 1; i >= 0; i--) {\r\n      const outcomeNumber = outcomes.length - i;\r\n\r\n      const action = this.getOutcomeAction(outcomeNumber);\r\n      if (!action) continue;\r\n\r\n      const mapping = KeyboardActionMapping.getTooltipFor(action, this.translate);\r\n      outcomes[i].label += `${mapping}`;\r\n    }\r\n\r\n    return outcomes;\r\n  }\r\n\r\n  getOutcomeAction(outcomeNumber: number): Action {\r\n    if (outcomeNumber === 1) return Action.Outcome1;\r\n    else if (outcomeNumber === 2) return Action.Outcome2;\r\n    else if (outcomeNumber === 3) return Action.Outcome3;\r\n    else if (outcomeNumber === 4) return Action.Outcome4;\r\n    else return null;\r\n  }\r\n\r\n  updateUI = (): void => {\r\n    this.initializeScanItems();\r\n    this.initializeImportItems();\r\n    this.initializeCaptureItems();\r\n    this.detectChanges();\r\n  };\r\n\r\n  detectChanges = (): void => {\r\n    if (!this.cdr['destroyed']) {\r\n      this.cdr.detectChanges();\r\n    }\r\n  };\r\n\r\n  ngOnDestroy() {\r\n    this.subscriptions.unsubscribe();\r\n  }\r\n\r\n  workflowsLoaded = (workflows: Array<Workflow>) => {\r\n    if (!workflows.length) {\r\n      const noProfilesFound = this.translate.instant('Scanning.NoProfilesFound');\r\n\r\n      this.workflowDataSource.options.push({\r\n        name: noProfilesFound,\r\n        value: '',\r\n      });\r\n\r\n      this.toastr.info(noProfilesFound);\r\n\r\n      this.isProfileAvailable = false;\r\n      if (!this.cdr['destroyed']) this.cdr.detectChanges();\r\n    } else {\r\n      this.destinations = workflows;\r\n      this.isProfileAvailable = true;\r\n      this.destinations.forEach((c) => {\r\n        this.workflowDataSource.options.push({\r\n          name: c.name,\r\n          value: c.id,\r\n        });\r\n      });\r\n\r\n      const lastSelectedWorkflowId = this.userPreferencesService.getPreference(this.LastSelectedWorfklowId);\r\n\r\n      if (lastSelectedWorkflowId) {\r\n        this.selectedWorkflow = this.destinations.find((w) => w.id === lastSelectedWorkflowId) || this.destinations[0];\r\n      } else {\r\n        this.selectedWorkflow = this.destinations[0];\r\n      }\r\n\r\n      this.selectedWorkflowId = this.selectedWorkflow.id;\r\n\r\n      this.createWorkflowsList();\r\n\r\n      this.initializeScanItems();\r\n      this.captureService.setDestination(this.selectedWorkflow);\r\n\r\n      if (!this.cdr['destroyed']) {\r\n        this.cdr.detectChanges();\r\n      }\r\n    }\r\n  };\r\n\r\n  initializeScanItems() {\r\n    this.scanSplitItems = [];\r\n\r\n    const scanToFolder = {\r\n      action: Action.ScanToFolder,\r\n      image: 'assets/icons/icnScanCapture.svg',\r\n      enabled: this.isCaptureFolderOrDocumentSelected() && this.scanningToFolderAllowed() && this.oneItemSelected,\r\n    };\r\n    this.scanSplitItems.push(scanToFolder);\r\n\r\n    const scanNew = {\r\n      action: Action.ScanNew,\r\n      image: '',\r\n      enabled: this.isWorkflowSelected() && this.scanningAllowed(),\r\n    };\r\n    this.scanSplitItems.push(scanNew);\r\n\r\n    const scanMorePages = {\r\n      action: Action.ScanMorePages,\r\n      image: '',\r\n      enabled:\r\n        this.isCaptureDocumentSelected() &&\r\n        this.scanningMorePagesAllowed() &&\r\n        this.documentLocked &&\r\n        this.oneItemSelected,\r\n    };\r\n    this.scanSplitItems.push(scanMorePages);\r\n\r\n    const reScanPage = {\r\n      action: Action.RescanPage,\r\n      image: '',\r\n      enabled:\r\n        this.isCapturePageSelected() && this.rescanningPagesAllowed() && this.documentLocked && this.oneItemSelected,\r\n    };\r\n    this.scanSplitItems.push(reScanPage);\r\n\r\n    const reScanDocument = {\r\n      action: Action.RescanDocument,\r\n      image: '',\r\n      enabled:\r\n        this.isCaptureDocumentSelected() &&\r\n        this.rescanningPagesAllowed() &&\r\n        this.documentLocked &&\r\n        this.oneItemSelected,\r\n    };\r\n    this.scanSplitItems.push(reScanDocument);\r\n  }\r\n\r\n  initializeImportItems() {\r\n    this.importSplitItems = [];\r\n\r\n    const importToFolder = {\r\n      action: Action.ImportToFolder,\r\n      image: 'assets/icons/icnImport.svg',\r\n      enabled: this.isCaptureFolderOrDocumentSelected() && this.importingToFolderAllowed() && this.oneItemSelected,\r\n    };\r\n    this.importSplitItems.push(importToFolder);\r\n\r\n    const importNew = {\r\n      action: Action.ImportNew,\r\n      image: '',\r\n      enabled: this.isWorkflowSelected() && this.importingAllowed(),\r\n    };\r\n    this.importSplitItems.push(importNew);\r\n\r\n    const importMorePages = {\r\n      action: Action.ImportMorePages,\r\n      image: '',\r\n      enabled:\r\n        this.isCaptureDocumentSelected() &&\r\n        this.importingMorePagesAllowed() &&\r\n        this.documentLocked &&\r\n        this.oneItemSelected,\r\n    };\r\n    this.importSplitItems.push(importMorePages);\r\n\r\n    const reimportPage = {\r\n      action: Action.ReimportPage,\r\n      image: '',\r\n      enabled:\r\n        this.isCapturePageSelected() && this.reimportingPagesAllowed() && this.documentLocked && this.oneItemSelected,\r\n    };\r\n    this.importSplitItems.push(reimportPage);\r\n\r\n    const reimportDocument = {\r\n      action: Action.ReimportDocument,\r\n      image: '',\r\n      enabled:\r\n        this.isCaptureDocumentSelected() &&\r\n        this.reimportingPagesAllowed() &&\r\n        this.documentLocked &&\r\n        this.oneItemSelected,\r\n    };\r\n    this.importSplitItems.push(reimportDocument);\r\n  }\r\n\r\n  initializeCaptureItems() {\r\n    this.captureSplitItems = [];\r\n\r\n    const captureToFolder = {\r\n      action: Action.CaptureToFolder,\r\n      image: 'assets/icons/camera-solid.svg',\r\n      enabled: this.isCaptureFolderOrDocumentSelected() && this.importingToFolderAllowed() && this.oneItemSelected,\r\n    };\r\n    this.captureSplitItems.push(captureToFolder);\r\n\r\n    const captureNew = {\r\n      action: Action.CaptureNew,\r\n      image: '',\r\n      enabled: this.isWorkflowSelected() && this.importingAllowed(),\r\n    };\r\n    this.captureSplitItems.push(captureNew);\r\n\r\n    const captureMorePages = {\r\n      action: Action.CaptureMorePages,\r\n      image: '',\r\n      enabled:\r\n        this.isCaptureDocumentSelected() &&\r\n        this.importingMorePagesAllowed() &&\r\n        this.documentLocked &&\r\n        this.oneItemSelected,\r\n    };\r\n    this.captureSplitItems.push(captureMorePages);\r\n\r\n    const recapturePage = {\r\n      action: Action.RecapturePage,\r\n      image: '',\r\n      enabled:\r\n        this.isCapturePageSelected() && this.reimportingPagesAllowed() && this.documentLocked && this.oneItemSelected,\r\n    };\r\n\r\n    this.captureSplitItems.push(recapturePage);\r\n\r\n    const recaptureDocument = {\r\n      action: Action.RecaptureDocument,\r\n      image: '',\r\n      enabled:\r\n        this.isCaptureDocumentSelected() &&\r\n        this.reimportingPagesAllowed() &&\r\n        this.documentLocked &&\r\n        this.oneItemSelected,\r\n    };\r\n\r\n    this.captureSplitItems.push(recaptureDocument);\r\n  }\r\n\r\n  loadWorkflowsFailed = (err: any) => {\r\n    this.toastr.error(this.translate.instant('Common.LoadingDataError'));\r\n\r\n    if (!this.cdr['destroyed']) {\r\n      this.cdr.detectChanges();\r\n    }\r\n  };\r\n\r\n  invokeAction = (event: ActionEvent): void => {\r\n    this.invokedAction = event.action;\r\n\r\n    switch (event.action) {\r\n      case Action.ScanNew:\r\n        this.onScan();\r\n        break;\r\n      case Action.ScanToFolder:\r\n        this.onScanToFolder();\r\n        break;\r\n      case Action.ImportToUnselectedFolder:\r\n        this.onImportToUnSelectedFolder(event as FolderActionEvent, false);\r\n        break;\r\n      case Action.ScanToUnselectedFolder:\r\n        this.onScanToUnSelectedFolder(event as FolderActionEvent);\r\n        break;\r\n      case Action.ScanMorePages:\r\n        this.onScanMorePages();\r\n        break;\r\n      case Action.RescanPage:\r\n        this.onRescanPage();\r\n        break;\r\n      case Action.RescanDocument:\r\n        this.onRescanDocument(event);\r\n        break;\r\n      case Action.ImportToFolder:\r\n        this.onImportToFolder(false);\r\n        break;\r\n      case Action.ImportNew:\r\n        this.onImport(false);\r\n        break;\r\n      case Action.ImportMorePages:\r\n        this.onImportMorePages(false);\r\n        break;\r\n      case Action.ReimportPage:\r\n        this.onReimportPage(false);\r\n        break;\r\n      case Action.ReimportDocument:\r\n        this.onReimportDocument(event, false);\r\n        break;\r\n      case Action.CaptureNew:\r\n        this.onImport(true);\r\n        break;\r\n      case Action.CaptureToFolder:\r\n        this.onImportToFolder(true);\r\n        break;\r\n      case Action.CaptureMorePages:\r\n        this.onImportMorePages(true);\r\n        break;\r\n      case Action.RecapturePage:\r\n        this.onReimportPage(true);\r\n        break;\r\n      case Action.RecaptureDocument:\r\n        this.onReimportDocument(event, true);\r\n        break;\r\n      case Action.Outcome1:\r\n        this.executeOutcome(1);\r\n        break;\r\n      case Action.Outcome2:\r\n        this.executeOutcome(2);\r\n        break;\r\n      case Action.Outcome3:\r\n        this.executeOutcome(3);\r\n        break;\r\n      case Action.Outcome4:\r\n        this.executeOutcome(4);\r\n        break;\r\n      case Action.GenerateRoutingSheet:\r\n        this.executeGenerateRoutingSheet();\r\n        break;\r\n    }\r\n  };\r\n\r\n  executeGenerateRoutingSheet = (): void => {\r\n    if (!this.selectedWorkflow) return;\r\n\r\n    this.spinner.show(\r\n      this.translate.instant('Scanning.generating-workflow-routingsheet'),\r\n      document.getElementById('spinnerPanel')\r\n    );\r\n\r\n    this.hydraApi.workflowGenerateRoutingSheet(\r\n      this.selectedWorkflow.id,\r\n      this.onGeneratedRoutingSheet,\r\n      this.onFailedGenerateRoutingSheet\r\n    );\r\n  };\r\n\r\n  onGeneratedRoutingSheet = (blob): void => {\r\n    this.spinner.hide();\r\n    saveAs(blob, `${this.selectedWorkflow.name}-routingsheet.pdf`);\r\n  };\r\n\r\n  onFailedGenerateRoutingSheet = (): void => {\r\n    this.spinner.hide();\r\n    this.toastr.error(this.translate.instant('Scanning.failed-generate-workflow-routingsheet'));\r\n  };\r\n\r\n  executeOutcome(outcomeNumber: number) {\r\n    if (!this.currentDocument && !this.currentFolderHasItems()) return;\r\n\r\n    const outcomesCount = this.outcomeButtons.length;\r\n    const outcomeIndex = outcomesCount - outcomeNumber;\r\n\r\n    if (outcomeIndex >= 0 && outcomeIndex < outcomesCount) {\r\n      const element = $(':focus');\r\n      element.blur();\r\n      this.onClick(this.outcomeButtons[outcomeIndex]);\r\n    }\r\n  }\r\n\r\n  importer: ImporterCallback;\r\n\r\n  import = (i: ImporterCallback, multiple: boolean, useCamera: boolean): void => {\r\n    this.importer = i;\r\n\r\n    if (!useCamera) {\r\n      this.openFilePicker(multiple);\r\n    } else {\r\n      this.openCaptureModal();\r\n    }\r\n  };\r\n\r\n  openFilePicker(multiple: boolean) {\r\n    const fileInput = document.querySelector('#file') as HTMLInputElement;\r\n    fileInput.multiple = multiple;\r\n    fileInput.click();\r\n  }\r\n\r\n  openCaptureModal() {\r\n    this.captureModal = this.ngxSmartModalService.getModal('CaptureToICModal');\r\n    this.captureModal.open();\r\n    this.showScanner = true;\r\n  }\r\n\r\n  onImport = (useCamera: boolean): void => {\r\n    if (!this.anyImportingAllowed()) return;\r\n\r\n    this.import(\r\n      (files: File[]) => {\r\n        this.captureService.addBatchWithMultipleDocuments(files);\r\n      },\r\n      true,\r\n      useCamera\r\n    );\r\n  };\r\n\r\n  closeCaptureModal() {\r\n    this.showScanner = false;\r\n    this.captureModal?.close();\r\n  }\r\n\r\n  onImportToFolder = (useCamera: boolean): void => {\r\n    if (!this.isCaptureFolderOrDocumentSelected() || !this.importingToFolderAllowed()) return;\r\n\r\n    const currentFolderId = this.currentDocument ? this.currentDocument.parentFolderId : this.currentFolder.id;\r\n    const folder = this.captureService.findFolder(currentFolderId);\r\n    if (!folder) return;\r\n\r\n    if (folder.parentWorkflowFolder == null) {\r\n      this.onImport(useCamera);\r\n    } else {\r\n      this.import(\r\n        (files: File[]) => {\r\n          for (let i = 0; i < files.length; i++) {\r\n            this.captureService.addFiletoFolder(\r\n              files[i],\r\n              Filename.getFileNameWithoutExtension(files[i].name),\r\n              Filename.getFileExtension(files[i].name),\r\n              folder\r\n            );\r\n          }\r\n        },\r\n        true,\r\n        useCamera\r\n      );\r\n    }\r\n  };\r\n\r\n  onImportToUnSelectedFolder(event: FolderActionEvent, useCamera: boolean) {\r\n    this.import(\r\n      (files: File[]) => {\r\n        for (let i = 0; i < files.length; i++) {\r\n          if (event.folder.parentWorkflowFolder == null) {\r\n            this.captureService.addBatchWithMultipleDocuments(files);\r\n          } else {\r\n            this.captureService.addFiletoFolder(\r\n              files[i],\r\n              Filename.getFileNameWithoutExtension(files[i].name),\r\n              Filename.getFileExtension(files[i].name),\r\n              event.folder\r\n            );\r\n          }\r\n        }\r\n      },\r\n      true,\r\n      useCamera\r\n    );\r\n  }\r\n\r\n  onScanToUnSelectedFolder(event: FolderActionEvent) {\r\n    if (event.folder.parentWorkflowFolder == null) {\r\n      this.scan.emit(\r\n        new ScanToWorkflow(\r\n          this.captureService.currentWorkflow.id,\r\n          this.captureService.currentWorkflow.scanSettings,\r\n          new ScanOptions(this.translate.currentLang, true),\r\n          new DocumentProperties()\r\n        )\r\n      );\r\n    } else {\r\n      this.scan.emit(\r\n        new ScanToFolder(\r\n          this.captureService.currentWorkflow.id,\r\n          event.folder.id,\r\n          this.captureService.currentWorkflow.scanSettings\r\n        )\r\n      );\r\n    }\r\n  }\r\n\r\n  onImportMorePages = (useCamera: boolean): void => {\r\n    if (!this.isCaptureDocumentSelected() || !this.importingMorePagesAllowed()) return;\r\n\r\n    const folder = this.captureService.findFolder(this.currentDocument.parentFolderId);\r\n    const result = folder.findDocument(this.currentDocument.id);\r\n\r\n    this.import(\r\n      (files: File[]) => {\r\n        this.captureService.appendPagesToDocument(\r\n          result.workItem,\r\n          result.document,\r\n          files,\r\n          Filename.getFileExtension(files[0].name)\r\n        );\r\n      },\r\n      false,\r\n      useCamera\r\n    );\r\n  };\r\n\r\n  fileListToArray(fileList: FileList) {\r\n    const filesArray = [];\r\n\r\n    for (let i = 0; i < fileList.length; i++) {\r\n      filesArray.push(fileList[i]);\r\n    }\r\n\r\n    return filesArray;\r\n  }\r\n\r\n  onReimportPage = (useCamera: boolean): void => {\r\n    if (!this.isCapturePageSelected() || !this.reimportingPagesAllowed()) return;\r\n\r\n    this.import(\r\n      (files: File[]) => {\r\n        this.captureService.reImportPageToDocument(files[0]);\r\n      },\r\n      false,\r\n      useCamera\r\n    );\r\n  };\r\n\r\n  onReimportDocument(event: ActionEvent, useCamera: boolean) {\r\n    if (event.action === Action.RecaptureDocument) event.action = Action.ReimportDocument;\r\n\r\n    const { workItem, doc } = this.getDocumentAndWorkItemToInvokeAction(event);\r\n    this.import(\r\n      (files: File[]) => {\r\n        this.captureService.replaceDocument(workItem.id, doc.id, files[0], Filename.getFileExtension(files[0].name));\r\n      },\r\n      false,\r\n      useCamera\r\n    );\r\n  }\r\n\r\n  onFilePickerChange() {\r\n    const fileInput = document.querySelector('#file') as HTMLInputElement;\r\n    const files = Array.from(fileInput.files);\r\n\r\n    this.onImportFiles(files);\r\n  }\r\n\r\n  onImportFiles(files: File[]) {\r\n    if (!this.importer) return;\r\n    if (!files.length) return;\r\n\r\n    this.inProgress.open('app-scan.title-import');\r\n    this.importer(files);\r\n    this.importer = null;\r\n  }\r\n\r\n  onFinishCapturing(captures: ICapture[]) {\r\n    this.closeCaptureModal();\r\n    this.onImportFiles([\r\n      createPDFFromImages(\r\n        captures.map((c) => c.capturedImage),\r\n        'document.pdf',\r\n        false\r\n      ),\r\n    ]);\r\n  }\r\n\r\n  onScan = (): void => {\r\n    this.scan.emit(\r\n      new ScanToWorkflow(\r\n        this.captureService.currentWorkflow.id,\r\n        this.captureService.currentWorkflow.scanSettings,\r\n        new ScanOptions(this.translate.currentLang, true),\r\n        new DocumentProperties()\r\n      )\r\n    );\r\n  };\r\n\r\n  onScanToFolder = (): void => {\r\n    if (!this.isCaptureFolderOrDocumentSelected() || !this.scanningToFolderAllowed()) {\r\n      this.captureService.showNoScanFolderError();\r\n      return;\r\n    }\r\n\r\n    const currentFolderId = this.currentDocument ? this.currentDocument.parentFolderId : this.currentFolder.id;\r\n    const folder = this.captureService.findFolder(currentFolderId);\r\n\r\n    if (folder && folder.parentWorkflowFolder == null) {\r\n      this.onScan();\r\n    } else {\r\n      this.scan.emit(\r\n        new ScanToFolder(\r\n          this.captureService.currentWorkflow.id,\r\n          currentFolderId,\r\n          this.captureService.currentWorkflow.scanSettings\r\n        )\r\n      );\r\n    }\r\n  };\r\n\r\n  onScanMorePages = (): void => {\r\n    if (!this.isCaptureDocumentSelected() || !this.scanningMorePagesAllowed()) {\r\n      this.captureService.showNoScanDocumentError();\r\n      return;\r\n    }\r\n\r\n    this.scan.emit(\r\n      new ScanAdditionalPages(\r\n        this.captureService.currentWorkflow.id,\r\n        this.currentDocument.id,\r\n        this.currentDocument.parentFolderId,\r\n        this.captureService.currentWorkflow.scanSettings,\r\n        new ScanOptions(this.translate.currentLang, false),\r\n        new DocumentProperties()\r\n      )\r\n    );\r\n  };\r\n\r\n  onRescanPage = (): void => {\r\n    if (!this.isCapturePageSelected() || !this.rescanningPagesAllowed()) {\r\n      this.captureService.showNoScanPageError();\r\n      return;\r\n    }\r\n\r\n    this.scan.emit(\r\n      new RescanPage(\r\n        this.captureService.currentWorkflow.id,\r\n        this.currentDocument.id,\r\n        this.currentDocument.parentFolderId,\r\n        this.currentPage.order,\r\n        this.captureService.currentWorkflow.scanSettings,\r\n        new ScanOptions(this.translate.currentLang, false),\r\n        new DocumentProperties()\r\n      )\r\n    );\r\n  };\r\n\r\n  onRescanDocument(event: ActionEvent) {\r\n    const { workItem, doc } = this.getDocumentAndWorkItemToInvokeAction(event);\r\n    this.scan.emit(\r\n      new RescanDocument(\r\n        workItem.id,\r\n        doc.id,\r\n        this.captureService.currentWorkflow.scanSettings,\r\n        new ScanOptions(this.translate.currentLang, false),\r\n        new DocumentProperties()\r\n      )\r\n    );\r\n  }\r\n\r\n  getDocumentAndWorkItemToInvokeAction(event: ActionEvent): { doc: IDocument | CapturedDocument; workItem: WorkItem } {\r\n    let workItem: WorkItem;\r\n    let doc: IDocument | CapturedDocument;\r\n\r\n    if (event.documentResult) {\r\n      workItem = event.documentResult.workItem;\r\n      doc = event.documentResult.document;\r\n    } else {\r\n      workItem = this.captureService.getCurrentWorkItem();\r\n      doc = this.captureService.getCurrentDocument();\r\n    }\r\n\r\n    return { doc, workItem };\r\n  }\r\n\r\n  onWorkflowChanged(): void {\r\n    if (!this.destinations.length) {\r\n      return;\r\n    }\r\n\r\n    this.selectedWorkflow = this.destinations.find((w) => w.id === this.selectedWorkflowId);\r\n    this.captureService.setDestination(this.selectedWorkflow);\r\n\r\n    this.userPreferencesService.setPreference(this.LastSelectedWorfklowId, this.selectedWorkflowId);\r\n  }\r\n\r\n  checkIfItemIsNotInViewAndScroll(index: number) {\r\n    const selectedElement = $(`.${this.classNamePrefix + index}`);\r\n    const container = $('.projects-wrapper');\r\n    if (\r\n      selectedElement[0] &&\r\n      container[0] &&\r\n      !this.calculations.isVisibleInScrollableElement(selectedElement, container, false)\r\n    ) {\r\n      this.directiveRef.scrollToElement(`.${this.classNamePrefix + index}`, 0, 100);\r\n    }\r\n  }\r\n\r\n  emptyInputValue(event) {\r\n    event.target.value = null;\r\n  }\r\n\r\n  onClick = (outcome: IOutcome): void => {\r\n    this.captureService.executeOutcome(outcome);\r\n  };\r\n\r\n  discard() {\r\n    this.discardDocuments.emit();\r\n  }\r\n\r\n  anyScanningAllowed = (): boolean => {\r\n    if (\r\n      this.scanningAllowed() ||\r\n      this.rescanningPagesAllowed() ||\r\n      this.scanningMorePagesAllowed() ||\r\n      this.scanningToFolderAllowed()\r\n    )\r\n      return true;\r\n\r\n    return false;\r\n  };\r\n\r\n  anyImportingAllowed = (): boolean => {\r\n    if (\r\n      this.importingAllowed() ||\r\n      this.reimportingPagesAllowed() ||\r\n      this.importingMorePagesAllowed() ||\r\n      this.importingToFolderAllowed()\r\n    )\r\n      return true;\r\n\r\n    return false;\r\n  };\r\n\r\n  isWorkflowSelected = (): boolean => this.selectedWorkflow != null;\r\n\r\n  isCaptureDocumentSelected = (): boolean => this.currentDocument != null;\r\n\r\n  currentStepHasScanCapability = (capability: string): boolean => {\r\n    if (!this.userState.hasRolePermission(RolePermissions.CaptureScan)) return false;\r\n\r\n    const ws = this.getCurrentWorkflowStep();\r\n    if (ws == null) return false;\r\n\r\n    return ws.hasCapability(capability);\r\n  };\r\n\r\n  currentStepHasImportCapability = (capability: string): boolean => {\r\n    if (!this.userState.hasRolePermission(RolePermissions.CaptureImport)) return false;\r\n\r\n    const ws = this.getCurrentWorkflowStep();\r\n    if (ws == null) return false;\r\n\r\n    return ws.hasCapability(capability);\r\n  };\r\n\r\n  getCurrentWorkflowStep = (): WorkflowStep => {\r\n    if (this.currentDocument != null) return this.captureService.getWorkflowStepById(this.currentDocument.parentStepId);\r\n    if (this.currentFolder != null) return this.captureService.getWorkflowStepById(this.currentFolder.workflowStepId);\r\n\r\n    return null;\r\n  };\r\n\r\n  scanningAllowed = (): boolean => this.currentStepHasScanCapability(Capabilities.allowCaptureScan);\r\n\r\n  scanningToFolderAllowed = (): boolean => this.currentStepHasScanCapability(Capabilities.allowCaptureScanToFolder);\r\n\r\n  rescanningPagesAllowed = (): boolean => this.currentStepHasScanCapability(Capabilities.allowCaptureRescanPage);\r\n\r\n  scanningMorePagesAllowed = (): boolean => this.currentStepHasScanCapability(Capabilities.allowCaptureScanMorePages);\r\n\r\n  importingAllowed = (): boolean => this.currentStepHasScanCapability(Capabilities.allowCaptureImport);\r\n\r\n  importingToFolderAllowed = (): boolean => this.currentStepHasScanCapability(Capabilities.allowCaptureImportToFolder);\r\n\r\n  reimportingPagesAllowed = (): boolean => this.currentStepHasScanCapability(Capabilities.allowCaptureReimportPage);\r\n\r\n  importingMorePagesAllowed = (): boolean =>\r\n    this.currentStepHasScanCapability(Capabilities.allowCaptureImportMorePages);\r\n\r\n  canShowQRCode = (): boolean => {\r\n    return (\r\n      this.scanningAllowed() &&\r\n      this.importingAllowed() &&\r\n      this.userState.userProfile.mobileBrand == Branding.IntelligentCapture\r\n    );\r\n  };\r\n\r\n  isCaptureFolderOrDocumentSelected = (): boolean => {\r\n    return this.currentDocument != null || this.currentFolder != null;\r\n  };\r\n\r\n  currentFolderHasItems = (): boolean => {\r\n    if (!this.currentFolder) return false;\r\n    return this.currentFolder.folderHasItems();\r\n  };\r\n\r\n  isCapturePageSelected = (): boolean => {\r\n    if (!this.currentPage || !this.currentDocument) return false;\r\n\r\n    return true;\r\n  };\r\n\r\n  getCurrentWorkflowIndex(): number {\r\n    return this.destinations.findIndex((dist) => dist.id === this.selectedWorkflow.id);\r\n  }\r\n\r\n  generateQRCode = (): void => {\r\n    this.spinner.show(this.translate.instant('qr-code.generating-qr-code'), document.body);\r\n    this.hydraApi.getDocumentCaptureQRCode(this.selectedWorkflow.id, this.qrcodeLoaded, this.qrcodeFailed);\r\n  };\r\n\r\n  qrcodeLoaded = (file: Blob) => {\r\n    file = file.slice(0, file.size, 'image/bmp');\r\n\r\n    var urlCreator = window.URL || window.webkitURL;\r\n    this.ngxSmartModal.setModalData(\r\n      { title: 'qr-code.qr-code-title', imageUrl: urlCreator.createObjectURL(file) },\r\n      'qrCodeModal',\r\n      true\r\n    );\r\n    this.ngxSmartModal.open('qrCodeModal');\r\n    this.spinner.hide();\r\n  };\r\n\r\n  qrcodeFailed = (err: any) => {\r\n    const that = this;\r\n    const reader = new FileReader();\r\n    reader.onload = function () {\r\n      that.spinner.hide();\r\n      const errorMessage = reader.result ? reader.result : that.translate.instant('qr-code.qr-code-failed');\r\n      that.errorService.showErrorsModal([errorMessage], 'qr-code.generate-qr-code');\r\n    };\r\n\r\n    reader.readAsText(err.error);\r\n    Log.error(that.translate.instant('qr-code.qr-code-failed'), err);\r\n  };\r\n\r\n  createWorkflowsList = (): void => {\r\n    this.fieldWorkflow = new FieldDefinition({\r\n      type: MetaDataType.List,\r\n      label: '',\r\n      placeholder: '',\r\n      required: false,\r\n      datasource: this.workflowDataSource,\r\n    });\r\n  };\r\n}\r\n","<div class=\"row document-capture-toolbar\">\r\n  <div class=\"d-flex\">\r\n    <div class=\"form-group d-flex\">\r\n      <label class=\"col-auto p-0 mr-2 col-form-label m-0 d-flex align-items-center\">\r\n        {{ 'Scanning.CaptureProfile' | translate }}\r\n      </label>\r\n      <div class=\"col p-0\">\r\n        <div class=\"input-cont\">\r\n          <app-field\r\n            id=\"workflowDropdown\"\r\n            *ngIf=\"fieldWorkflow && isProfileAvailable\"\r\n            [field]=\"fieldWorkflow\"\r\n            [(value)]=\"selectedWorkflowId\"\r\n            (fieldChanged)=\"onWorkflowChanged()\"\r\n            [disabled]=\"!selectedWorkflow\"\r\n          ></app-field>\r\n          <label *ngIf=\"!isProfileAvailable\" class=\"col-form-label mr-2\">\r\n            {{ 'Scanning.NoProfilesFound' | translate }}\r\n          </label>\r\n        </div>\r\n      </div>\r\n    </div>\r\n    <div class=\"form-group ml-3 split-buttons-container\">\r\n      <app-splitbutton [items]=\"scanSplitItems\" *ngIf=\"anyScanningAllowed()\"></app-splitbutton>\r\n\r\n      <app-splitbutton [items]=\"importSplitItems\" *ngIf=\"anyImportingAllowed()\"></app-splitbutton>\r\n\r\n      <app-splitbutton [items]=\"captureSplitItems\" *ngIf=\"isCameraAvailable && anyImportingAllowed()\"></app-splitbutton>\r\n\r\n      <button\r\n        type=\"button\"\r\n        class=\"button-icon\"\r\n        [disabled]=\"!selectedWorkflow\"\r\n        [class.disabled]=\"!selectedWorkflow\"\r\n        [title]=\"'qr-code.generate-qr-code' | translate\"\r\n        (click)=\"generateQRCode()\"\r\n        *ngIf=\"canShowQRCode()\"\r\n      >\r\n        <img src=\"assets/icons/qrcode-scan.svg\" />\r\n      </button>\r\n\r\n      <input\r\n        class=\"d-none\"\r\n        id=\"file\"\r\n        type=\"file\"\r\n        (click)=\"emptyInputValue($event)\"\r\n        (change)=\"onFilePickerChange()\"\r\n        [accept]=\"supportedFileTypes\"\r\n        #fileInput\r\n      />\r\n    </div>\r\n  </div>\r\n\r\n  <div\r\n    *ngIf=\"selectedWorkflow && selectedWorkflow.allowRoutingSheetGeneration\"\r\n    class=\"form-group ml-3\"\r\n    style=\"width: 32px; margin-bottom: 20px\"\r\n  >\r\n    <app-action-button\r\n      [action]=\"Action.GenerateRoutingSheet\"\r\n      image=\"img/accuroute-action-routingsheet.svg\"\r\n      title=\"{{ 'Scanning.generate-workflow-routingsheet' | translate }}\"\r\n    ></app-action-button>\r\n  </div>\r\n\r\n  <div class=\"d-flex outcomes\" *ngIf=\"outcomeButtons\">\r\n    <span *ngFor=\"let button of outcomeButtons; let i = index\">\r\n      <button\r\n        *ngIf=\"button.enabled\"\r\n        class=\"btn btn-primary btn-minwidth mr-1 btn-workflow-action\"\r\n        [disabled]=\"\r\n          !hasSelectedItems ||\r\n          ((!this.currentDocument || (this.currentDocument && !this.documentLocked)) && !currentFolderHasItems())\r\n        \"\r\n        (click)=\"onClick(button)\"\r\n        title=\"{{ button.label }}\"\r\n      >\r\n        <div class=\"btn-label-truncate\" [title]=\"button.label\">{{ button.label }}</div>\r\n      </button>\r\n    </span>\r\n  </div>\r\n</div>\r\n\r\n<ngx-smart-modal\r\n  #CaptureToICModal\r\n  [closable]=\"false\"\r\n  [escapable]=\"true\"\r\n  [dismissable]=\"false\"\r\n  customClass=\"capture-modal\"\r\n  identifier=\"CaptureToICModal\"\r\n  class=\"capture-to-modal\"\r\n>\r\n  <div class=\"modal-header\">\r\n    <span class=\"modal-title\">{{ 'Actions.' + invokedAction | translate }}</span>\r\n    <i class=\"fa fa-times close-icon\" (click)=\"closeCaptureModal()\"></i>\r\n  </div>\r\n\r\n  <div class=\"modal-body\">\r\n    <app-document-scanner-and-editor\r\n      *ngIf=\"showScanner\"\r\n      (done)=\"onFinishCapturing($event)\"\r\n      (close)=\"closeCaptureModal()\"\r\n    ></app-document-scanner-and-editor>\r\n  </div>\r\n</ngx-smart-modal>\r\n"],"names":["i0","ɵɵelementStart","ɵɵlistener","BoxHeadComponent_div_3_Template_button_click_1_listener","ɵɵrestoreView","_r1","ctx_r1","ɵɵnextContext","ɵɵresetView","onClick","ɵɵtext","ɵɵelementEnd","ɵɵadvance","ɵɵclassMap","headButton","buttonClass","ɵɵtextInterpolate","buttonText","BoxHeadComponent","constructor","ngOnInit","buttonFunction","selectors","inputs","headText","attrs","_c0","decls","vars","consts","template","BoxHeadComponent_Template","rf","ctx","ɵɵtemplate","BoxHeadComponent_div_3_Template","ɵɵpipeBind1","ɵɵproperty","CommonModule","TranslateModule","ComponentsModule","OpenDropdownModule","BoxModule","declarations","imports","exports","ElementRef","ChangeDetectorRef","SimpleChanges","ActionService","ActionEvent","TranslateService","KeyboardActionMapping","SplitButtonComponent_button_1_Template_button_click_0_listener","activateAction","mainItem","ɵɵelement","getItemTitle","enabled","image","ɵɵsanitizeUrl","SplitButtonComponent_div_2_div_3_a_1_Template_a_click_0_listener","item_r4","_r3","$implicit","ɵɵclassProp","ɵɵtextInterpolate1","getItemActionName","getItemKeyMapping","SplitButtonComponent_div_2_div_3_a_1_Template","getItems","SplitButtonComponent_div_2_div_3_Template","showDropDown","SplitButtonComponent","elementRef","cdr","actionService","translate","setMainItem","items","length","item","action","instant","mapping","getTooltipFor","filter","i","ngOnChanges","changes","onSplitButtonClicked","event","targetElement","nativeElement","querySelector","contains","detectChanges","ɵɵdirectiveInject","i1","i2","hostBindings","SplitButtonComponent_HostBindings","SplitButtonComponent_click_HostBindingHandler","$event","target","ɵɵresolveDocument","SplitButtonComponent_Template_div_keydown_enter_0_listener","SplitButtonComponent_button_1_Template","SplitButtonComponent_div_2_Template","FolderView","id","tenantId","workflowId","workflowStepId","parentId","name","itemCount","UpdateFieldData","context","value","location","UpdateGroupOfFields","values","NgxSmartModalService","ModalsUtilitiesService","ngxSmartModalService","isAnyModalOpened","openedModals","getOpenedModals","onlyHiddenScanToModal","document","ɵɵinject","factory","ɵfac","providedIn","CaptureConstants","folder","page","DocumentsGridSortingConfig","SortingType","Subject","DocumentListStyle","DocumentListStyleService","documentListStyle","Tree","_documentListStyleSubject","onChangeDocumentListStyle","asObservable","update","style","next","getStyle","EventEmitter","Subscription","AuthService","DelayService","LockAction","HydraApiService","UserStateService","CaptureUpdateService","DocumentLockingService","leaseRefreshIntervalSeconds","hydraApi","delayService","userStateService","captureUpdateService","authService","lockStatuses","lockStatusChanged","subscriptions","onDocumentChanged","doc","unlockDocuments","lock","workitem","onUserChanged","user","currentUser","isLoggedIn","documentId","ls","lockedByUserId","locked","unlock","isLocked","expired","isLockedByCurrentUser","setDocumentLock","Lock","onDocumentLockedChanged","onDocumentLockFailed","Unlock","onDocumentUnlockFailed","refreshLease","refreshLock","execute","lockStatus","emit","err","console","log","add","onChangeDocument","subscribe","userChanged","onLogout","i3","i4","signalR","HubConnectionOperations","Log","FolderItem","EventTypes","ItemTypes","WorkItem","CapturedDocument","DocumentCaptureService","FolderViewEventsService","captureUpdate","documentCaptureService","_addFolderSubject","_deleteFolderSubject","_updateFolderSubject","_addItemSubject","_deleteItemSubject","_updateItemSubject","_sortGridColumnData","allowReconnect","onAddFolder","onDeleteFolder","onUpdateFolder","onAddItem","onDeleteItem","onUpdateItem","onSortGridColumnData","currentWorkflow","connectFolderEvents","onChangeWorkflow","workflow","_hubConnection","state","HubConnectionState","Connected","stop","then","startFolderEvents","e","error","HubConnectionBuilder","withUrl","accessTokenFactory","getToken","build","setTimeout","start","catch","notificationEvent","on","folderViewEvent","eventType","added","addEventItem","updated","updateEventItem","deleted","deleteEventItem","executeOnClose","createEventFolderView","data","Id","TenantId","WorkflowId","WorkflowStepId","ParentId","Name","ItemCount","itemType","addFolderView","addFolderItem","workItem","documents","updateFolderView","updateFolderItem","deleteFolderView","deleteFolderItem","folderView","folderItem","updateWorkitemMetadata","getCurrentWorkItem","checkParentFolderChange","sortGridColumnData","sortingConfig","fv","getCurrentDocument","workItemId","parentFolderId","updatedDocument","updateParentFolder","ToastrService","SystemMetaData","DeliveryErrorComponent_div_0_Template_div_click_0_listener","showErrorDetails","DeliveryErrorComponent","capture","toastr","toastMessagesArr","ngOnDestroy","unsubscribe","forEach","m","clear","toastId","deliveryError","deliveryErrorMetaData","getMetaData","DeliveryErrorMessage","deliveryErrorTitle","errorMessage","closeButton","tapToDismiss","disableTimeOut","push","DeliveryErrorComponent_Template","DeliveryErrorComponent_div_0_Template","RouterModule","DocumentCaptureComponent","routes","path","component","pathMatch","DocumentCaptureRoutingModule","forChild","UserPreferencesService","SpinnerStateService","IndexingPanels","IndexingPanelService","ScanAppService","DocumentCaptureComponent_app_indexing_panel_9_Template_app_indexing_panel_resize_0_listener","_r2","ctx_r2","onResize","currentStepHasIndexing","indexingPanelKey","getPreferenceValue","DocumentCaptureComponent_app_scan_to_29_Template_app_scan_to_closeModal_0_listener","_r5","closeScanModal","scanPages","captureService","indexingService","scanAppService","spinnerState","documentListStyleService","documentLockingService","userPreferencesService","focusedPanel","panelsWrapperKey","panelsDocumentGridWrapperKey","lineItemsPanelKey","DocumentListStylePreference","onWorkItemUpdated","selectedDocument","find","x","pageCount","size","selectDocument","documentLocked","reloadCurrentWorkitemMetadata","getWorkItemMetaData","currentWorkitemMetadataLoaded","currentWorkitemMetadataLoadFailed","mdc","metadata","widthResizedSubject","heightResizedSubject","enter","onDocumentScanned","scanresult","scanpages","process","onTransferDocument","onChangeLineItemIndexing","show","showLineItemPanel","isGridView","Grid","reInitIndexing","getPreference","reset","widthResized","preference","setPreference","key","defaultValue","getDocumentPanelWidthPreference","getPanelWrapperKey","heightResized","addFiles","files","addBatchWithMultipleDocuments","discardAllDocs","confirmationModal","close","fillCurrentField","updateFieldData","fillGroupOfFields","updateGroupOfFields","fillGroupOfFieldsValues","scan","startscan","showDriverModal","scanModal","getModal","open","onClose","openConfirmationModal","onToggleSpinner","get","contentWrapper","hide","i5","i6","i7","i8","i9","i10","i11","i12","i13","viewQuery","DocumentCaptureComponent_Query","DocumentCaptureComponent_Template_app_toolbar_discardDocuments_5_listener","DocumentCaptureComponent_Template_app_toolbar_scan_5_listener","DocumentCaptureComponent_Template_div_widthResized_7_listener","DocumentCaptureComponent_Template_div_resize_7_listener","DocumentCaptureComponent_app_indexing_panel_9_Template","DocumentCaptureComponent_Template_app_document_viewer_addFiles_11_listener","DocumentCaptureComponent_Template_app_document_viewer_fillField_11_listener","DocumentCaptureComponent_Template_app_document_viewer_fillGroupOfFields_11_listener","DocumentCaptureComponent_Template_app_document_viewer_toggleSpinner_11_listener","DocumentCaptureComponent_Template_app_line_item_indexing_resize_12_listener","DocumentCaptureComponent_Template_app_line_item_indexing_heightResized_12_listener","DocumentCaptureComponent_Template_button_click_21_listener","confirmationModal_r4","ɵɵreference","DocumentCaptureComponent_Template_button_click_24_listener","DocumentCaptureComponent_app_scan_to_29_Template","selectedPage","FormsModule","DragDropModule","PdfViewerModule","BsDropdownModule","NgxFileDropModule","PerfectScrollbarModule","NgxSmartModalModule","ScrollingModule","ActionDropdownModule","AutoFocusFirstInputModule","AutoUpdatePerfectScrollModule","CheckboxModule","ContextMenuModule","FieldsModule","IconsModule","LabelModule","ModalHeaderModule","PipesModule","ResizableModule","DocumentScannerAndEditorModule","DirectivesModule","ModalsModule","PageModule","DocumentLockedComponent","DocumentViewerComponent","ThumbnailComponent","ThumbnailsComponent","DocumentComponent","DocumentsListComponent","FolderComponent","WorkItemComponent","IndexingPanelComponent","LineItemIndexingComponent","ToolbarComponent","DocumentCaptureModule","forRoot","SelectedItemsService","DocumentLockedComponent_div_0_i_1_Template","DocumentLockedComponent_div_0_i_2_Template","ctx_r0","lockStatusText","lockedByUser","translateService","selectedItemsService","onChangedSelectedItems","oneItemSelected","isOneItemSelected","lockedByUserName","lockedByUserEmail","selectedDocumentChanged","onChangeSelectedItems","DocumentLockedComponent_Template","DocumentLockedComponent_div_0_Template","PdfViewerComponent","PerfectScrollbarDirective","Observable","Annotation","Location","MetaDataValidity","MetaDataValueType","Action","Filename","InteractiveWorkflowStep","ErrorsService","DocumentViewerService","AnnotationsComponent","Batch","Capabilities","MetadataValidityColors","Page","getPageCountText","ɵɵelementContainerStart","ɵɵpropertyInterpolate","StopAnnotating","currentPage","Redaction","Highlight","annotations","highlightColors","ɵɵpureFunction0","_c5","getHighlighColor","onHighlighColorChanged","Text","fontNames","getFontName","onFontNameChanged","fontSizes","getFontSize","onFontSizeChanged","FreeHand","Arrow","Line","Circle","Rectangle","lineWidths","getLineWidth","onLineWidthChanged","getColor","onColorChanged","Stamp","stamps","getStamp","onStampChanged","DocumentViewerComponent_div_27_Template_ngx_file_drop_onFileDrop_1_listener","dropped","DocumentViewerComponent_div_27_ng_template_2_Template","selectedItemsCountText","DocumentViewerComponent_div_29_Template_pdf_viewer_page_rendered_2_listener","_r4","onPageRendered","DocumentViewerComponent_div_29_Template_pdf_viewer_text_layer_rendered_2_listener","setupPointerIndexing","_c6","ɵɵstyleProp","viewerArea_r5","clientWidth","clientHeight","viewerURL","scale","fitToWidthLandscape","fitToWidthPortrait","DocumentViewerComponent_app_annotations_30_Template_app_annotations_annotationAdded_0_listener","_r6","onAnnotationAdded","DocumentViewerComponent_app_annotations_30_Template_app_annotations_annotationUpdated_0_listener","onAnnotationUpdated","DocumentViewerComponent_app_annotations_30_Template_app_annotations_annotationRemoved_0_listener","onAnnotationRemoved","viewer","order","documentWorkItemAnnotations","VIEWER_CONFIG","maxScale","minScale","scaleIncrement","selectedBatch","batch","viewerService","changeSelectedBatch","changeSelectedDocument","onChangeSelectedPage","pageHeight","shouldFitToHeight","delay","folderViewEventsService","errorsService","selectPage","deletePage","fillField","toggleSpinner","enablePointNClickIndexing","highlightsCreated","rubberBandingInProgress","thumbnailsViewerKey","minimumAnimationDuration","oneDocumentSelected","isOneDocumentSelected","oneFolderSelected","isOneFolderSelected","multipleItemsSelected","areMultipleItemsSelected","getSelectedItemsCountText","deleteHighlight","valueIndex","valuesLocation","findIndex","fieldId","splice","highlight","$","getHighlightId","parentElement","removeChild","invokeAction","FitToHeight","fit","FitToWidth","ZoomIn","zoomIn","ZoomOut","zoomOut","RotateLeft","rotate","RotateRight","clearHoveredOver","text","each","removeClass","canDropDocuments","selectedFolder","getSelectedFolder","ws","getWorkflowStepById","isPrimaryStep","hasCapability","allowDropExternalDocument","rotateAnnotations","updatePageAnnotations","source","pdfPage","view","isPortrait","isLandscape","getPageHeight","annotationsAllowed","thumbnails","onAnnotationsLoaded","getCurrentStepId","allowAnnotations","annotation","addAnnotation","onAddingAnnotationFailed","showErrorsModal","updateAnnotation","onUpdatingAnnotationFailed","removeAnnotation","onRemovingAnnotationFailed","replace","isFolderItemSelected","parseFieldId","sections","split","matchingFieldExists","fieldName","metaDataCollection","valueLocation","metaData","valueType","LineItems","matchingFieldExistsInLineItems","toLowerCase","locationsMatch","metaDataLineItems","row","locationA","locationB","left","top","right","bottom","init","directiveRef","map","create","onChangeDocumentPage","el","scrollTop","hideTooltip","prevSettings","resetViewerSettings","onDeletePage","index","onSelectPage","onChangeWorkflowStep","metaDataArr","onWidthResizedSubscription","onWidthResized","updateSize","onHeightResizedSubscription","onHeightResized","setScalesForFitToHeight","onChangeCurrentField","mdd","findMetaDataByName","label","onFocusOnIndexValueValidLocation","zoomIntoValue","zoomedInValueId","onGetValuesValidLocation","existingLocations","newLocations","l","onChangeValueValidLocation","object","hasClass","addClass","validity","css","onChangeValueInValidLocation","findMetaDataById","onActivateAction","onTakeFocus","panel","currentFocusedPanel","addEventListener","ngAfterViewChecked","primaryInteractiveStep","workflowSteps","step","sort","a","b","fileEntry","localeCompare","undefined","numeric","droppedFile","isFile","file","Math","round","dir","rotation","rotateCurrentPage","to","fitToHeightPortraitScale","fitToHeightLandscapeScale","resetHeight","div","offsetHeight","andFitToHeight","viewerWrapper","percentage","parseFloat","toFixed","onWidthResize","highlightValue","pageIndex","pdfViewer","currentPageNumber","_pages","viewPort","viewport","boundLeft","convertToViewportRectangle","boundRight","canvas","append","zoomScale","y","position","container","durationScale","width","duration","children","scrollTo","height","that","body","textLayer","unbind","popover","textDivs","attr","handleTextElement","hover","textOffset","offset","textWidth","viewerOffset","viewerWidth","bufferMargin","popoverPosition","click","getSelectionLocation","offsetWidth","mousedown","parent","onClickX","pageX","onClickY","pageY","onMoveX","onMoveY","positionX","positionY","wrappedTextElements","textElementsWrappers","rubberBanding","positionRubberBanding","remove","mousemove","event2","event3","event4","collision","mouseup","event5","selectedText","LineItemIndexing","valuesArray","trim","areSiblings","isValueInSameCell","offsetLeft","offsetTop","pointAndClickInitialized","element","$this","html","join","inflate","pageWidth","canvasOffset","viewBox","pdfWidth","pdfHeight","rbLeft","rbTop","inflateAmounts","getInflateAmounts","valid","maxInflateAmount","widthInflateAmount","heightInflateAmount","element1","element2","parent1","parent2","prevRect","getBoundingClientRect","currentRect","is","e1","e2","DocumentViewerComponent_Query","DocumentViewerComponent_resize_HostBindingHandler","ɵɵresolveWindow","DocumentViewerComponent_span_4_Template","DocumentViewerComponent_ng_container_9_Template","DocumentViewerComponent_Template_app_thumbnails_toggleSpinner_23_listener","DocumentViewerComponent_Template_app_thumbnails_resize_23_listener","DocumentViewerComponent_Template_app_thumbnails_widthResized_23_listener","DocumentViewerComponent_div_27_Template","DocumentViewerComponent_div_28_Template","DocumentViewerComponent_div_29_Template","DocumentViewerComponent_app_annotations_30_Template","_c4","wrapper_r7","PageState","ThumbnailComponent_button_5_Template_button_click_0_listener","confirmDelete","ThumbnailComponent_button_6_Template_button_click_0_listener","breakDocument","getBreakIconTitle","ThumbnailComponent_img_8_Template_img_load_0_listener","drawAnnotations","thumbnailURL","loaded","getThumbnail","thumbnailDefaultHeightPercentage","onThumbnailScrolled","isPageInViewPort","wrapperElementRef","Loaded","Empty","cancelLoadDocumentPage","loadDocumentPage","confirmedDelete","cancelDelete","onThumbnailScroll","currentValue","annotationsChanged","ngAfterViewInit","wrapperElement","fullyInView","pageTop","window","pageBottom","elementTop","elementBottom","select","selectSpecificPage","stopPropagation","setModalData","title","confirm","cancel","keyboardTooltip","BreakDocument","getElementsByTagName","img","getContext","clearRect","draw","ThumbnailComponent_Query","ThumbnailComponent_Template_div_click_0_listener","ThumbnailComponent_div_3_Template","ThumbnailComponent_button_5_Template","ThumbnailComponent_button_6_Template","ThumbnailComponent_Template_div_resized_7_listener","ThumbnailComponent_img_8_Template","ɵɵpropertyInterpolate2","Loading","canBeDeleted","isPageDraggable","CalculationsService","DocumentLastTouchedService","ThumbnailsComponent_li_6_Template_app_thumbnail_loaded_1_listener","onPageLoad","ThumbnailsComponent_li_6_Template_app_thumbnail_getThumbnail_1_listener","ThumbnailsComponent_li_6_Template_app_thumbnail_toggleSpinner_1_listener","page_r4","pageCanBeDeleted","ThumbnailsComponent_div_7_Template_pdf_viewer_page_rendered_1_listener","onRender","thumbnails_r6","calculate","documentLastTouchedService","waitingPages","pageString","currentDocument","NextPage","movePageSelection","PreviousPage","onPanelScrolled","ev","thumbnailScrolled","thumbnailsPanelElement","pages","onAnnotationsChanged","pageNumber","thumbnailsPanelElementRef","allowDropDocumentPage","onRotatePage","nextPageOrder","setSelectedPage","splitDocumentByPageNumber","newWorkItem","parentFolder","findFolder","searchResult","findDocument","setLastTouchedWorkItem","p","pageElementId","getElementById","isVisibleInScrollableElement","scrollToElement","removeEventListener","onSort","dragData","handleSortingPages","sortPages","onScroll","scrollToY","ulWidth","thumbnailsUl","renderNextThumbnail","p1","nextThumbnail","pageAlreadyHasThumbnailUrl","isPageInQueue","toDataURL","ThumbnailsComponent_Query","ThumbnailsComponent_resize_HostBindingHandler","ThumbnailsComponent_Template_ul_sort_4_listener","ThumbnailsComponent_Template_ul_scrollToTop_4_listener","ThumbnailsComponent_Template_ul_scrollToBottom_4_listener","ThumbnailsComponent_li_6_Template","ThumbnailsComponent_div_7_Template","_c3","parentStepId","wrapper","thumbnailsPanel_r7","QueryList","Renderer2","DOCUMENT","ContextMenuComponent","FieldDefinition","FieldDisplayMode","Key","MetaDataType","RolePermissions","StickyFieldsService","Document","DocumentType","DragDropService","Dictionary","OutcomesService","DocumentComponent_input_10_Template_input_keyup_0_listener","checkValidity","DocumentComponent_input_10_Template_input_blur_0_listener","onBlur","DocumentComponent_input_10_Template_input_click_0_listener","filename","_c8","DocumentComponent_div_11_td_6_Template_app_field_focus_1_listener","ctx_r5","mdd_r7","cellIndex_r8","onFocusCell","DocumentComponent_div_11_td_6_Template_app_field_blurex_1_listener","onCellBlur","DocumentComponent_div_11_td_6_Template_app_field_tabex_1_listener","ctx_r8","onCellTab","DocumentComponent_div_11_td_6_Template_app_field_keydown_tab_1_listener","onCellTabKey","DocumentComponent_div_11_td_6_Template_app_field_keydown_shift_tab_1_listener","onCellShiftTabKey","DocumentComponent_div_11_td_6_Template_app_field_saveLookupValues_1_listener","onSaveLookupValues","DocumentComponent_div_11_td_6_Template_app_field_return_1_listener","onCellReturn","DocumentComponent_div_11_td_6_Template_app_field_valueChange_1_listener","onValueChanged","stepMetadataDefinitionsFields","fieldsValues","getValidity","selected","selectedCellIndex","ɵɵtwoWayListener","DocumentComponent_div_11_Template_app_field_valueChange_4_listener","ɵɵtwoWayBindingSet","DocumentComponent_div_11_Template_app_field_focus_4_listener","onFocusFilenameCell","DocumentComponent_div_11_Template_app_field_blur_4_listener","onFilenameBlur","DocumentComponent_div_11_Template_app_field_tabex_4_listener","DocumentComponent_div_11_Template_app_field_keydown_tab_4_listener","DocumentComponent_div_11_Template_app_field_keydown_shift_tab_4_listener","DocumentComponent_div_11_Template_app_field_return_4_listener","onFilenameReturn","DocumentComponent_div_11_td_6_Template","fieldDocumentName","ɵɵtwoWayProperty","stepMetadataDefinitions","DocumentComponent_div_15_div_2_button_2_Template_button_click_0_listener","_r11","dropdown_r12","onClickMenuButton","DocumentComponent_div_15_div_2_Template_div_onHidden_0_listener","_r10","onHidden","DocumentComponent_div_15_div_2_button_2_Template","multipleSelectedItems","canDeleteDocument","DocumentComponent_div_15_div_2_Template","canReplaceDocument","DocumentComponent_div_16_Template_button_click_2_listener","_r13","save","DocumentComponent_div_16_Template_button_click_4_listener","metaDataValidity","userState","stickyService","folderViewEvents","dragDropService","outcomesService","renderer","modalsUtilitiesService","documentLoaded","FILENAME_CELL_INDEX","DocumentGridPanel","documentString","outcomes","getDocumentContextMenuActions","actions","editDocumentName","disabled","deleteSelectedItems","canRescanDocument","rescan","canManageWorkitem","showWorkitemProperties","outcome","executeOutcome","isDocumentSelected","isItemSelected","elementDragStarted","dragStarted","isItemDragged","elementParentId","elementParentStepId","elementType","pushDragData","setGridCellsStyles","headerCells","dataCells","EditSelection","DeleteSelectedItem","CtrlDeleteSelectedItem","editing","docName","removeAttribute","strLength","setSelectionRange","focus","confirmDeleteSelectedItems","confirmedDeleteSelectedItems","transitionSelectedItems","isViewerLoaded","dropEnabled","type","required","lastDocumentName","updateFieldsDisplayMode","onInit","listen","docWrapper","contextMenu","onChangeCurrentFieldValue","valueObj","setMetaDataValueAndLocation","Expression","moveToNextCell","checkValues","getFieldValue","valuesWithValidLocation","field","md","getWorkItemMetadata","hasValuesWithValidLocation","lastTouchedField","getLastTouchedField","updateCellUI","onPointAndClickInitialized","emitCurrentCellChange","getCurrentFieldName","updateFieldsValues","pipe","overallValidity","getOverallValidity","getCurrentWorkflowStep","onElementDragStarted","onElementDragEnded","deleteDocument","allowCaptureReimportPage","allowCaptureRescanPage","hasRolePermission","WORKITEM_MANAGE","onWorkitemMetadataUpdated","metadataCollection","onChangeOutcomeButtons","lastTouchedFieldId","lastTouchedDocumentId","getLastTouchedDocumentId","clearLastTouchedField","clearLastTouchedDocumentId","focusLastTouchedField","displayMode","grid","vertical","className","ctrlKey","canDragDocuments","allowDropDocument","isFilenameFocused","edit","blur","SetFocusTreePanel","setAttribute","fileType","newDocument","updateDocumentName","Escape","Enter","onDrop","DragEvent","dropPageIntoDocument","dropWorkItemsIntoDocument","handleDragDropPageIntoDocument","handleDragDropWorkItemsIntoDocument","dragDataArray","clearDragData","onDragOver","isPageDragged","isDocumentDragged","onDragLeave","onMouseEnter","isMenu","hoverOverMenu","hoverOver","onMouseLeave","dropdown","result","ReimportDocument","documentResult","RescanDocument","showMenu","String","stickyField","setStickyField","stickyValue","getStickyField","validateAndSaveIndexingValue","unknown","cellIndex","scrollToCell","selectNextDocument","moveToPreviousCell","fieldLabelText","changeCurrentField","preventDefault","saveFilename","itemIndex","prevValue","zoomIntoField","updateCellIndex","zoomIntoViewerField","zoomInFieldId","setLastTouchedField","setLastTouchedDocumentId","updateMetadataValues","lookups","move","forward","cellField","getCellElement","workflowPanel","cellElement","scrollLeft","panelWidth","elementOffsetLeft","elementLeft","elementRight","scrollOffset","cellOffset","leftOffset","fieldElements","menuAreaWidth","fields","toArray","onDragStarted","onDragEnded","elementDragEnded","handleAction","setMetaData","i14","i15","i16","i17","DocumentComponent_Query","DocumentComponent_Template_div_click_0_listener","DocumentComponent_Template_div_dragStarted_0_listener","DocumentComponent_Template_div_dragEnd_0_listener","DocumentComponent_Template_div_drop_0_listener","DocumentComponent_Template_div_dragOver_0_listener","DocumentComponent_Template_div_dragLeave_0_listener","DocumentComponent_Template_div_mouseleave_0_listener","DocumentComponent_Template_div_mouseenter_0_listener","DocumentComponent_i_4_Template","DocumentComponent_i_5_Template","DocumentComponent_i_6_Template","DocumentComponent_i_7_Template","DocumentComponent_input_10_Template","DocumentComponent_div_11_Template","DocumentComponent_div_12_Template","DocumentComponent_div_13_Template","DocumentComponent_div_15_Template","DocumentComponent_div_16_Template","ɵɵpureFunction2","ɵɵpureFunction1","notValid","suspicious","_c7","WorkflowFolder","DocumentsListComponent_app_folder_18_Template_app_folder_documentLoaded_0_listener","onDocumentLoaded","folder_r4","listHeaderDirectiveOpts","_currentWorkflow","focusPanel","loadFolderViewCallback","folders","lastWorkFlowSelection","loadFolders","setWorkflowFirstFolder","loadingFoldersInProgress","loadFolderViewFailed","Array","getFlatList","getCurrentSelection","getPageSize","expandFolder","expand","currentFolder","collapseFolder","moveSelection","newIndex","selectFolder","expanded","isDocumentVisible","panelElement","onKeyDown","altKey","shiftKey","ArrowUp","ArrowDown","ArrowLeft","ArrowRight","PageUp","PageDown","Home","End","getDocumentListStyle","changeDocumentListStyle","activeElement","newStyle","onSelectNextDocument","onScrollToDocument","documentElementID","documentElement","scrollbar","onChangeFolder","psScrollDown","psScrollUp","listWrapper","onRenderContextMenu","menu","getWorkflowFolders","getViewIconTextId","trackFolderId","DocumentsListComponent_Query","DocumentsListComponent_Template_button_click_8_listener","DocumentsListComponent_img_11_Template","DocumentsListComponent_img_12_Template","DocumentsListComponent_Template_div_scrollToTop_14_listener","DocumentsListComponent_Template_div_scrollToBottom_14_listener","DocumentsListComponent_Template_div_keydown_14_listener","DocumentsListComponent_app_folder_18_Template","DocumentsListComponent_Template_app_context_menu_rendered_19_listener","wrapper_r5","workflowPanel_r6","FieldDataSource","FolderActionEvent","Outcome","Workflow","WorkflowStepSortType","ɵɵpureFunction4","isExpanded","isWorkflowRoot","getDocumentCountText","FolderComponent_div_11_div_2_Template_div_onHidden_0_listener","FolderComponent_div_11_div_2_Template_button_click_2_listener","dropdown_r4","FolderComponent_div_11_div_2_Template","canDeleteDocuments","canImportNew","canScanNew","ɵɵclassMapInterpolate1","getSortingIconClass","FolderComponent_div_12_th_11_Template_div_click_1_listener","i_r7","onGridColumnClicked","FolderComponent_div_12_th_11_span_3_Template","metadata_r8","showSortingIcon","FolderComponent_div_12_Template_div_click_6_listener","FolderComponent_div_12_span_10_Template","FolderComponent_div_12_th_11_Template","getColumns","FolderComponent_ul_15_li_1_Template_app_work_item_documentLoaded_2_listener","_r9","folderItem_r10","FolderComponent_ul_15_li_1_Template","ɵɵpipeBind3","trackWorkItemId","FolderComponent_li_17_Template_app_folder_openParentFolder_1_listener","onAddNewFolder","childFolder_r12","openParentFolder","folderString","columns","CascadingOptions","dataSource","dataSet","o","optionMDD","metaDataId","getFolderItem","isFolderSelected","expandAndSelectDocument","f","existsInSameWorkflowStep","currentWorkItem","unselectDocument","toggleExpand","loadStepMetadataDefinitions","workflowStep","interactiveWorkflowStep","metaDataIds","metadataDefinition","initializeStepMetaDataDefinitionsFields","sortDocuments","None","first","second","firstValue","secondValue","getMetaDataValue","getCompareResult","Number","metaDataIndex","toString","metaDataType","Integer","Decimal","Date","parse","childrenWorkItems","changeSort","defaultSort","folderEl","getFolderContextMenuActions","parentID","addToFolders","loadFolderItems","discardOutcome","SendToDoneId","outcomeType","requiresConfirmation","requiresValidMetaData","nextId","allowCaptureImport","allowCaptureScan","onExpandFolder","onCollapseFolder","newFolder","hasChangedByCurrentUser","interactivestep","sortDirection","sortBy","DateCreated","removeFolder","actionName","folderHasItems","addDocument","scanDocument","scrollToDocument","loadingItems","getWorkflowFolderItems","_document","dropFiles","firstDragData","dragDataItem","targetType","dropDocument","dropPage","currentStep","getCurrentStep","dataTransfer","fileName","getFileNameWithoutExtension","fileExtension","getFileExtension","addFiletoFolder","handleDragDropDocuments","getGroupingFolderValues","addPageToFolder","elementPosition","pageSuffix","actionEvent","ImportToUnselectedFolder","ScanToUnselectedFolder","fieldDefinition","asFieldDefinition","datasource","sortingIndex","sortingType","Asc","Desc","FolderComponent_Query","FolderComponent_Template_div_dragOver_0_listener","FolderComponent_Template_div_dragLeave_0_listener","FolderComponent_Template_div_drop_0_listener","FolderComponent_Template_div_mouseleave_1_listener","FolderComponent_Template_div_mouseenter_1_listener","FolderComponent_Template_i_click_3_listener","FolderComponent_Template_div_click_4_listener","FolderComponent_i_6_Template","FolderComponent_span_9_Template","FolderComponent_div_11_Template","FolderComponent_div_12_Template","FolderComponent_div_13_Template","FolderComponent_ul_15_Template","FolderComponent_li_17_Template","TranslatePipe","i20","ArraySortPipe","styles","encapsulation","WorkItemComponent_app_document_0_Template_app_document_documentLoaded_0_listener","document_r3","trackDocumentId","outputs","WorkItemComponent_Template","WorkItemComponent_app_document_0_Template","PerfectScrollbarComponent","DropDownService","MetaDataPreviewHilight","IndexingPanelComponent_form_8_app_field_1_Template_app_field_focus_0_listener","i_r3","ctx_r3","onFocus","IndexingPanelComponent_form_8_app_field_1_Template_app_field_blurex_0_listener","field_r5","IndexingPanelComponent_form_8_app_field_1_Template_app_field_return_0_listener","onReturn","IndexingPanelComponent_form_8_app_field_1_Template_app_field_tabex_0_listener","onTab","IndexingPanelComponent_form_8_app_field_1_Template_app_field_keydown_tab_0_listener","onTabKey","IndexingPanelComponent_form_8_app_field_1_Template_app_field_keydown_shift_tab_0_listener","onShiftTabKey","IndexingPanelComponent_form_8_app_field_1_Template_app_field_saveLookupValues_0_listener","hasSelectedItems","getFieldDefinition","disableBlur","currentField","shouldValueBeSet","getMetaDataCollection","IndexingPanelComponent_form_8_app_field_1_Template","trackByDocumentMetaDataField","dropDown","setCurrentField","indexingPanel","shouldFocusFirstField","onTakeFocusHandler","moveTo","getFocusFieldIndex","hasItemsSelected","fd","mddValue","getWorkItemIndexingValue","getFieldValidity","currentFieldIndex","getValueLocation","previewHilight","perfectScroll","scrollToTop","timeout","clearTimeout","allowedForWorkflow","Lookup","fieldIndex","zoom","blurEvent","changeValueValidity","canAutomaticallyAdvanceOnTab","scrolled","IndexingPanelComponent_Query","IndexingPanelComponent_Template_perfect_scrollbar_ps_scroll_up_5_listener","IndexingPanelComponent_Template_perfect_scrollbar_ps_scroll_down_5_listener","IndexingPanelComponent_form_8_Template","perfectScroll_r7","_c1","effect","viewChild","fromEvent","CdkVirtualScrollViewport","BlurEvent","BulkValidationRequest","MetaDataCollection","MetaDataDefinition","MetaDataLineItems","LineItemIndexingComponent_div_4_Template_button_click_2_listener","onAddClicked","loadingDefaultValues","mdd_r3","LineItemIndexingComponent_perfect_scrollbar_5_tbody_8_tr_3_td_1_Template_app_field_blurex_1_listener","ctx_r7","item_r9","rowIndex_r10","LineItemIndexingComponent_perfect_scrollbar_5_tbody_8_tr_3_td_1_Template_app_field_focus_1_listener","ctx_r10","cellIndex_r12","selectCell","LineItemIndexingComponent_perfect_scrollbar_5_tbody_8_tr_3_td_1_Template_app_field_tab_1_listener","LineItemIndexingComponent_perfect_scrollbar_5_tbody_8_tr_3_td_1_Template_app_field_shiftTab_1_listener","onShiftTab","LineItemIndexingComponent_perfect_scrollbar_5_tbody_8_tr_3_td_1_Template_app_field_saveLookupValues_1_listener","LineItemIndexingComponent_perfect_scrollbar_5_tbody_8_tr_3_td_1_Template_app_field_return_1_listener","ctx_r12","selectedRowIndex","LineItemIndexingComponent_perfect_scrollbar_5_tbody_8_tr_3_td_1_Template","LineItemIndexingComponent_perfect_scrollbar_5_tbody_8_tr_3_Template_button_click_4_listener","lineItemMDD","getCompareToField","cellIndex_r14","getColumnTotal","getCompareToValue","getColumnTotalText","LineItemIndexingComponent_perfect_scrollbar_5_tbody_8_tr_4_td_1_div_1_Template","canCalculateTotal","LineItemIndexingComponent_perfect_scrollbar_5_tbody_8_tr_4_td_1_Template","LineItemIndexingComponent_perfect_scrollbar_5_tbody_8_Template_cdk_virtual_scroll_viewport_scrolledIndexChange_1_listener","LineItemIndexingComponent_perfect_scrollbar_5_tbody_8_tr_3_Template","LineItemIndexingComponent_perfect_scrollbar_5_tbody_8_tr_4_Template","virtualScrollViewportStyles","lineItems","trackLineItemById","showTotalsRow","LineItemIndexingComponent_perfect_scrollbar_5_th_5_Template","LineItemIndexingComponent_perfect_scrollbar_5_tbody_8_Template","_c2","spinner","_this","cdkScrollElement","setCurrentCell","removeFocus","lineItemPanel","allowedTypesForTotals","addNewLineItemSubject","addStopWritingInFieldsWhileLoadingListener","spinnerElement","getLineItemIndexingElement","stopWritingInFieldsWhileLoading","isBusy","lineItemChanged","updatedLineItem","currentItems","getRowKey","defaultRowValues","JSON","stringify","removeEmptyLines","emptyLinesShouldBeRemoved","hideSpinner","getColSpan","deleteItem","toBeDeletedIndex","applyColumnMetaDataValues","oldSelectedRowIndex","promises","setFieldValue","Promise","all","_asyncToGenerator","onRowValidationSucceed","updateLineItemsReference","saveLineItems","onRowValidationFailed","lic","getLineItemConfigById","showTotal","lineItemMetaDataId","lineItemConfigurations","total","hasCompareToField","compareToValue","op","compareToFieldName","toLocaleLowerCase","compareToMetaDataId","getFieldId","cell","nativeScrollElement","last","lastElementChild","firstElementChild","replaceChild","insertBefore","onUpdateLineItemTableHead","header","isInitialized","lineItemMetaDataName","headerLabel","onUpdateLineItemTableBody","updateLineItems","onFillGroupOfValues","groupOfFieldsValuesObj","LargeText","mapGroupOfValues","setVirtualScrollViewportStyles","rowIndex","addItem","saveValues","showSpinner","getLineItemDefaults","mdDic","addMetaDataCollectionRow","set","msg","resolve","reject","metadataDic","placeholder","virtualScrollViewport","scrollToIndex","selectedMdd","tempFieldId","takeFocus","shouldAddItem","relatedTarget","force","addNewLineItem","isSuspiciousField","isEqual","value1","value2","moveNext","counter","Object","assign","currentLineItems","validateLineItemValue","currentSelectedRowIndex","existingItems","slice","defaultLineItem","lookup","overwrite","validateAndUpdateBulkMetadata","serializable","lineItemsCopy","lineItemIndexingWrapper","tableWrapperElement","tableWrapper","scrollWidth","minimumLineItemsTableWidth","lineItemsHeaderHeight","LineItemIndexingComponent_Query","LineItemIndexingComponent_div_4_Template","LineItemIndexingComponent_perfect_scrollbar_5_Template","isDevMode","saveAs","Branding","FixedDataSource","createPDFFromImages","InProgressService","DocumentProperties","RescanPage","ScanAdditionalPages","ScanOptions","ScanToFolder","ScanToWorkflow","ToolbarComponent_app_field_8_Template_app_field_valueChange_0_listener","selectedWorkflowId","ToolbarComponent_app_field_8_Template_app_field_fieldChanged_0_listener","onWorkflowChanged","fieldWorkflow","selectedWorkflow","scanSplitItems","importSplitItems","captureSplitItems","ToolbarComponent_button_14_Template_button_click_0_listener","generateQRCode","GenerateRoutingSheet","ToolbarComponent_div_18_span_1_button_1_Template_button_click_0_listener","button_r6","currentFolderHasItems","ToolbarComponent_div_18_span_1_button_1_Template","ToolbarComponent_div_18_span_1_Template","outcomeButtons","ToolbarComponent_app_document_scanner_and_editor_27_Template_app_document_scanner_and_editor_done_0_listener","_r7","onFinishCapturing","ToolbarComponent_app_document_scanner_and_editor_27_Template_app_document_scanner_and_editor_close_0_listener","closeCaptureModal","inProgress","calculations","ngxSmartModal","errorService","discardDocuments","classNamePrefix","showScanner","isCameraAvailable","isProfileAvailable","invokedAction","LastSelectedWorfklowId","supportedFileTypes","workflowDataSource","updateUI","initializeScanItems","initializeImportItems","initializeCaptureItems","workflowsLoaded","workflows","noProfilesFound","options","info","destinations","c","lastSelectedWorkflowId","w","createWorkflowsList","setDestination","loadWorkflowsFailed","ScanNew","onScan","onScanToFolder","onImportToUnSelectedFolder","onScanToUnSelectedFolder","ScanMorePages","onScanMorePages","onRescanPage","onRescanDocument","ImportToFolder","onImportToFolder","ImportNew","onImport","ImportMorePages","onImportMorePages","ReimportPage","onReimportPage","onReimportDocument","CaptureNew","CaptureToFolder","CaptureMorePages","RecapturePage","RecaptureDocument","Outcome1","Outcome2","Outcome3","Outcome4","executeGenerateRoutingSheet","workflowGenerateRoutingSheet","onGeneratedRoutingSheet","onFailedGenerateRoutingSheet","blob","import","multiple","useCamera","importer","openFilePicker","openCaptureModal","anyImportingAllowed","isCaptureFolderOrDocumentSelected","importingToFolderAllowed","currentFolderId","parentWorkflowFolder","isCaptureDocumentSelected","importingMorePagesAllowed","appendPagesToDocument","isCapturePageSelected","reimportingPagesAllowed","reImportPageToDocument","scanSettings","currentLang","scanningToFolderAllowed","showNoScanFolderError","scanningMorePagesAllowed","showNoScanDocumentError","rescanningPagesAllowed","showNoScanPageError","anyScanningAllowed","scanningAllowed","importingAllowed","isWorkflowSelected","currentStepHasScanCapability","capability","CaptureScan","currentStepHasImportCapability","CaptureImport","allowCaptureScanToFolder","allowCaptureScanMorePages","allowCaptureImportToFolder","allowCaptureImportMorePages","canShowQRCode","userProfile","mobileBrand","IntelligentCapture","getDocumentCaptureQRCode","qrcodeLoaded","qrcodeFailed","urlCreator","URL","webkitURL","imageUrl","createObjectURL","reader","FileReader","onload","readAsText","List","loadWorkFlows","onParentFolderChanged","updateOutcomesKeyboardMapping","setCameraAvailability","navigator","mediaDevices","getUserMedia","video","outcomeNumber","getOutcomeAction","scanToFolder","scanNew","scanMorePages","reScanPage","reScanDocument","importToFolder","importNew","importMorePages","reimportPage","reimportDocument","captureToFolder","captureNew","captureMorePages","recapturePage","recaptureDocument","outcomesCount","outcomeIndex","fileInput","captureModal","fileListToArray","fileList","filesArray","getDocumentAndWorkItemToInvokeAction","replaceDocument","onFilePickerChange","from","onImportFiles","captures","capturedImage","checkIfItemIsNotInViewAndScroll","selectedElement","emptyInputValue","discard","getCurrentWorkflowIndex","dist","ToolbarComponent_Query","ToolbarComponent_app_field_8_Template","ToolbarComponent_label_9_Template","ToolbarComponent_app_splitbutton_11_Template","ToolbarComponent_app_splitbutton_12_Template","ToolbarComponent_app_splitbutton_13_Template","ToolbarComponent_button_14_Template","ToolbarComponent_Template_input_click_15_listener","ToolbarComponent_Template_input_change_15_listener","ToolbarComponent_div_17_Template","ToolbarComponent_div_18_Template","ToolbarComponent_Template_i_click_25_listener","ToolbarComponent_app_document_scanner_and_editor_27_Template","allowRoutingSheetGeneration"],"sourceRoot":"webpack:///","x_google_ignoreList":[]}